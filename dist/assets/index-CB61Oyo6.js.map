{"version":3,"file":"index-CB61Oyo6.js","sources":["../../node_modules/react-dom/client.js","../../src/components/AnalyticsProvider.tsx","../../node_modules/@firebase/installations/dist/esm/index.esm2017.js","../../node_modules/@firebase/analytics/dist/esm/index.esm2017.js","../../src/config/firebase.ts","../../src/contexts/AuthContext.tsx","../../node_modules/engine.io-parser/build/esm/commons.js","../../node_modules/engine.io-parser/build/esm/encodePacket.browser.js","../../node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js","../../node_modules/engine.io-parser/build/esm/decodePacket.browser.js","../../node_modules/engine.io-parser/build/esm/index.js","../../node_modules/@socket.io/component-emitter/lib/esm/index.js","../../node_modules/engine.io-client/build/esm/globals.js","../../node_modules/engine.io-client/build/esm/util.js","../../node_modules/engine.io-client/build/esm/contrib/parseqs.js","../../node_modules/engine.io-client/build/esm/transport.js","../../node_modules/engine.io-client/build/esm/transports/polling.js","../../node_modules/engine.io-client/build/esm/contrib/has-cors.js","../../node_modules/engine.io-client/build/esm/transports/polling-xhr.js","../../node_modules/engine.io-client/build/esm/transports/websocket.js","../../node_modules/engine.io-client/build/esm/transports/webtransport.js","../../node_modules/engine.io-client/build/esm/transports/index.js","../../node_modules/engine.io-client/build/esm/contrib/parseuri.js","../../node_modules/engine.io-client/build/esm/socket.js","../../node_modules/socket.io-client/build/esm/url.js","../../node_modules/socket.io-parser/build/esm/is-binary.js","../../node_modules/socket.io-parser/build/esm/binary.js","../../node_modules/socket.io-parser/build/esm/index.js","../../node_modules/socket.io-client/build/esm/on.js","../../node_modules/socket.io-client/build/esm/socket.js","../../node_modules/socket.io-client/build/esm/contrib/backo2.js","../../node_modules/socket.io-client/build/esm/manager.js","../../node_modules/socket.io-client/build/esm/index.js","../../src/contexts/ChatContext.tsx","../../src/theme/index.ts","../../node_modules/@mui/icons-material/utils/createSvgIcon.js","../../node_modules/@mui/icons-material/Favorite.js","../../node_modules/@mui/icons-material/FavoriteBorder.js","../../node_modules/@mui/icons-material/LocationOn.js","../../node_modules/@mui/icons-material/Chat.js","../../src/assets/placeholders.ts","../../node_modules/@mui/icons-material/Search.js","../../src/components/SearchBar.tsx","../../node_modules/@mui/icons-material/Email.js","../../node_modules/@mui/icons-material/Phone.js","../../src/components/Footer.tsx","../../src/hooks/useAuth.ts","../../src/hooks/useFavorites.ts","../../src/components/AnimatedPage.tsx","../../src/pages/Home.tsx","../../src/pages/Login.tsx","../../src/pages/Register.tsx","../../src/hooks/useListings.ts","../../src/components/ListingCard.tsx","../../src/pages/Profile.tsx","../../node_modules/@mui/icons-material/CloudUpload.js","../../node_modules/@mui/icons-material/Delete.js","../../src/pages/CreateListing.tsx","../../src/pages/ListingDetails.tsx","../../src/pages/EditListing.tsx","../../node_modules/lodash/isObject.js","../../node_modules/lodash/_freeGlobal.js","../../node_modules/lodash/_root.js","../../node_modules/lodash/now.js","../../node_modules/lodash/_trimmedEndIndex.js","../../node_modules/lodash/_baseTrim.js","../../node_modules/lodash/_Symbol.js","../../node_modules/lodash/_getRawTag.js","../../node_modules/lodash/_objectToString.js","../../node_modules/lodash/_baseGetTag.js","../../node_modules/lodash/isObjectLike.js","../../node_modules/lodash/isSymbol.js","../../node_modules/lodash/toNumber.js","../../node_modules/lodash/debounce.js","../../node_modules/date-fns/constants.js","../../node_modules/date-fns/constructFrom.js","../../node_modules/date-fns/toDate.js","../../node_modules/date-fns/addDays.js","../../node_modules/date-fns/_lib/defaultOptions.js","../../node_modules/date-fns/startOfWeek.js","../../node_modules/date-fns/startOfISOWeek.js","../../node_modules/date-fns/getISOWeekYear.js","../../node_modules/date-fns/_lib/getTimezoneOffsetInMilliseconds.js","../../node_modules/date-fns/_lib/normalizeDates.js","../../node_modules/date-fns/startOfDay.js","../../node_modules/date-fns/differenceInCalendarDays.js","../../node_modules/date-fns/startOfISOWeekYear.js","../../node_modules/date-fns/compareAsc.js","../../node_modules/date-fns/constructNow.js","../../node_modules/date-fns/isSameDay.js","../../node_modules/date-fns/isDate.js","../../node_modules/date-fns/isValid.js","../../node_modules/date-fns/differenceInCalendarMonths.js","../../node_modules/date-fns/_lib/getRoundingMethod.js","../../node_modules/date-fns/differenceInMilliseconds.js","../../node_modules/date-fns/endOfDay.js","../../node_modules/date-fns/endOfMonth.js","../../node_modules/date-fns/isLastDayOfMonth.js","../../node_modules/date-fns/differenceInMonths.js","../../node_modules/date-fns/differenceInSeconds.js","../../node_modules/date-fns/startOfYear.js","../../node_modules/date-fns/locale/en-US/_lib/formatDistance.js","../../node_modules/date-fns/locale/_lib/buildFormatLongFn.js","../../node_modules/date-fns/locale/en-US/_lib/formatLong.js","../../node_modules/date-fns/locale/en-US/_lib/formatRelative.js","../../node_modules/date-fns/locale/_lib/buildLocalizeFn.js","../../node_modules/date-fns/locale/en-US/_lib/localize.js","../../node_modules/date-fns/locale/_lib/buildMatchFn.js","../../node_modules/date-fns/locale/_lib/buildMatchPatternFn.js","../../node_modules/date-fns/locale/en-US/_lib/match.js","../../node_modules/date-fns/locale/en-US.js","../../node_modules/date-fns/getDayOfYear.js","../../node_modules/date-fns/getISOWeek.js","../../node_modules/date-fns/getWeekYear.js","../../node_modules/date-fns/startOfWeekYear.js","../../node_modules/date-fns/getWeek.js","../../node_modules/date-fns/_lib/addLeadingZeros.js","../../node_modules/date-fns/_lib/format/lightFormatters.js","../../node_modules/date-fns/_lib/format/formatters.js","../../node_modules/date-fns/_lib/format/longFormatters.js","../../node_modules/date-fns/_lib/protectedTokens.js","../../node_modules/date-fns/format.js","../../node_modules/date-fns/formatDistance.js","../../node_modules/date-fns/formatDistanceToNow.js","../../node_modules/date-fns/isSameWeek.js","../../node_modules/date-fns/isToday.js","../../node_modules/date-fns/subDays.js","../../node_modules/date-fns/isYesterday.js","../../src/pages/Search.tsx","../../src/pages/HowItWorks.tsx","../../node_modules/date-fns/locale/bg/_lib/formatDistance.js","../../node_modules/date-fns/locale/bg/_lib/formatLong.js","../../node_modules/date-fns/locale/bg/_lib/formatRelative.js","../../node_modules/date-fns/locale/bg/_lib/localize.js","../../node_modules/date-fns/locale/bg/_lib/match.js","../../node_modules/date-fns/locale/bg.js","../../node_modules/@mui/icons-material/AccessTime.js","../../src/pages/MyListings.tsx","../../src/pages/About.tsx","../../src/pages/Settings.tsx","../../src/pages/Contact.tsx","../../src/data/featuredListings.ts","../../src/pages/Favorites.tsx","../../src/pages/Privacy.tsx","../../src/pages/Terms.tsx","../../src/pages/ForgotPassword.tsx","../../src/pages/NotFound.tsx","../../node_modules/@mui/icons-material/ChatBubbleOutline.js","../../node_modules/@mui/icons-material/PersonAdd.js","../../src/components/chat/ChatListItem.tsx","../../src/components/chat/ChatList.tsx","../../node_modules/@mui/icons-material/Send.js","../../node_modules/@mui/icons-material/AttachFile.js","../../node_modules/@mui/icons-material/EmojiEmotions.js","../../node_modules/@mui/icons-material/MoreVert.js","../../node_modules/@mui/icons-material/DoneAll.js","../../node_modules/@mui/icons-material/Image.js","../../src/components/chat/ChatWindow.tsx","../../node_modules/@mui/icons-material/Menu.js","../../node_modules/@mui/icons-material/ArrowBack.js","../../node_modules/@mui/icons-material/Notifications.js","../../node_modules/@mui/icons-material/Settings.js","../../src/pages/ChatPage.tsx","../../src/routes.tsx","../../src/components/Navbar.tsx","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","import React, { createContext, useContext } from 'react';\r\n\r\ninterface AnalyticsContextType {\r\n  logPageView: (page: string) => void;\r\n  logEvent: (event: string, properties?: Record<string, any>) => void;\r\n}\r\n\r\nconst AnalyticsContext = createContext<AnalyticsContextType>({\r\n  logPageView: () => {},\r\n  logEvent: () => {},\r\n});\r\n\r\nexport const useAnalytics = () => {\r\n  const context = useContext(AnalyticsContext);\r\n  if (!context) {\r\n    throw new Error('useAnalytics трябва да се използва в AnalyticsProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nexport const AnalyticsProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n  const logPageView = (page: string) => {\r\n    // Implement your analytics tracking here\r\n    console.log(`Page viewed: ${page}`);\r\n  };\r\n\r\n  const logEvent = (event: string, properties?: Record<string, any>) => {\r\n    // Implement your event tracking here\r\n    console.log(`Event: ${event}`, properties);\r\n  };\r\n\r\n  return (\r\n    <AnalyticsContext.Provider value={{ logPageView, logEvent }}>\r\n      {children}\r\n    </AnalyticsContext.Provider>\r\n  );\r\n}; ","import { _getProvider, getApp, _registerComponent, registerVersion } from '@firebase/app';\nimport { Component } from '@firebase/component';\nimport { ErrorFactory, FirebaseError } from '@firebase/util';\nimport { openDB } from 'idb';\n\nconst name = \"@firebase/installations\";\nconst version = \"0.6.9\";\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst PENDING_TIMEOUT_MS = 10000;\r\nconst PACKAGE_VERSION = `w:${version}`;\r\nconst INTERNAL_AUTH_VERSION = 'FIS_v2';\r\nconst INSTALLATIONS_API_URL = 'https://firebaseinstallations.googleapis.com/v1';\r\nconst TOKEN_EXPIRATION_BUFFER = 60 * 60 * 1000; // One hour\r\nconst SERVICE = 'installations';\r\nconst SERVICE_NAME = 'Installations';\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst ERROR_DESCRIPTION_MAP = {\r\n    [\"missing-app-config-values\" /* ErrorCode.MISSING_APP_CONFIG_VALUES */]: 'Missing App configuration value: \"{$valueName}\"',\r\n    [\"not-registered\" /* ErrorCode.NOT_REGISTERED */]: 'Firebase Installation is not registered.',\r\n    [\"installation-not-found\" /* ErrorCode.INSTALLATION_NOT_FOUND */]: 'Firebase Installation not found.',\r\n    [\"request-failed\" /* ErrorCode.REQUEST_FAILED */]: '{$requestName} request failed with error \"{$serverCode} {$serverStatus}: {$serverMessage}\"',\r\n    [\"app-offline\" /* ErrorCode.APP_OFFLINE */]: 'Could not process request. Application offline.',\r\n    [\"delete-pending-registration\" /* ErrorCode.DELETE_PENDING_REGISTRATION */]: \"Can't delete installation while there is a pending registration request.\"\r\n};\r\nconst ERROR_FACTORY = new ErrorFactory(SERVICE, SERVICE_NAME, ERROR_DESCRIPTION_MAP);\r\n/** Returns true if error is a FirebaseError that is based on an error from the server. */\r\nfunction isServerError(error) {\r\n    return (error instanceof FirebaseError &&\r\n        error.code.includes(\"request-failed\" /* ErrorCode.REQUEST_FAILED */));\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction getInstallationsEndpoint({ projectId }) {\r\n    return `${INSTALLATIONS_API_URL}/projects/${projectId}/installations`;\r\n}\r\nfunction extractAuthTokenInfoFromResponse(response) {\r\n    return {\r\n        token: response.token,\r\n        requestStatus: 2 /* RequestStatus.COMPLETED */,\r\n        expiresIn: getExpiresInFromResponseExpiresIn(response.expiresIn),\r\n        creationTime: Date.now()\r\n    };\r\n}\r\nasync function getErrorFromResponse(requestName, response) {\r\n    const responseJson = await response.json();\r\n    const errorData = responseJson.error;\r\n    return ERROR_FACTORY.create(\"request-failed\" /* ErrorCode.REQUEST_FAILED */, {\r\n        requestName,\r\n        serverCode: errorData.code,\r\n        serverMessage: errorData.message,\r\n        serverStatus: errorData.status\r\n    });\r\n}\r\nfunction getHeaders({ apiKey }) {\r\n    return new Headers({\r\n        'Content-Type': 'application/json',\r\n        Accept: 'application/json',\r\n        'x-goog-api-key': apiKey\r\n    });\r\n}\r\nfunction getHeadersWithAuth(appConfig, { refreshToken }) {\r\n    const headers = getHeaders(appConfig);\r\n    headers.append('Authorization', getAuthorizationHeader(refreshToken));\r\n    return headers;\r\n}\r\n/**\r\n * Calls the passed in fetch wrapper and returns the response.\r\n * If the returned response has a status of 5xx, re-runs the function once and\r\n * returns the response.\r\n */\r\nasync function retryIfServerError(fn) {\r\n    const result = await fn();\r\n    if (result.status >= 500 && result.status < 600) {\r\n        // Internal Server Error. Retry request.\r\n        return fn();\r\n    }\r\n    return result;\r\n}\r\nfunction getExpiresInFromResponseExpiresIn(responseExpiresIn) {\r\n    // This works because the server will never respond with fractions of a second.\r\n    return Number(responseExpiresIn.replace('s', '000'));\r\n}\r\nfunction getAuthorizationHeader(refreshToken) {\r\n    return `${INTERNAL_AUTH_VERSION} ${refreshToken}`;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function createInstallationRequest({ appConfig, heartbeatServiceProvider }, { fid }) {\r\n    const endpoint = getInstallationsEndpoint(appConfig);\r\n    const headers = getHeaders(appConfig);\r\n    // If heartbeat service exists, add the heartbeat string to the header.\r\n    const heartbeatService = heartbeatServiceProvider.getImmediate({\r\n        optional: true\r\n    });\r\n    if (heartbeatService) {\r\n        const heartbeatsHeader = await heartbeatService.getHeartbeatsHeader();\r\n        if (heartbeatsHeader) {\r\n            headers.append('x-firebase-client', heartbeatsHeader);\r\n        }\r\n    }\r\n    const body = {\r\n        fid,\r\n        authVersion: INTERNAL_AUTH_VERSION,\r\n        appId: appConfig.appId,\r\n        sdkVersion: PACKAGE_VERSION\r\n    };\r\n    const request = {\r\n        method: 'POST',\r\n        headers,\r\n        body: JSON.stringify(body)\r\n    };\r\n    const response = await retryIfServerError(() => fetch(endpoint, request));\r\n    if (response.ok) {\r\n        const responseValue = await response.json();\r\n        const registeredInstallationEntry = {\r\n            fid: responseValue.fid || fid,\r\n            registrationStatus: 2 /* RequestStatus.COMPLETED */,\r\n            refreshToken: responseValue.refreshToken,\r\n            authToken: extractAuthTokenInfoFromResponse(responseValue.authToken)\r\n        };\r\n        return registeredInstallationEntry;\r\n    }\r\n    else {\r\n        throw await getErrorFromResponse('Create Installation', response);\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/** Returns a promise that resolves after given time passes. */\r\nfunction sleep(ms) {\r\n    return new Promise(resolve => {\r\n        setTimeout(resolve, ms);\r\n    });\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction bufferToBase64UrlSafe(array) {\r\n    const b64 = btoa(String.fromCharCode(...array));\r\n    return b64.replace(/\\+/g, '-').replace(/\\//g, '_');\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst VALID_FID_PATTERN = /^[cdef][\\w-]{21}$/;\r\nconst INVALID_FID = '';\r\n/**\r\n * Generates a new FID using random values from Web Crypto API.\r\n * Returns an empty string if FID generation fails for any reason.\r\n */\r\nfunction generateFid() {\r\n    try {\r\n        // A valid FID has exactly 22 base64 characters, which is 132 bits, or 16.5\r\n        // bytes. our implementation generates a 17 byte array instead.\r\n        const fidByteArray = new Uint8Array(17);\r\n        const crypto = self.crypto || self.msCrypto;\r\n        crypto.getRandomValues(fidByteArray);\r\n        // Replace the first 4 random bits with the constant FID header of 0b0111.\r\n        fidByteArray[0] = 0b01110000 + (fidByteArray[0] % 0b00010000);\r\n        const fid = encode(fidByteArray);\r\n        return VALID_FID_PATTERN.test(fid) ? fid : INVALID_FID;\r\n    }\r\n    catch (_a) {\r\n        // FID generation errored\r\n        return INVALID_FID;\r\n    }\r\n}\r\n/** Converts a FID Uint8Array to a base64 string representation. */\r\nfunction encode(fidByteArray) {\r\n    const b64String = bufferToBase64UrlSafe(fidByteArray);\r\n    // Remove the 23rd character that was added because of the extra 4 bits at the\r\n    // end of our 17 byte array, and the '=' padding.\r\n    return b64String.substr(0, 22);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/** Returns a string key that can be used to identify the app. */\r\nfunction getKey(appConfig) {\r\n    return `${appConfig.appName}!${appConfig.appId}`;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst fidChangeCallbacks = new Map();\r\n/**\r\n * Calls the onIdChange callbacks with the new FID value, and broadcasts the\r\n * change to other tabs.\r\n */\r\nfunction fidChanged(appConfig, fid) {\r\n    const key = getKey(appConfig);\r\n    callFidChangeCallbacks(key, fid);\r\n    broadcastFidChange(key, fid);\r\n}\r\nfunction addCallback(appConfig, callback) {\r\n    // Open the broadcast channel if it's not already open,\r\n    // to be able to listen to change events from other tabs.\r\n    getBroadcastChannel();\r\n    const key = getKey(appConfig);\r\n    let callbackSet = fidChangeCallbacks.get(key);\r\n    if (!callbackSet) {\r\n        callbackSet = new Set();\r\n        fidChangeCallbacks.set(key, callbackSet);\r\n    }\r\n    callbackSet.add(callback);\r\n}\r\nfunction removeCallback(appConfig, callback) {\r\n    const key = getKey(appConfig);\r\n    const callbackSet = fidChangeCallbacks.get(key);\r\n    if (!callbackSet) {\r\n        return;\r\n    }\r\n    callbackSet.delete(callback);\r\n    if (callbackSet.size === 0) {\r\n        fidChangeCallbacks.delete(key);\r\n    }\r\n    // Close broadcast channel if there are no more callbacks.\r\n    closeBroadcastChannel();\r\n}\r\nfunction callFidChangeCallbacks(key, fid) {\r\n    const callbacks = fidChangeCallbacks.get(key);\r\n    if (!callbacks) {\r\n        return;\r\n    }\r\n    for (const callback of callbacks) {\r\n        callback(fid);\r\n    }\r\n}\r\nfunction broadcastFidChange(key, fid) {\r\n    const channel = getBroadcastChannel();\r\n    if (channel) {\r\n        channel.postMessage({ key, fid });\r\n    }\r\n    closeBroadcastChannel();\r\n}\r\nlet broadcastChannel = null;\r\n/** Opens and returns a BroadcastChannel if it is supported by the browser. */\r\nfunction getBroadcastChannel() {\r\n    if (!broadcastChannel && 'BroadcastChannel' in self) {\r\n        broadcastChannel = new BroadcastChannel('[Firebase] FID Change');\r\n        broadcastChannel.onmessage = e => {\r\n            callFidChangeCallbacks(e.data.key, e.data.fid);\r\n        };\r\n    }\r\n    return broadcastChannel;\r\n}\r\nfunction closeBroadcastChannel() {\r\n    if (fidChangeCallbacks.size === 0 && broadcastChannel) {\r\n        broadcastChannel.close();\r\n        broadcastChannel = null;\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst DATABASE_NAME = 'firebase-installations-database';\r\nconst DATABASE_VERSION = 1;\r\nconst OBJECT_STORE_NAME = 'firebase-installations-store';\r\nlet dbPromise = null;\r\nfunction getDbPromise() {\r\n    if (!dbPromise) {\r\n        dbPromise = openDB(DATABASE_NAME, DATABASE_VERSION, {\r\n            upgrade: (db, oldVersion) => {\r\n                // We don't use 'break' in this switch statement, the fall-through\r\n                // behavior is what we want, because if there are multiple versions between\r\n                // the old version and the current version, we want ALL the migrations\r\n                // that correspond to those versions to run, not only the last one.\r\n                // eslint-disable-next-line default-case\r\n                switch (oldVersion) {\r\n                    case 0:\r\n                        db.createObjectStore(OBJECT_STORE_NAME);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return dbPromise;\r\n}\r\n/** Assigns or overwrites the record for the given key with the given value. */\r\nasync function set(appConfig, value) {\r\n    const key = getKey(appConfig);\r\n    const db = await getDbPromise();\r\n    const tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\r\n    const objectStore = tx.objectStore(OBJECT_STORE_NAME);\r\n    const oldValue = (await objectStore.get(key));\r\n    await objectStore.put(value, key);\r\n    await tx.done;\r\n    if (!oldValue || oldValue.fid !== value.fid) {\r\n        fidChanged(appConfig, value.fid);\r\n    }\r\n    return value;\r\n}\r\n/** Removes record(s) from the objectStore that match the given key. */\r\nasync function remove(appConfig) {\r\n    const key = getKey(appConfig);\r\n    const db = await getDbPromise();\r\n    const tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\r\n    await tx.objectStore(OBJECT_STORE_NAME).delete(key);\r\n    await tx.done;\r\n}\r\n/**\r\n * Atomically updates a record with the result of updateFn, which gets\r\n * called with the current value. If newValue is undefined, the record is\r\n * deleted instead.\r\n * @return Updated value\r\n */\r\nasync function update(appConfig, updateFn) {\r\n    const key = getKey(appConfig);\r\n    const db = await getDbPromise();\r\n    const tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\r\n    const store = tx.objectStore(OBJECT_STORE_NAME);\r\n    const oldValue = (await store.get(key));\r\n    const newValue = updateFn(oldValue);\r\n    if (newValue === undefined) {\r\n        await store.delete(key);\r\n    }\r\n    else {\r\n        await store.put(newValue, key);\r\n    }\r\n    await tx.done;\r\n    if (newValue && (!oldValue || oldValue.fid !== newValue.fid)) {\r\n        fidChanged(appConfig, newValue.fid);\r\n    }\r\n    return newValue;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Updates and returns the InstallationEntry from the database.\r\n * Also triggers a registration request if it is necessary and possible.\r\n */\r\nasync function getInstallationEntry(installations) {\r\n    let registrationPromise;\r\n    const installationEntry = await update(installations.appConfig, oldEntry => {\r\n        const installationEntry = updateOrCreateInstallationEntry(oldEntry);\r\n        const entryWithPromise = triggerRegistrationIfNecessary(installations, installationEntry);\r\n        registrationPromise = entryWithPromise.registrationPromise;\r\n        return entryWithPromise.installationEntry;\r\n    });\r\n    if (installationEntry.fid === INVALID_FID) {\r\n        // FID generation failed. Waiting for the FID from the server.\r\n        return { installationEntry: await registrationPromise };\r\n    }\r\n    return {\r\n        installationEntry,\r\n        registrationPromise\r\n    };\r\n}\r\n/**\r\n * Creates a new Installation Entry if one does not exist.\r\n * Also clears timed out pending requests.\r\n */\r\nfunction updateOrCreateInstallationEntry(oldEntry) {\r\n    const entry = oldEntry || {\r\n        fid: generateFid(),\r\n        registrationStatus: 0 /* RequestStatus.NOT_STARTED */\r\n    };\r\n    return clearTimedOutRequest(entry);\r\n}\r\n/**\r\n * If the Firebase Installation is not registered yet, this will trigger the\r\n * registration and return an InProgressInstallationEntry.\r\n *\r\n * If registrationPromise does not exist, the installationEntry is guaranteed\r\n * to be registered.\r\n */\r\nfunction triggerRegistrationIfNecessary(installations, installationEntry) {\r\n    if (installationEntry.registrationStatus === 0 /* RequestStatus.NOT_STARTED */) {\r\n        if (!navigator.onLine) {\r\n            // Registration required but app is offline.\r\n            const registrationPromiseWithError = Promise.reject(ERROR_FACTORY.create(\"app-offline\" /* ErrorCode.APP_OFFLINE */));\r\n            return {\r\n                installationEntry,\r\n                registrationPromise: registrationPromiseWithError\r\n            };\r\n        }\r\n        // Try registering. Change status to IN_PROGRESS.\r\n        const inProgressEntry = {\r\n            fid: installationEntry.fid,\r\n            registrationStatus: 1 /* RequestStatus.IN_PROGRESS */,\r\n            registrationTime: Date.now()\r\n        };\r\n        const registrationPromise = registerInstallation(installations, inProgressEntry);\r\n        return { installationEntry: inProgressEntry, registrationPromise };\r\n    }\r\n    else if (installationEntry.registrationStatus === 1 /* RequestStatus.IN_PROGRESS */) {\r\n        return {\r\n            installationEntry,\r\n            registrationPromise: waitUntilFidRegistration(installations)\r\n        };\r\n    }\r\n    else {\r\n        return { installationEntry };\r\n    }\r\n}\r\n/** This will be executed only once for each new Firebase Installation. */\r\nasync function registerInstallation(installations, installationEntry) {\r\n    try {\r\n        const registeredInstallationEntry = await createInstallationRequest(installations, installationEntry);\r\n        return set(installations.appConfig, registeredInstallationEntry);\r\n    }\r\n    catch (e) {\r\n        if (isServerError(e) && e.customData.serverCode === 409) {\r\n            // Server returned a \"FID cannot be used\" error.\r\n            // Generate a new ID next time.\r\n            await remove(installations.appConfig);\r\n        }\r\n        else {\r\n            // Registration failed. Set FID as not registered.\r\n            await set(installations.appConfig, {\r\n                fid: installationEntry.fid,\r\n                registrationStatus: 0 /* RequestStatus.NOT_STARTED */\r\n            });\r\n        }\r\n        throw e;\r\n    }\r\n}\r\n/** Call if FID registration is pending in another request. */\r\nasync function waitUntilFidRegistration(installations) {\r\n    // Unfortunately, there is no way of reliably observing when a value in\r\n    // IndexedDB changes (yet, see https://github.com/WICG/indexed-db-observers),\r\n    // so we need to poll.\r\n    let entry = await updateInstallationRequest(installations.appConfig);\r\n    while (entry.registrationStatus === 1 /* RequestStatus.IN_PROGRESS */) {\r\n        // createInstallation request still in progress.\r\n        await sleep(100);\r\n        entry = await updateInstallationRequest(installations.appConfig);\r\n    }\r\n    if (entry.registrationStatus === 0 /* RequestStatus.NOT_STARTED */) {\r\n        // The request timed out or failed in a different call. Try again.\r\n        const { installationEntry, registrationPromise } = await getInstallationEntry(installations);\r\n        if (registrationPromise) {\r\n            return registrationPromise;\r\n        }\r\n        else {\r\n            // if there is no registrationPromise, entry is registered.\r\n            return installationEntry;\r\n        }\r\n    }\r\n    return entry;\r\n}\r\n/**\r\n * Called only if there is a CreateInstallation request in progress.\r\n *\r\n * Updates the InstallationEntry in the DB based on the status of the\r\n * CreateInstallation request.\r\n *\r\n * Returns the updated InstallationEntry.\r\n */\r\nfunction updateInstallationRequest(appConfig) {\r\n    return update(appConfig, oldEntry => {\r\n        if (!oldEntry) {\r\n            throw ERROR_FACTORY.create(\"installation-not-found\" /* ErrorCode.INSTALLATION_NOT_FOUND */);\r\n        }\r\n        return clearTimedOutRequest(oldEntry);\r\n    });\r\n}\r\nfunction clearTimedOutRequest(entry) {\r\n    if (hasInstallationRequestTimedOut(entry)) {\r\n        return {\r\n            fid: entry.fid,\r\n            registrationStatus: 0 /* RequestStatus.NOT_STARTED */\r\n        };\r\n    }\r\n    return entry;\r\n}\r\nfunction hasInstallationRequestTimedOut(installationEntry) {\r\n    return (installationEntry.registrationStatus === 1 /* RequestStatus.IN_PROGRESS */ &&\r\n        installationEntry.registrationTime + PENDING_TIMEOUT_MS < Date.now());\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function generateAuthTokenRequest({ appConfig, heartbeatServiceProvider }, installationEntry) {\r\n    const endpoint = getGenerateAuthTokenEndpoint(appConfig, installationEntry);\r\n    const headers = getHeadersWithAuth(appConfig, installationEntry);\r\n    // If heartbeat service exists, add the heartbeat string to the header.\r\n    const heartbeatService = heartbeatServiceProvider.getImmediate({\r\n        optional: true\r\n    });\r\n    if (heartbeatService) {\r\n        const heartbeatsHeader = await heartbeatService.getHeartbeatsHeader();\r\n        if (heartbeatsHeader) {\r\n            headers.append('x-firebase-client', heartbeatsHeader);\r\n        }\r\n    }\r\n    const body = {\r\n        installation: {\r\n            sdkVersion: PACKAGE_VERSION,\r\n            appId: appConfig.appId\r\n        }\r\n    };\r\n    const request = {\r\n        method: 'POST',\r\n        headers,\r\n        body: JSON.stringify(body)\r\n    };\r\n    const response = await retryIfServerError(() => fetch(endpoint, request));\r\n    if (response.ok) {\r\n        const responseValue = await response.json();\r\n        const completedAuthToken = extractAuthTokenInfoFromResponse(responseValue);\r\n        return completedAuthToken;\r\n    }\r\n    else {\r\n        throw await getErrorFromResponse('Generate Auth Token', response);\r\n    }\r\n}\r\nfunction getGenerateAuthTokenEndpoint(appConfig, { fid }) {\r\n    return `${getInstallationsEndpoint(appConfig)}/${fid}/authTokens:generate`;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns a valid authentication token for the installation. Generates a new\r\n * token if one doesn't exist, is expired or about to expire.\r\n *\r\n * Should only be called if the Firebase Installation is registered.\r\n */\r\nasync function refreshAuthToken(installations, forceRefresh = false) {\r\n    let tokenPromise;\r\n    const entry = await update(installations.appConfig, oldEntry => {\r\n        if (!isEntryRegistered(oldEntry)) {\r\n            throw ERROR_FACTORY.create(\"not-registered\" /* ErrorCode.NOT_REGISTERED */);\r\n        }\r\n        const oldAuthToken = oldEntry.authToken;\r\n        if (!forceRefresh && isAuthTokenValid(oldAuthToken)) {\r\n            // There is a valid token in the DB.\r\n            return oldEntry;\r\n        }\r\n        else if (oldAuthToken.requestStatus === 1 /* RequestStatus.IN_PROGRESS */) {\r\n            // There already is a token request in progress.\r\n            tokenPromise = waitUntilAuthTokenRequest(installations, forceRefresh);\r\n            return oldEntry;\r\n        }\r\n        else {\r\n            // No token or token expired.\r\n            if (!navigator.onLine) {\r\n                throw ERROR_FACTORY.create(\"app-offline\" /* ErrorCode.APP_OFFLINE */);\r\n            }\r\n            const inProgressEntry = makeAuthTokenRequestInProgressEntry(oldEntry);\r\n            tokenPromise = fetchAuthTokenFromServer(installations, inProgressEntry);\r\n            return inProgressEntry;\r\n        }\r\n    });\r\n    const authToken = tokenPromise\r\n        ? await tokenPromise\r\n        : entry.authToken;\r\n    return authToken;\r\n}\r\n/**\r\n * Call only if FID is registered and Auth Token request is in progress.\r\n *\r\n * Waits until the current pending request finishes. If the request times out,\r\n * tries once in this thread as well.\r\n */\r\nasync function waitUntilAuthTokenRequest(installations, forceRefresh) {\r\n    // Unfortunately, there is no way of reliably observing when a value in\r\n    // IndexedDB changes (yet, see https://github.com/WICG/indexed-db-observers),\r\n    // so we need to poll.\r\n    let entry = await updateAuthTokenRequest(installations.appConfig);\r\n    while (entry.authToken.requestStatus === 1 /* RequestStatus.IN_PROGRESS */) {\r\n        // generateAuthToken still in progress.\r\n        await sleep(100);\r\n        entry = await updateAuthTokenRequest(installations.appConfig);\r\n    }\r\n    const authToken = entry.authToken;\r\n    if (authToken.requestStatus === 0 /* RequestStatus.NOT_STARTED */) {\r\n        // The request timed out or failed in a different call. Try again.\r\n        return refreshAuthToken(installations, forceRefresh);\r\n    }\r\n    else {\r\n        return authToken;\r\n    }\r\n}\r\n/**\r\n * Called only if there is a GenerateAuthToken request in progress.\r\n *\r\n * Updates the InstallationEntry in the DB based on the status of the\r\n * GenerateAuthToken request.\r\n *\r\n * Returns the updated InstallationEntry.\r\n */\r\nfunction updateAuthTokenRequest(appConfig) {\r\n    return update(appConfig, oldEntry => {\r\n        if (!isEntryRegistered(oldEntry)) {\r\n            throw ERROR_FACTORY.create(\"not-registered\" /* ErrorCode.NOT_REGISTERED */);\r\n        }\r\n        const oldAuthToken = oldEntry.authToken;\r\n        if (hasAuthTokenRequestTimedOut(oldAuthToken)) {\r\n            return Object.assign(Object.assign({}, oldEntry), { authToken: { requestStatus: 0 /* RequestStatus.NOT_STARTED */ } });\r\n        }\r\n        return oldEntry;\r\n    });\r\n}\r\nasync function fetchAuthTokenFromServer(installations, installationEntry) {\r\n    try {\r\n        const authToken = await generateAuthTokenRequest(installations, installationEntry);\r\n        const updatedInstallationEntry = Object.assign(Object.assign({}, installationEntry), { authToken });\r\n        await set(installations.appConfig, updatedInstallationEntry);\r\n        return authToken;\r\n    }\r\n    catch (e) {\r\n        if (isServerError(e) &&\r\n            (e.customData.serverCode === 401 || e.customData.serverCode === 404)) {\r\n            // Server returned a \"FID not found\" or a \"Invalid authentication\" error.\r\n            // Generate a new ID next time.\r\n            await remove(installations.appConfig);\r\n        }\r\n        else {\r\n            const updatedInstallationEntry = Object.assign(Object.assign({}, installationEntry), { authToken: { requestStatus: 0 /* RequestStatus.NOT_STARTED */ } });\r\n            await set(installations.appConfig, updatedInstallationEntry);\r\n        }\r\n        throw e;\r\n    }\r\n}\r\nfunction isEntryRegistered(installationEntry) {\r\n    return (installationEntry !== undefined &&\r\n        installationEntry.registrationStatus === 2 /* RequestStatus.COMPLETED */);\r\n}\r\nfunction isAuthTokenValid(authToken) {\r\n    return (authToken.requestStatus === 2 /* RequestStatus.COMPLETED */ &&\r\n        !isAuthTokenExpired(authToken));\r\n}\r\nfunction isAuthTokenExpired(authToken) {\r\n    const now = Date.now();\r\n    return (now < authToken.creationTime ||\r\n        authToken.creationTime + authToken.expiresIn < now + TOKEN_EXPIRATION_BUFFER);\r\n}\r\n/** Returns an updated InstallationEntry with an InProgressAuthToken. */\r\nfunction makeAuthTokenRequestInProgressEntry(oldEntry) {\r\n    const inProgressAuthToken = {\r\n        requestStatus: 1 /* RequestStatus.IN_PROGRESS */,\r\n        requestTime: Date.now()\r\n    };\r\n    return Object.assign(Object.assign({}, oldEntry), { authToken: inProgressAuthToken });\r\n}\r\nfunction hasAuthTokenRequestTimedOut(authToken) {\r\n    return (authToken.requestStatus === 1 /* RequestStatus.IN_PROGRESS */ &&\r\n        authToken.requestTime + PENDING_TIMEOUT_MS < Date.now());\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Creates a Firebase Installation if there isn't one for the app and\r\n * returns the Installation ID.\r\n * @param installations - The `Installations` instance.\r\n *\r\n * @public\r\n */\r\nasync function getId(installations) {\r\n    const installationsImpl = installations;\r\n    const { installationEntry, registrationPromise } = await getInstallationEntry(installationsImpl);\r\n    if (registrationPromise) {\r\n        registrationPromise.catch(console.error);\r\n    }\r\n    else {\r\n        // If the installation is already registered, update the authentication\r\n        // token if needed.\r\n        refreshAuthToken(installationsImpl).catch(console.error);\r\n    }\r\n    return installationEntry.fid;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns a Firebase Installations auth token, identifying the current\r\n * Firebase Installation.\r\n * @param installations - The `Installations` instance.\r\n * @param forceRefresh - Force refresh regardless of token expiration.\r\n *\r\n * @public\r\n */\r\nasync function getToken(installations, forceRefresh = false) {\r\n    const installationsImpl = installations;\r\n    await completeInstallationRegistration(installationsImpl);\r\n    // At this point we either have a Registered Installation in the DB, or we've\r\n    // already thrown an error.\r\n    const authToken = await refreshAuthToken(installationsImpl, forceRefresh);\r\n    return authToken.token;\r\n}\r\nasync function completeInstallationRegistration(installations) {\r\n    const { registrationPromise } = await getInstallationEntry(installations);\r\n    if (registrationPromise) {\r\n        // A createInstallation request is in progress. Wait until it finishes.\r\n        await registrationPromise;\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function deleteInstallationRequest(appConfig, installationEntry) {\r\n    const endpoint = getDeleteEndpoint(appConfig, installationEntry);\r\n    const headers = getHeadersWithAuth(appConfig, installationEntry);\r\n    const request = {\r\n        method: 'DELETE',\r\n        headers\r\n    };\r\n    const response = await retryIfServerError(() => fetch(endpoint, request));\r\n    if (!response.ok) {\r\n        throw await getErrorFromResponse('Delete Installation', response);\r\n    }\r\n}\r\nfunction getDeleteEndpoint(appConfig, { fid }) {\r\n    return `${getInstallationsEndpoint(appConfig)}/${fid}`;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Deletes the Firebase Installation and all associated data.\r\n * @param installations - The `Installations` instance.\r\n *\r\n * @public\r\n */\r\nasync function deleteInstallations(installations) {\r\n    const { appConfig } = installations;\r\n    const entry = await update(appConfig, oldEntry => {\r\n        if (oldEntry && oldEntry.registrationStatus === 0 /* RequestStatus.NOT_STARTED */) {\r\n            // Delete the unregistered entry without sending a deleteInstallation request.\r\n            return undefined;\r\n        }\r\n        return oldEntry;\r\n    });\r\n    if (entry) {\r\n        if (entry.registrationStatus === 1 /* RequestStatus.IN_PROGRESS */) {\r\n            // Can't delete while trying to register.\r\n            throw ERROR_FACTORY.create(\"delete-pending-registration\" /* ErrorCode.DELETE_PENDING_REGISTRATION */);\r\n        }\r\n        else if (entry.registrationStatus === 2 /* RequestStatus.COMPLETED */) {\r\n            if (!navigator.onLine) {\r\n                throw ERROR_FACTORY.create(\"app-offline\" /* ErrorCode.APP_OFFLINE */);\r\n            }\r\n            else {\r\n                await deleteInstallationRequest(appConfig, entry);\r\n                await remove(appConfig);\r\n            }\r\n        }\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Sets a new callback that will get called when Installation ID changes.\r\n * Returns an unsubscribe function that will remove the callback when called.\r\n * @param installations - The `Installations` instance.\r\n * @param callback - The callback function that is invoked when FID changes.\r\n * @returns A function that can be called to unsubscribe.\r\n *\r\n * @public\r\n */\r\nfunction onIdChange(installations, callback) {\r\n    const { appConfig } = installations;\r\n    addCallback(appConfig, callback);\r\n    return () => {\r\n        removeCallback(appConfig, callback);\r\n    };\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns an instance of {@link Installations} associated with the given\r\n * {@link @firebase/app#FirebaseApp} instance.\r\n * @param app - The {@link @firebase/app#FirebaseApp} instance.\r\n *\r\n * @public\r\n */\r\nfunction getInstallations(app = getApp()) {\r\n    const installationsImpl = _getProvider(app, 'installations').getImmediate();\r\n    return installationsImpl;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction extractAppConfig(app) {\r\n    if (!app || !app.options) {\r\n        throw getMissingValueError('App Configuration');\r\n    }\r\n    if (!app.name) {\r\n        throw getMissingValueError('App Name');\r\n    }\r\n    // Required app config keys\r\n    const configKeys = [\r\n        'projectId',\r\n        'apiKey',\r\n        'appId'\r\n    ];\r\n    for (const keyName of configKeys) {\r\n        if (!app.options[keyName]) {\r\n            throw getMissingValueError(keyName);\r\n        }\r\n    }\r\n    return {\r\n        appName: app.name,\r\n        projectId: app.options.projectId,\r\n        apiKey: app.options.apiKey,\r\n        appId: app.options.appId\r\n    };\r\n}\r\nfunction getMissingValueError(valueName) {\r\n    return ERROR_FACTORY.create(\"missing-app-config-values\" /* ErrorCode.MISSING_APP_CONFIG_VALUES */, {\r\n        valueName\r\n    });\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst INSTALLATIONS_NAME = 'installations';\r\nconst INSTALLATIONS_NAME_INTERNAL = 'installations-internal';\r\nconst publicFactory = (container) => {\r\n    const app = container.getProvider('app').getImmediate();\r\n    // Throws if app isn't configured properly.\r\n    const appConfig = extractAppConfig(app);\r\n    const heartbeatServiceProvider = _getProvider(app, 'heartbeat');\r\n    const installationsImpl = {\r\n        app,\r\n        appConfig,\r\n        heartbeatServiceProvider,\r\n        _delete: () => Promise.resolve()\r\n    };\r\n    return installationsImpl;\r\n};\r\nconst internalFactory = (container) => {\r\n    const app = container.getProvider('app').getImmediate();\r\n    // Internal FIS instance relies on public FIS instance.\r\n    const installations = _getProvider(app, INSTALLATIONS_NAME).getImmediate();\r\n    const installationsInternal = {\r\n        getId: () => getId(installations),\r\n        getToken: (forceRefresh) => getToken(installations, forceRefresh)\r\n    };\r\n    return installationsInternal;\r\n};\r\nfunction registerInstallations() {\r\n    _registerComponent(new Component(INSTALLATIONS_NAME, publicFactory, \"PUBLIC\" /* ComponentType.PUBLIC */));\r\n    _registerComponent(new Component(INSTALLATIONS_NAME_INTERNAL, internalFactory, \"PRIVATE\" /* ComponentType.PRIVATE */));\r\n}\n\n/**\r\n * The Firebase Installations Web SDK.\r\n * This SDK does not work in a Node.js environment.\r\n *\r\n * @packageDocumentation\r\n */\r\nregisterInstallations();\r\nregisterVersion(name, version);\r\n// BUILD_TARGET will be replaced by values like esm5, esm2017, cjs5, etc during the compilation\r\nregisterVersion(name, version, 'esm2017');\n\nexport { deleteInstallations, getId, getInstallations, getToken, onIdChange };\n//# sourceMappingURL=index.esm2017.js.map\n","import { _getProvider, getApp, _registerComponent, registerVersion } from '@firebase/app';\nimport { Logger } from '@firebase/logger';\nimport { ErrorFactory, calculateBackoffMillis, FirebaseError, isIndexedDBAvailable, validateIndexedDBOpenable, isBrowserExtension, areCookiesEnabled, getModularInstance, deepEqual } from '@firebase/util';\nimport { Component } from '@firebase/component';\nimport '@firebase/installations';\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Type constant for Firebase Analytics.\r\n */\r\nconst ANALYTICS_TYPE = 'analytics';\r\n// Key to attach FID to in gtag params.\r\nconst GA_FID_KEY = 'firebase_id';\r\nconst ORIGIN_KEY = 'origin';\r\nconst FETCH_TIMEOUT_MILLIS = 60 * 1000;\r\nconst DYNAMIC_CONFIG_URL = 'https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig';\r\nconst GTAG_URL = 'https://www.googletagmanager.com/gtag/js';\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst logger = new Logger('@firebase/analytics');\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst ERRORS = {\r\n    [\"already-exists\" /* AnalyticsError.ALREADY_EXISTS */]: 'A Firebase Analytics instance with the appId {$id} ' +\r\n        ' already exists. ' +\r\n        'Only one Firebase Analytics instance can be created for each appId.',\r\n    [\"already-initialized\" /* AnalyticsError.ALREADY_INITIALIZED */]: 'initializeAnalytics() cannot be called again with different options than those ' +\r\n        'it was initially called with. It can be called again with the same options to ' +\r\n        'return the existing instance, or getAnalytics() can be used ' +\r\n        'to get a reference to the already-initialized instance.',\r\n    [\"already-initialized-settings\" /* AnalyticsError.ALREADY_INITIALIZED_SETTINGS */]: 'Firebase Analytics has already been initialized.' +\r\n        'settings() must be called before initializing any Analytics instance' +\r\n        'or it will have no effect.',\r\n    [\"interop-component-reg-failed\" /* AnalyticsError.INTEROP_COMPONENT_REG_FAILED */]: 'Firebase Analytics Interop Component failed to instantiate: {$reason}',\r\n    [\"invalid-analytics-context\" /* AnalyticsError.INVALID_ANALYTICS_CONTEXT */]: 'Firebase Analytics is not supported in this environment. ' +\r\n        'Wrap initialization of analytics in analytics.isSupported() ' +\r\n        'to prevent initialization in unsupported environments. Details: {$errorInfo}',\r\n    [\"indexeddb-unavailable\" /* AnalyticsError.INDEXEDDB_UNAVAILABLE */]: 'IndexedDB unavailable or restricted in this environment. ' +\r\n        'Wrap initialization of analytics in analytics.isSupported() ' +\r\n        'to prevent initialization in unsupported environments. Details: {$errorInfo}',\r\n    [\"fetch-throttle\" /* AnalyticsError.FETCH_THROTTLE */]: 'The config fetch request timed out while in an exponential backoff state.' +\r\n        ' Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',\r\n    [\"config-fetch-failed\" /* AnalyticsError.CONFIG_FETCH_FAILED */]: 'Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}',\r\n    [\"no-api-key\" /* AnalyticsError.NO_API_KEY */]: 'The \"apiKey\" field is empty in the local Firebase config. Firebase Analytics requires this field to' +\r\n        'contain a valid API key.',\r\n    [\"no-app-id\" /* AnalyticsError.NO_APP_ID */]: 'The \"appId\" field is empty in the local Firebase config. Firebase Analytics requires this field to' +\r\n        'contain a valid app ID.',\r\n    [\"no-client-id\" /* AnalyticsError.NO_CLIENT_ID */]: 'The \"client_id\" field is empty.',\r\n    [\"invalid-gtag-resource\" /* AnalyticsError.INVALID_GTAG_RESOURCE */]: 'Trusted Types detected an invalid gtag resource: {$gtagURL}.'\r\n};\r\nconst ERROR_FACTORY = new ErrorFactory('analytics', 'Analytics', ERRORS);\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Verifies and creates a TrustedScriptURL.\r\n */\r\nfunction createGtagTrustedTypesScriptURL(url) {\r\n    if (!url.startsWith(GTAG_URL)) {\r\n        const err = ERROR_FACTORY.create(\"invalid-gtag-resource\" /* AnalyticsError.INVALID_GTAG_RESOURCE */, {\r\n            gtagURL: url\r\n        });\r\n        logger.warn(err.message);\r\n        return '';\r\n    }\r\n    return url;\r\n}\r\n/**\r\n * Makeshift polyfill for Promise.allSettled(). Resolves when all promises\r\n * have either resolved or rejected.\r\n *\r\n * @param promises Array of promises to wait for.\r\n */\r\nfunction promiseAllSettled(promises) {\r\n    return Promise.all(promises.map(promise => promise.catch(e => e)));\r\n}\r\n/**\r\n * Creates a TrustedTypePolicy object that implements the rules passed as policyOptions.\r\n *\r\n * @param policyName A string containing the name of the policy\r\n * @param policyOptions Object containing implementations of instance methods for TrustedTypesPolicy, see {@link https://developer.mozilla.org/en-US/docs/Web/API/TrustedTypePolicy#instance_methods\r\n * | the TrustedTypePolicy reference documentation}.\r\n */\r\nfunction createTrustedTypesPolicy(policyName, policyOptions) {\r\n    // Create a TrustedTypes policy that we can use for updating src\r\n    // properties\r\n    let trustedTypesPolicy;\r\n    if (window.trustedTypes) {\r\n        trustedTypesPolicy = window.trustedTypes.createPolicy(policyName, policyOptions);\r\n    }\r\n    return trustedTypesPolicy;\r\n}\r\n/**\r\n * Inserts gtag script tag into the page to asynchronously download gtag.\r\n * @param dataLayerName Name of datalayer (most often the default, \"_dataLayer\").\r\n */\r\nfunction insertScriptTag(dataLayerName, measurementId) {\r\n    const trustedTypesPolicy = createTrustedTypesPolicy('firebase-js-sdk-policy', {\r\n        createScriptURL: createGtagTrustedTypesScriptURL\r\n    });\r\n    const script = document.createElement('script');\r\n    // We are not providing an analyticsId in the URL because it would trigger a `page_view`\r\n    // without fid. We will initialize ga-id using gtag (config) command together with fid.\r\n    const gtagScriptURL = `${GTAG_URL}?l=${dataLayerName}&id=${measurementId}`;\r\n    script.src = trustedTypesPolicy\r\n        ? trustedTypesPolicy === null || trustedTypesPolicy === void 0 ? void 0 : trustedTypesPolicy.createScriptURL(gtagScriptURL)\r\n        : gtagScriptURL;\r\n    script.async = true;\r\n    document.head.appendChild(script);\r\n}\r\n/**\r\n * Get reference to, or create, global datalayer.\r\n * @param dataLayerName Name of datalayer (most often the default, \"_dataLayer\").\r\n */\r\nfunction getOrCreateDataLayer(dataLayerName) {\r\n    // Check for existing dataLayer and create if needed.\r\n    let dataLayer = [];\r\n    if (Array.isArray(window[dataLayerName])) {\r\n        dataLayer = window[dataLayerName];\r\n    }\r\n    else {\r\n        window[dataLayerName] = dataLayer;\r\n    }\r\n    return dataLayer;\r\n}\r\n/**\r\n * Wrapped gtag logic when gtag is called with 'config' command.\r\n *\r\n * @param gtagCore Basic gtag function that just appends to dataLayer.\r\n * @param initializationPromisesMap Map of appIds to their initialization promises.\r\n * @param dynamicConfigPromisesList Array of dynamic config fetch promises.\r\n * @param measurementIdToAppId Map of GA measurementIDs to corresponding Firebase appId.\r\n * @param measurementId GA Measurement ID to set config for.\r\n * @param gtagParams Gtag config params to set.\r\n */\r\nasync function gtagOnConfig(gtagCore, initializationPromisesMap, dynamicConfigPromisesList, measurementIdToAppId, measurementId, gtagParams) {\r\n    // If config is already fetched, we know the appId and can use it to look up what FID promise we\r\n    /// are waiting for, and wait only on that one.\r\n    const correspondingAppId = measurementIdToAppId[measurementId];\r\n    try {\r\n        if (correspondingAppId) {\r\n            await initializationPromisesMap[correspondingAppId];\r\n        }\r\n        else {\r\n            // If config is not fetched yet, wait for all configs (we don't know which one we need) and\r\n            // find the appId (if any) corresponding to this measurementId. If there is one, wait on\r\n            // that appId's initialization promise. If there is none, promise resolves and gtag\r\n            // call goes through.\r\n            const dynamicConfigResults = await promiseAllSettled(dynamicConfigPromisesList);\r\n            const foundConfig = dynamicConfigResults.find(config => config.measurementId === measurementId);\r\n            if (foundConfig) {\r\n                await initializationPromisesMap[foundConfig.appId];\r\n            }\r\n        }\r\n    }\r\n    catch (e) {\r\n        logger.error(e);\r\n    }\r\n    gtagCore(\"config\" /* GtagCommand.CONFIG */, measurementId, gtagParams);\r\n}\r\n/**\r\n * Wrapped gtag logic when gtag is called with 'event' command.\r\n *\r\n * @param gtagCore Basic gtag function that just appends to dataLayer.\r\n * @param initializationPromisesMap Map of appIds to their initialization promises.\r\n * @param dynamicConfigPromisesList Array of dynamic config fetch promises.\r\n * @param measurementId GA Measurement ID to log event to.\r\n * @param gtagParams Params to log with this event.\r\n */\r\nasync function gtagOnEvent(gtagCore, initializationPromisesMap, dynamicConfigPromisesList, measurementId, gtagParams) {\r\n    try {\r\n        let initializationPromisesToWaitFor = [];\r\n        // If there's a 'send_to' param, check if any ID specified matches\r\n        // an initializeIds() promise we are waiting for.\r\n        if (gtagParams && gtagParams['send_to']) {\r\n            let gaSendToList = gtagParams['send_to'];\r\n            // Make it an array if is isn't, so it can be dealt with the same way.\r\n            if (!Array.isArray(gaSendToList)) {\r\n                gaSendToList = [gaSendToList];\r\n            }\r\n            // Checking 'send_to' fields requires having all measurement ID results back from\r\n            // the dynamic config fetch.\r\n            const dynamicConfigResults = await promiseAllSettled(dynamicConfigPromisesList);\r\n            for (const sendToId of gaSendToList) {\r\n                // Any fetched dynamic measurement ID that matches this 'send_to' ID\r\n                const foundConfig = dynamicConfigResults.find(config => config.measurementId === sendToId);\r\n                const initializationPromise = foundConfig && initializationPromisesMap[foundConfig.appId];\r\n                if (initializationPromise) {\r\n                    initializationPromisesToWaitFor.push(initializationPromise);\r\n                }\r\n                else {\r\n                    // Found an item in 'send_to' that is not associated\r\n                    // directly with an FID, possibly a group.  Empty this array,\r\n                    // exit the loop early, and let it get populated below.\r\n                    initializationPromisesToWaitFor = [];\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        // This will be unpopulated if there was no 'send_to' field , or\r\n        // if not all entries in the 'send_to' field could be mapped to\r\n        // a FID. In these cases, wait on all pending initialization promises.\r\n        if (initializationPromisesToWaitFor.length === 0) {\r\n            /* eslint-disable-next-line @typescript-eslint/no-floating-promises */\r\n            initializationPromisesToWaitFor = Object.values(initializationPromisesMap);\r\n        }\r\n        // Run core gtag function with args after all relevant initialization\r\n        // promises have been resolved.\r\n        await Promise.all(initializationPromisesToWaitFor);\r\n        // Workaround for http://b/141370449 - third argument cannot be undefined.\r\n        gtagCore(\"event\" /* GtagCommand.EVENT */, measurementId, gtagParams || {});\r\n    }\r\n    catch (e) {\r\n        logger.error(e);\r\n    }\r\n}\r\n/**\r\n * Wraps a standard gtag function with extra code to wait for completion of\r\n * relevant initialization promises before sending requests.\r\n *\r\n * @param gtagCore Basic gtag function that just appends to dataLayer.\r\n * @param initializationPromisesMap Map of appIds to their initialization promises.\r\n * @param dynamicConfigPromisesList Array of dynamic config fetch promises.\r\n * @param measurementIdToAppId Map of GA measurementIDs to corresponding Firebase appId.\r\n */\r\nfunction wrapGtag(gtagCore, \r\n/**\r\n * Allows wrapped gtag calls to wait on whichever initialization promises are required,\r\n * depending on the contents of the gtag params' `send_to` field, if any.\r\n */\r\ninitializationPromisesMap, \r\n/**\r\n * Wrapped gtag calls sometimes require all dynamic config fetches to have returned\r\n * before determining what initialization promises (which include FIDs) to wait for.\r\n */\r\ndynamicConfigPromisesList, \r\n/**\r\n * Wrapped gtag config calls can narrow down which initialization promise (with FID)\r\n * to wait for if the measurementId is already fetched, by getting the corresponding appId,\r\n * which is the key for the initialization promises map.\r\n */\r\nmeasurementIdToAppId) {\r\n    /**\r\n     * Wrapper around gtag that ensures FID is sent with gtag calls.\r\n     * @param command Gtag command type.\r\n     * @param idOrNameOrParams Measurement ID if command is EVENT/CONFIG, params if command is SET.\r\n     * @param gtagParams Params if event is EVENT/CONFIG.\r\n     */\r\n    async function gtagWrapper(command, ...args) {\r\n        try {\r\n            // If event, check that relevant initialization promises have completed.\r\n            if (command === \"event\" /* GtagCommand.EVENT */) {\r\n                const [measurementId, gtagParams] = args;\r\n                // If EVENT, second arg must be measurementId.\r\n                await gtagOnEvent(gtagCore, initializationPromisesMap, dynamicConfigPromisesList, measurementId, gtagParams);\r\n            }\r\n            else if (command === \"config\" /* GtagCommand.CONFIG */) {\r\n                const [measurementId, gtagParams] = args;\r\n                // If CONFIG, second arg must be measurementId.\r\n                await gtagOnConfig(gtagCore, initializationPromisesMap, dynamicConfigPromisesList, measurementIdToAppId, measurementId, gtagParams);\r\n            }\r\n            else if (command === \"consent\" /* GtagCommand.CONSENT */) {\r\n                const [consentAction, gtagParams] = args;\r\n                // consentAction can be one of 'default' or 'update'.\r\n                gtagCore(\"consent\" /* GtagCommand.CONSENT */, consentAction, gtagParams);\r\n            }\r\n            else if (command === \"get\" /* GtagCommand.GET */) {\r\n                const [measurementId, fieldName, callback] = args;\r\n                gtagCore(\"get\" /* GtagCommand.GET */, measurementId, fieldName, callback);\r\n            }\r\n            else if (command === \"set\" /* GtagCommand.SET */) {\r\n                const [customParams] = args;\r\n                // If SET, second arg must be params.\r\n                gtagCore(\"set\" /* GtagCommand.SET */, customParams);\r\n            }\r\n            else {\r\n                gtagCore(command, ...args);\r\n            }\r\n        }\r\n        catch (e) {\r\n            logger.error(e);\r\n        }\r\n    }\r\n    return gtagWrapper;\r\n}\r\n/**\r\n * Creates global gtag function or wraps existing one if found.\r\n * This wrapped function attaches Firebase instance ID (FID) to gtag 'config' and\r\n * 'event' calls that belong to the GAID associated with this Firebase instance.\r\n *\r\n * @param initializationPromisesMap Map of appIds to their initialization promises.\r\n * @param dynamicConfigPromisesList Array of dynamic config fetch promises.\r\n * @param measurementIdToAppId Map of GA measurementIDs to corresponding Firebase appId.\r\n * @param dataLayerName Name of global GA datalayer array.\r\n * @param gtagFunctionName Name of global gtag function (\"gtag\" if not user-specified).\r\n */\r\nfunction wrapOrCreateGtag(initializationPromisesMap, dynamicConfigPromisesList, measurementIdToAppId, dataLayerName, gtagFunctionName) {\r\n    // Create a basic core gtag function\r\n    let gtagCore = function (..._args) {\r\n        // Must push IArguments object, not an array.\r\n        window[dataLayerName].push(arguments);\r\n    };\r\n    // Replace it with existing one if found\r\n    if (window[gtagFunctionName] &&\r\n        typeof window[gtagFunctionName] === 'function') {\r\n        // @ts-ignore\r\n        gtagCore = window[gtagFunctionName];\r\n    }\r\n    window[gtagFunctionName] = wrapGtag(gtagCore, initializationPromisesMap, dynamicConfigPromisesList, measurementIdToAppId);\r\n    return {\r\n        gtagCore,\r\n        wrappedGtag: window[gtagFunctionName]\r\n    };\r\n}\r\n/**\r\n * Returns the script tag in the DOM matching both the gtag url pattern\r\n * and the provided data layer name.\r\n */\r\nfunction findGtagScriptOnPage(dataLayerName) {\r\n    const scriptTags = window.document.getElementsByTagName('script');\r\n    for (const tag of Object.values(scriptTags)) {\r\n        if (tag.src &&\r\n            tag.src.includes(GTAG_URL) &&\r\n            tag.src.includes(dataLayerName)) {\r\n            return tag;\r\n        }\r\n    }\r\n    return null;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Backoff factor for 503 errors, which we want to be conservative about\r\n * to avoid overloading servers. Each retry interval will be\r\n * BASE_INTERVAL_MILLIS * LONG_RETRY_FACTOR ^ retryCount, so the second one\r\n * will be ~30 seconds (with fuzzing).\r\n */\r\nconst LONG_RETRY_FACTOR = 30;\r\n/**\r\n * Base wait interval to multiplied by backoffFactor^backoffCount.\r\n */\r\nconst BASE_INTERVAL_MILLIS = 1000;\r\n/**\r\n * Stubbable retry data storage class.\r\n */\r\nclass RetryData {\r\n    constructor(throttleMetadata = {}, intervalMillis = BASE_INTERVAL_MILLIS) {\r\n        this.throttleMetadata = throttleMetadata;\r\n        this.intervalMillis = intervalMillis;\r\n    }\r\n    getThrottleMetadata(appId) {\r\n        return this.throttleMetadata[appId];\r\n    }\r\n    setThrottleMetadata(appId, metadata) {\r\n        this.throttleMetadata[appId] = metadata;\r\n    }\r\n    deleteThrottleMetadata(appId) {\r\n        delete this.throttleMetadata[appId];\r\n    }\r\n}\r\nconst defaultRetryData = new RetryData();\r\n/**\r\n * Set GET request headers.\r\n * @param apiKey App API key.\r\n */\r\nfunction getHeaders(apiKey) {\r\n    return new Headers({\r\n        Accept: 'application/json',\r\n        'x-goog-api-key': apiKey\r\n    });\r\n}\r\n/**\r\n * Fetches dynamic config from backend.\r\n * @param app Firebase app to fetch config for.\r\n */\r\nasync function fetchDynamicConfig(appFields) {\r\n    var _a;\r\n    const { appId, apiKey } = appFields;\r\n    const request = {\r\n        method: 'GET',\r\n        headers: getHeaders(apiKey)\r\n    };\r\n    const appUrl = DYNAMIC_CONFIG_URL.replace('{app-id}', appId);\r\n    const response = await fetch(appUrl, request);\r\n    if (response.status !== 200 && response.status !== 304) {\r\n        let errorMessage = '';\r\n        try {\r\n            // Try to get any error message text from server response.\r\n            const jsonResponse = (await response.json());\r\n            if ((_a = jsonResponse.error) === null || _a === void 0 ? void 0 : _a.message) {\r\n                errorMessage = jsonResponse.error.message;\r\n            }\r\n        }\r\n        catch (_ignored) { }\r\n        throw ERROR_FACTORY.create(\"config-fetch-failed\" /* AnalyticsError.CONFIG_FETCH_FAILED */, {\r\n            httpStatus: response.status,\r\n            responseMessage: errorMessage\r\n        });\r\n    }\r\n    return response.json();\r\n}\r\n/**\r\n * Fetches dynamic config from backend, retrying if failed.\r\n * @param app Firebase app to fetch config for.\r\n */\r\nasync function fetchDynamicConfigWithRetry(app, \r\n// retryData and timeoutMillis are parameterized to allow passing a different value for testing.\r\nretryData = defaultRetryData, timeoutMillis) {\r\n    const { appId, apiKey, measurementId } = app.options;\r\n    if (!appId) {\r\n        throw ERROR_FACTORY.create(\"no-app-id\" /* AnalyticsError.NO_APP_ID */);\r\n    }\r\n    if (!apiKey) {\r\n        if (measurementId) {\r\n            return {\r\n                measurementId,\r\n                appId\r\n            };\r\n        }\r\n        throw ERROR_FACTORY.create(\"no-api-key\" /* AnalyticsError.NO_API_KEY */);\r\n    }\r\n    const throttleMetadata = retryData.getThrottleMetadata(appId) || {\r\n        backoffCount: 0,\r\n        throttleEndTimeMillis: Date.now()\r\n    };\r\n    const signal = new AnalyticsAbortSignal();\r\n    setTimeout(async () => {\r\n        // Note a very low delay, eg < 10ms, can elapse before listeners are initialized.\r\n        signal.abort();\r\n    }, timeoutMillis !== undefined ? timeoutMillis : FETCH_TIMEOUT_MILLIS);\r\n    return attemptFetchDynamicConfigWithRetry({ appId, apiKey, measurementId }, throttleMetadata, signal, retryData);\r\n}\r\n/**\r\n * Runs one retry attempt.\r\n * @param appFields Necessary app config fields.\r\n * @param throttleMetadata Ongoing metadata to determine throttling times.\r\n * @param signal Abort signal.\r\n */\r\nasync function attemptFetchDynamicConfigWithRetry(appFields, { throttleEndTimeMillis, backoffCount }, signal, retryData = defaultRetryData // for testing\r\n) {\r\n    var _a;\r\n    const { appId, measurementId } = appFields;\r\n    // Starts with a (potentially zero) timeout to support resumption from stored state.\r\n    // Ensures the throttle end time is honored if the last attempt timed out.\r\n    // Note the SDK will never make a request if the fetch timeout expires at this point.\r\n    try {\r\n        await setAbortableTimeout(signal, throttleEndTimeMillis);\r\n    }\r\n    catch (e) {\r\n        if (measurementId) {\r\n            logger.warn(`Timed out fetching this Firebase app's measurement ID from the server.` +\r\n                ` Falling back to the measurement ID ${measurementId}` +\r\n                ` provided in the \"measurementId\" field in the local Firebase config. [${e === null || e === void 0 ? void 0 : e.message}]`);\r\n            return { appId, measurementId };\r\n        }\r\n        throw e;\r\n    }\r\n    try {\r\n        const response = await fetchDynamicConfig(appFields);\r\n        // Note the SDK only clears throttle state if response is success or non-retriable.\r\n        retryData.deleteThrottleMetadata(appId);\r\n        return response;\r\n    }\r\n    catch (e) {\r\n        const error = e;\r\n        if (!isRetriableError(error)) {\r\n            retryData.deleteThrottleMetadata(appId);\r\n            if (measurementId) {\r\n                logger.warn(`Failed to fetch this Firebase app's measurement ID from the server.` +\r\n                    ` Falling back to the measurement ID ${measurementId}` +\r\n                    ` provided in the \"measurementId\" field in the local Firebase config. [${error === null || error === void 0 ? void 0 : error.message}]`);\r\n                return { appId, measurementId };\r\n            }\r\n            else {\r\n                throw e;\r\n            }\r\n        }\r\n        const backoffMillis = Number((_a = error === null || error === void 0 ? void 0 : error.customData) === null || _a === void 0 ? void 0 : _a.httpStatus) === 503\r\n            ? calculateBackoffMillis(backoffCount, retryData.intervalMillis, LONG_RETRY_FACTOR)\r\n            : calculateBackoffMillis(backoffCount, retryData.intervalMillis);\r\n        // Increments backoff state.\r\n        const throttleMetadata = {\r\n            throttleEndTimeMillis: Date.now() + backoffMillis,\r\n            backoffCount: backoffCount + 1\r\n        };\r\n        // Persists state.\r\n        retryData.setThrottleMetadata(appId, throttleMetadata);\r\n        logger.debug(`Calling attemptFetch again in ${backoffMillis} millis`);\r\n        return attemptFetchDynamicConfigWithRetry(appFields, throttleMetadata, signal, retryData);\r\n    }\r\n}\r\n/**\r\n * Supports waiting on a backoff by:\r\n *\r\n * <ul>\r\n *   <li>Promisifying setTimeout, so we can set a timeout in our Promise chain</li>\r\n *   <li>Listening on a signal bus for abort events, just like the Fetch API</li>\r\n *   <li>Failing in the same way the Fetch API fails, so timing out a live request and a throttled\r\n *       request appear the same.</li>\r\n * </ul>\r\n *\r\n * <p>Visible for testing.\r\n */\r\nfunction setAbortableTimeout(signal, throttleEndTimeMillis) {\r\n    return new Promise((resolve, reject) => {\r\n        // Derives backoff from given end time, normalizing negative numbers to zero.\r\n        const backoffMillis = Math.max(throttleEndTimeMillis - Date.now(), 0);\r\n        const timeout = setTimeout(resolve, backoffMillis);\r\n        // Adds listener, rather than sets onabort, because signal is a shared object.\r\n        signal.addEventListener(() => {\r\n            clearTimeout(timeout);\r\n            // If the request completes before this timeout, the rejection has no effect.\r\n            reject(ERROR_FACTORY.create(\"fetch-throttle\" /* AnalyticsError.FETCH_THROTTLE */, {\r\n                throttleEndTimeMillis\r\n            }));\r\n        });\r\n    });\r\n}\r\n/**\r\n * Returns true if the {@link Error} indicates a fetch request may succeed later.\r\n */\r\nfunction isRetriableError(e) {\r\n    if (!(e instanceof FirebaseError) || !e.customData) {\r\n        return false;\r\n    }\r\n    // Uses string index defined by ErrorData, which FirebaseError implements.\r\n    const httpStatus = Number(e.customData['httpStatus']);\r\n    return (httpStatus === 429 ||\r\n        httpStatus === 500 ||\r\n        httpStatus === 503 ||\r\n        httpStatus === 504);\r\n}\r\n/**\r\n * Shims a minimal AbortSignal (copied from Remote Config).\r\n *\r\n * <p>AbortController's AbortSignal conveniently decouples fetch timeout logic from other aspects\r\n * of networking, such as retries. Firebase doesn't use AbortController enough to justify a\r\n * polyfill recommendation, like we do with the Fetch API, but this minimal shim can easily be\r\n * swapped out if/when we do.\r\n */\r\nclass AnalyticsAbortSignal {\r\n    constructor() {\r\n        this.listeners = [];\r\n    }\r\n    addEventListener(listener) {\r\n        this.listeners.push(listener);\r\n    }\r\n    abort() {\r\n        this.listeners.forEach(listener => listener());\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Event parameters to set on 'gtag' during initialization.\r\n */\r\nlet defaultEventParametersForInit;\r\n/**\r\n * Logs an analytics event through the Firebase SDK.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n * @param eventName Google Analytics event name, choose from standard list or use a custom string.\r\n * @param eventParams Analytics event parameters.\r\n */\r\nasync function logEvent$1(gtagFunction, initializationPromise, eventName, eventParams, options) {\r\n    if (options && options.global) {\r\n        gtagFunction(\"event\" /* GtagCommand.EVENT */, eventName, eventParams);\r\n        return;\r\n    }\r\n    else {\r\n        const measurementId = await initializationPromise;\r\n        const params = Object.assign(Object.assign({}, eventParams), { 'send_to': measurementId });\r\n        gtagFunction(\"event\" /* GtagCommand.EVENT */, eventName, params);\r\n    }\r\n}\r\n/**\r\n * Set screen_name parameter for this Google Analytics ID.\r\n *\r\n * @deprecated Use {@link logEvent} with `eventName` as 'screen_view' and add relevant `eventParams`.\r\n * See {@link https://firebase.google.com/docs/analytics/screenviews | Track Screenviews}.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n * @param screenName Screen name string to set.\r\n */\r\nasync function setCurrentScreen$1(gtagFunction, initializationPromise, screenName, options) {\r\n    if (options && options.global) {\r\n        gtagFunction(\"set\" /* GtagCommand.SET */, { 'screen_name': screenName });\r\n        return Promise.resolve();\r\n    }\r\n    else {\r\n        const measurementId = await initializationPromise;\r\n        gtagFunction(\"config\" /* GtagCommand.CONFIG */, measurementId, {\r\n            update: true,\r\n            'screen_name': screenName\r\n        });\r\n    }\r\n}\r\n/**\r\n * Set user_id parameter for this Google Analytics ID.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n * @param id User ID string to set\r\n */\r\nasync function setUserId$1(gtagFunction, initializationPromise, id, options) {\r\n    if (options && options.global) {\r\n        gtagFunction(\"set\" /* GtagCommand.SET */, { 'user_id': id });\r\n        return Promise.resolve();\r\n    }\r\n    else {\r\n        const measurementId = await initializationPromise;\r\n        gtagFunction(\"config\" /* GtagCommand.CONFIG */, measurementId, {\r\n            update: true,\r\n            'user_id': id\r\n        });\r\n    }\r\n}\r\n/**\r\n * Set all other user properties other than user_id and screen_name.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n * @param properties Map of user properties to set\r\n */\r\nasync function setUserProperties$1(gtagFunction, initializationPromise, properties, options) {\r\n    if (options && options.global) {\r\n        const flatProperties = {};\r\n        for (const key of Object.keys(properties)) {\r\n            // use dot notation for merge behavior in gtag.js\r\n            flatProperties[`user_properties.${key}`] = properties[key];\r\n        }\r\n        gtagFunction(\"set\" /* GtagCommand.SET */, flatProperties);\r\n        return Promise.resolve();\r\n    }\r\n    else {\r\n        const measurementId = await initializationPromise;\r\n        gtagFunction(\"config\" /* GtagCommand.CONFIG */, measurementId, {\r\n            update: true,\r\n            'user_properties': properties\r\n        });\r\n    }\r\n}\r\n/**\r\n * Retrieves a unique Google Analytics identifier for the web client.\r\n * See {@link https://developers.google.com/analytics/devguides/collection/ga4/reference/config#client_id | client_id}.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n */\r\nasync function internalGetGoogleAnalyticsClientId(gtagFunction, initializationPromise) {\r\n    const measurementId = await initializationPromise;\r\n    return new Promise((resolve, reject) => {\r\n        gtagFunction(\"get\" /* GtagCommand.GET */, measurementId, 'client_id', (clientId) => {\r\n            if (!clientId) {\r\n                reject(ERROR_FACTORY.create(\"no-client-id\" /* AnalyticsError.NO_CLIENT_ID */));\r\n            }\r\n            resolve(clientId);\r\n        });\r\n    });\r\n}\r\n/**\r\n * Set whether collection is enabled for this ID.\r\n *\r\n * @param enabled If true, collection is enabled for this ID.\r\n */\r\nasync function setAnalyticsCollectionEnabled$1(initializationPromise, enabled) {\r\n    const measurementId = await initializationPromise;\r\n    window[`ga-disable-${measurementId}`] = !enabled;\r\n}\r\n/**\r\n * Consent parameters to default to during 'gtag' initialization.\r\n */\r\nlet defaultConsentSettingsForInit;\r\n/**\r\n * Sets the variable {@link defaultConsentSettingsForInit} for use in the initialization of\r\n * analytics.\r\n *\r\n * @param consentSettings Maps the applicable end user consent state for gtag.js.\r\n */\r\nfunction _setConsentDefaultForInit(consentSettings) {\r\n    defaultConsentSettingsForInit = consentSettings;\r\n}\r\n/**\r\n * Sets the variable `defaultEventParametersForInit` for use in the initialization of\r\n * analytics.\r\n *\r\n * @param customParams Any custom params the user may pass to gtag.js.\r\n */\r\nfunction _setDefaultEventParametersForInit(customParams) {\r\n    defaultEventParametersForInit = customParams;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function validateIndexedDB() {\r\n    if (!isIndexedDBAvailable()) {\r\n        logger.warn(ERROR_FACTORY.create(\"indexeddb-unavailable\" /* AnalyticsError.INDEXEDDB_UNAVAILABLE */, {\r\n            errorInfo: 'IndexedDB is not available in this environment.'\r\n        }).message);\r\n        return false;\r\n    }\r\n    else {\r\n        try {\r\n            await validateIndexedDBOpenable();\r\n        }\r\n        catch (e) {\r\n            logger.warn(ERROR_FACTORY.create(\"indexeddb-unavailable\" /* AnalyticsError.INDEXEDDB_UNAVAILABLE */, {\r\n                errorInfo: e === null || e === void 0 ? void 0 : e.toString()\r\n            }).message);\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n/**\r\n * Initialize the analytics instance in gtag.js by calling config command with fid.\r\n *\r\n * NOTE: We combine analytics initialization and setting fid together because we want fid to be\r\n * part of the `page_view` event that's sent during the initialization\r\n * @param app Firebase app\r\n * @param gtagCore The gtag function that's not wrapped.\r\n * @param dynamicConfigPromisesList Array of all dynamic config promises.\r\n * @param measurementIdToAppId Maps measurementID to appID.\r\n * @param installations _FirebaseInstallationsInternal instance.\r\n *\r\n * @returns Measurement ID.\r\n */\r\nasync function _initializeAnalytics(app, dynamicConfigPromisesList, measurementIdToAppId, installations, gtagCore, dataLayerName, options) {\r\n    var _a;\r\n    const dynamicConfigPromise = fetchDynamicConfigWithRetry(app);\r\n    // Once fetched, map measurementIds to appId, for ease of lookup in wrapped gtag function.\r\n    dynamicConfigPromise\r\n        .then(config => {\r\n        measurementIdToAppId[config.measurementId] = config.appId;\r\n        if (app.options.measurementId &&\r\n            config.measurementId !== app.options.measurementId) {\r\n            logger.warn(`The measurement ID in the local Firebase config (${app.options.measurementId})` +\r\n                ` does not match the measurement ID fetched from the server (${config.measurementId}).` +\r\n                ` To ensure analytics events are always sent to the correct Analytics property,` +\r\n                ` update the` +\r\n                ` measurement ID field in the local config or remove it from the local config.`);\r\n        }\r\n    })\r\n        .catch(e => logger.error(e));\r\n    // Add to list to track state of all dynamic config promises.\r\n    dynamicConfigPromisesList.push(dynamicConfigPromise);\r\n    const fidPromise = validateIndexedDB().then(envIsValid => {\r\n        if (envIsValid) {\r\n            return installations.getId();\r\n        }\r\n        else {\r\n            return undefined;\r\n        }\r\n    });\r\n    const [dynamicConfig, fid] = await Promise.all([\r\n        dynamicConfigPromise,\r\n        fidPromise\r\n    ]);\r\n    // Detect if user has already put the gtag <script> tag on this page with the passed in\r\n    // data layer name.\r\n    if (!findGtagScriptOnPage(dataLayerName)) {\r\n        insertScriptTag(dataLayerName, dynamicConfig.measurementId);\r\n    }\r\n    // Detects if there are consent settings that need to be configured.\r\n    if (defaultConsentSettingsForInit) {\r\n        gtagCore(\"consent\" /* GtagCommand.CONSENT */, 'default', defaultConsentSettingsForInit);\r\n        _setConsentDefaultForInit(undefined);\r\n    }\r\n    // This command initializes gtag.js and only needs to be called once for the entire web app,\r\n    // but since it is idempotent, we can call it multiple times.\r\n    // We keep it together with other initialization logic for better code structure.\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    gtagCore('js', new Date());\r\n    // User config added first. We don't want users to accidentally overwrite\r\n    // base Firebase config properties.\r\n    const configProperties = (_a = options === null || options === void 0 ? void 0 : options.config) !== null && _a !== void 0 ? _a : {};\r\n    // guard against developers accidentally setting properties with prefix `firebase_`\r\n    configProperties[ORIGIN_KEY] = 'firebase';\r\n    configProperties.update = true;\r\n    if (fid != null) {\r\n        configProperties[GA_FID_KEY] = fid;\r\n    }\r\n    // It should be the first config command called on this GA-ID\r\n    // Initialize this GA-ID and set FID on it using the gtag config API.\r\n    // Note: This will trigger a page_view event unless 'send_page_view' is set to false in\r\n    // `configProperties`.\r\n    gtagCore(\"config\" /* GtagCommand.CONFIG */, dynamicConfig.measurementId, configProperties);\r\n    // Detects if there is data that will be set on every event logged from the SDK.\r\n    if (defaultEventParametersForInit) {\r\n        gtagCore(\"set\" /* GtagCommand.SET */, defaultEventParametersForInit);\r\n        _setDefaultEventParametersForInit(undefined);\r\n    }\r\n    return dynamicConfig.measurementId;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Analytics Service class.\r\n */\r\nclass AnalyticsService {\r\n    constructor(app) {\r\n        this.app = app;\r\n    }\r\n    _delete() {\r\n        delete initializationPromisesMap[this.app.options.appId];\r\n        return Promise.resolve();\r\n    }\r\n}\r\n/**\r\n * Maps appId to full initialization promise. Wrapped gtag calls must wait on\r\n * all or some of these, depending on the call's `send_to` param and the status\r\n * of the dynamic config fetches (see below).\r\n */\r\nlet initializationPromisesMap = {};\r\n/**\r\n * List of dynamic config fetch promises. In certain cases, wrapped gtag calls\r\n * wait on all these to be complete in order to determine if it can selectively\r\n * wait for only certain initialization (FID) promises or if it must wait for all.\r\n */\r\nlet dynamicConfigPromisesList = [];\r\n/**\r\n * Maps fetched measurementIds to appId. Populated when the app's dynamic config\r\n * fetch completes. If already populated, gtag config calls can use this to\r\n * selectively wait for only this app's initialization promise (FID) instead of all\r\n * initialization promises.\r\n */\r\nconst measurementIdToAppId = {};\r\n/**\r\n * Name for window global data layer array used by GA: defaults to 'dataLayer'.\r\n */\r\nlet dataLayerName = 'dataLayer';\r\n/**\r\n * Name for window global gtag function used by GA: defaults to 'gtag'.\r\n */\r\nlet gtagName = 'gtag';\r\n/**\r\n * Reproduction of standard gtag function or reference to existing\r\n * gtag function on window object.\r\n */\r\nlet gtagCoreFunction;\r\n/**\r\n * Wrapper around gtag function that ensures FID is sent with all\r\n * relevant event and config calls.\r\n */\r\nlet wrappedGtagFunction;\r\n/**\r\n * Flag to ensure page initialization steps (creation or wrapping of\r\n * dataLayer and gtag script) are only run once per page load.\r\n */\r\nlet globalInitDone = false;\r\n/**\r\n * Configures Firebase Analytics to use custom `gtag` or `dataLayer` names.\r\n * Intended to be used if `gtag.js` script has been installed on\r\n * this page independently of Firebase Analytics, and is using non-default\r\n * names for either the `gtag` function or for `dataLayer`.\r\n * Must be called before calling `getAnalytics()` or it won't\r\n * have any effect.\r\n *\r\n * @public\r\n *\r\n * @param options - Custom gtag and dataLayer names.\r\n */\r\nfunction settings(options) {\r\n    if (globalInitDone) {\r\n        throw ERROR_FACTORY.create(\"already-initialized\" /* AnalyticsError.ALREADY_INITIALIZED */);\r\n    }\r\n    if (options.dataLayerName) {\r\n        dataLayerName = options.dataLayerName;\r\n    }\r\n    if (options.gtagName) {\r\n        gtagName = options.gtagName;\r\n    }\r\n}\r\n/**\r\n * Returns true if no environment mismatch is found.\r\n * If environment mismatches are found, throws an INVALID_ANALYTICS_CONTEXT\r\n * error that also lists details for each mismatch found.\r\n */\r\nfunction warnOnBrowserContextMismatch() {\r\n    const mismatchedEnvMessages = [];\r\n    if (isBrowserExtension()) {\r\n        mismatchedEnvMessages.push('This is a browser extension environment.');\r\n    }\r\n    if (!areCookiesEnabled()) {\r\n        mismatchedEnvMessages.push('Cookies are not available.');\r\n    }\r\n    if (mismatchedEnvMessages.length > 0) {\r\n        const details = mismatchedEnvMessages\r\n            .map((message, index) => `(${index + 1}) ${message}`)\r\n            .join(' ');\r\n        const err = ERROR_FACTORY.create(\"invalid-analytics-context\" /* AnalyticsError.INVALID_ANALYTICS_CONTEXT */, {\r\n            errorInfo: details\r\n        });\r\n        logger.warn(err.message);\r\n    }\r\n}\r\n/**\r\n * Analytics instance factory.\r\n * @internal\r\n */\r\nfunction factory(app, installations, options) {\r\n    warnOnBrowserContextMismatch();\r\n    const appId = app.options.appId;\r\n    if (!appId) {\r\n        throw ERROR_FACTORY.create(\"no-app-id\" /* AnalyticsError.NO_APP_ID */);\r\n    }\r\n    if (!app.options.apiKey) {\r\n        if (app.options.measurementId) {\r\n            logger.warn(`The \"apiKey\" field is empty in the local Firebase config. This is needed to fetch the latest` +\r\n                ` measurement ID for this Firebase app. Falling back to the measurement ID ${app.options.measurementId}` +\r\n                ` provided in the \"measurementId\" field in the local Firebase config.`);\r\n        }\r\n        else {\r\n            throw ERROR_FACTORY.create(\"no-api-key\" /* AnalyticsError.NO_API_KEY */);\r\n        }\r\n    }\r\n    if (initializationPromisesMap[appId] != null) {\r\n        throw ERROR_FACTORY.create(\"already-exists\" /* AnalyticsError.ALREADY_EXISTS */, {\r\n            id: appId\r\n        });\r\n    }\r\n    if (!globalInitDone) {\r\n        // Steps here should only be done once per page: creation or wrapping\r\n        // of dataLayer and global gtag function.\r\n        getOrCreateDataLayer(dataLayerName);\r\n        const { wrappedGtag, gtagCore } = wrapOrCreateGtag(initializationPromisesMap, dynamicConfigPromisesList, measurementIdToAppId, dataLayerName, gtagName);\r\n        wrappedGtagFunction = wrappedGtag;\r\n        gtagCoreFunction = gtagCore;\r\n        globalInitDone = true;\r\n    }\r\n    // Async but non-blocking.\r\n    // This map reflects the completion state of all promises for each appId.\r\n    initializationPromisesMap[appId] = _initializeAnalytics(app, dynamicConfigPromisesList, measurementIdToAppId, installations, gtagCoreFunction, dataLayerName, options);\r\n    const analyticsInstance = new AnalyticsService(app);\r\n    return analyticsInstance;\r\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\n/**\r\n * Returns an {@link Analytics} instance for the given app.\r\n *\r\n * @public\r\n *\r\n * @param app - The {@link @firebase/app#FirebaseApp} to use.\r\n */\r\nfunction getAnalytics(app = getApp()) {\r\n    app = getModularInstance(app);\r\n    // Dependencies\r\n    const analyticsProvider = _getProvider(app, ANALYTICS_TYPE);\r\n    if (analyticsProvider.isInitialized()) {\r\n        return analyticsProvider.getImmediate();\r\n    }\r\n    return initializeAnalytics(app);\r\n}\r\n/**\r\n * Returns an {@link Analytics} instance for the given app.\r\n *\r\n * @public\r\n *\r\n * @param app - The {@link @firebase/app#FirebaseApp} to use.\r\n */\r\nfunction initializeAnalytics(app, options = {}) {\r\n    // Dependencies\r\n    const analyticsProvider = _getProvider(app, ANALYTICS_TYPE);\r\n    if (analyticsProvider.isInitialized()) {\r\n        const existingInstance = analyticsProvider.getImmediate();\r\n        if (deepEqual(options, analyticsProvider.getOptions())) {\r\n            return existingInstance;\r\n        }\r\n        else {\r\n            throw ERROR_FACTORY.create(\"already-initialized\" /* AnalyticsError.ALREADY_INITIALIZED */);\r\n        }\r\n    }\r\n    const analyticsInstance = analyticsProvider.initialize({ options });\r\n    return analyticsInstance;\r\n}\r\n/**\r\n * This is a public static method provided to users that wraps four different checks:\r\n *\r\n * 1. Check if it's not a browser extension environment.\r\n * 2. Check if cookies are enabled in current browser.\r\n * 3. Check if IndexedDB is supported by the browser environment.\r\n * 4. Check if the current browser context is valid for using `IndexedDB.open()`.\r\n *\r\n * @public\r\n *\r\n */\r\nasync function isSupported() {\r\n    if (isBrowserExtension()) {\r\n        return false;\r\n    }\r\n    if (!areCookiesEnabled()) {\r\n        return false;\r\n    }\r\n    if (!isIndexedDBAvailable()) {\r\n        return false;\r\n    }\r\n    try {\r\n        const isDBOpenable = await validateIndexedDBOpenable();\r\n        return isDBOpenable;\r\n    }\r\n    catch (error) {\r\n        return false;\r\n    }\r\n}\r\n/**\r\n * Use gtag `config` command to set `screen_name`.\r\n *\r\n * @public\r\n *\r\n * @deprecated Use {@link logEvent} with `eventName` as 'screen_view' and add relevant `eventParams`.\r\n * See {@link https://firebase.google.com/docs/analytics/screenviews | Track Screenviews}.\r\n *\r\n * @param analyticsInstance - The {@link Analytics} instance.\r\n * @param screenName - Screen name to set.\r\n */\r\nfunction setCurrentScreen(analyticsInstance, screenName, options) {\r\n    analyticsInstance = getModularInstance(analyticsInstance);\r\n    setCurrentScreen$1(wrappedGtagFunction, initializationPromisesMap[analyticsInstance.app.options.appId], screenName, options).catch(e => logger.error(e));\r\n}\r\n/**\r\n * Retrieves a unique Google Analytics identifier for the web client.\r\n * See {@link https://developers.google.com/analytics/devguides/collection/ga4/reference/config#client_id | client_id}.\r\n *\r\n * @public\r\n *\r\n * @param app - The {@link @firebase/app#FirebaseApp} to use.\r\n */\r\nasync function getGoogleAnalyticsClientId(analyticsInstance) {\r\n    analyticsInstance = getModularInstance(analyticsInstance);\r\n    return internalGetGoogleAnalyticsClientId(wrappedGtagFunction, initializationPromisesMap[analyticsInstance.app.options.appId]);\r\n}\r\n/**\r\n * Use gtag `config` command to set `user_id`.\r\n *\r\n * @public\r\n *\r\n * @param analyticsInstance - The {@link Analytics} instance.\r\n * @param id - User ID to set.\r\n */\r\nfunction setUserId(analyticsInstance, id, options) {\r\n    analyticsInstance = getModularInstance(analyticsInstance);\r\n    setUserId$1(wrappedGtagFunction, initializationPromisesMap[analyticsInstance.app.options.appId], id, options).catch(e => logger.error(e));\r\n}\r\n/**\r\n * Use gtag `config` command to set all params specified.\r\n *\r\n * @public\r\n */\r\nfunction setUserProperties(analyticsInstance, properties, options) {\r\n    analyticsInstance = getModularInstance(analyticsInstance);\r\n    setUserProperties$1(wrappedGtagFunction, initializationPromisesMap[analyticsInstance.app.options.appId], properties, options).catch(e => logger.error(e));\r\n}\r\n/**\r\n * Sets whether Google Analytics collection is enabled for this app on this device.\r\n * Sets global `window['ga-disable-analyticsId'] = true;`\r\n *\r\n * @public\r\n *\r\n * @param analyticsInstance - The {@link Analytics} instance.\r\n * @param enabled - If true, enables collection, if false, disables it.\r\n */\r\nfunction setAnalyticsCollectionEnabled(analyticsInstance, enabled) {\r\n    analyticsInstance = getModularInstance(analyticsInstance);\r\n    setAnalyticsCollectionEnabled$1(initializationPromisesMap[analyticsInstance.app.options.appId], enabled).catch(e => logger.error(e));\r\n}\r\n/**\r\n * Adds data that will be set on every event logged from the SDK, including automatic ones.\r\n * With gtag's \"set\" command, the values passed persist on the current page and are passed with\r\n * all subsequent events.\r\n * @public\r\n * @param customParams - Any custom params the user may pass to gtag.js.\r\n */\r\nfunction setDefaultEventParameters(customParams) {\r\n    // Check if reference to existing gtag function on window object exists\r\n    if (wrappedGtagFunction) {\r\n        wrappedGtagFunction(\"set\" /* GtagCommand.SET */, customParams);\r\n    }\r\n    else {\r\n        _setDefaultEventParametersForInit(customParams);\r\n    }\r\n}\r\n/**\r\n * Sends a Google Analytics event with given `eventParams`. This method\r\n * automatically associates this logged event with this Firebase web\r\n * app instance on this device.\r\n * List of official event parameters can be found in the gtag.js\r\n * reference documentation:\r\n * {@link https://developers.google.com/gtagjs/reference/ga4-events\r\n * | the GA4 reference documentation}.\r\n *\r\n * @public\r\n */\r\nfunction logEvent(analyticsInstance, eventName, eventParams, options) {\r\n    analyticsInstance = getModularInstance(analyticsInstance);\r\n    logEvent$1(wrappedGtagFunction, initializationPromisesMap[analyticsInstance.app.options.appId], eventName, eventParams, options).catch(e => logger.error(e));\r\n}\r\n/**\r\n * Sets the applicable end user consent state for this web app across all gtag references once\r\n * Firebase Analytics is initialized.\r\n *\r\n * Use the {@link ConsentSettings} to specify individual consent type values. By default consent\r\n * types are set to \"granted\".\r\n * @public\r\n * @param consentSettings - Maps the applicable end user consent state for gtag.js.\r\n */\r\nfunction setConsent(consentSettings) {\r\n    // Check if reference to existing gtag function on window object exists\r\n    if (wrappedGtagFunction) {\r\n        wrappedGtagFunction(\"consent\" /* GtagCommand.CONSENT */, 'update', consentSettings);\r\n    }\r\n    else {\r\n        _setConsentDefaultForInit(consentSettings);\r\n    }\r\n}\n\nconst name = \"@firebase/analytics\";\nconst version = \"0.10.8\";\n\n/**\r\n * The Firebase Analytics Web SDK.\r\n * This SDK does not work in a Node.js environment.\r\n *\r\n * @packageDocumentation\r\n */\r\nfunction registerAnalytics() {\r\n    _registerComponent(new Component(ANALYTICS_TYPE, (container, { options: analyticsOptions }) => {\r\n        // getImmediate for FirebaseApp will always succeed\r\n        const app = container.getProvider('app').getImmediate();\r\n        const installations = container\r\n            .getProvider('installations-internal')\r\n            .getImmediate();\r\n        return factory(app, installations, analyticsOptions);\r\n    }, \"PUBLIC\" /* ComponentType.PUBLIC */));\r\n    _registerComponent(new Component('analytics-internal', internalFactory, \"PRIVATE\" /* ComponentType.PRIVATE */));\r\n    registerVersion(name, version);\r\n    // BUILD_TARGET will be replaced by values like esm5, esm2017, cjs5, etc during the compilation\r\n    registerVersion(name, version, 'esm2017');\r\n    function internalFactory(container) {\r\n        try {\r\n            const analytics = container.getProvider(ANALYTICS_TYPE).getImmediate();\r\n            return {\r\n                logEvent: (eventName, eventParams, options) => logEvent(analytics, eventName, eventParams, options)\r\n            };\r\n        }\r\n        catch (e) {\r\n            throw ERROR_FACTORY.create(\"interop-component-reg-failed\" /* AnalyticsError.INTEROP_COMPONENT_REG_FAILED */, {\r\n                reason: e\r\n            });\r\n        }\r\n    }\r\n}\r\nregisterAnalytics();\n\nexport { getAnalytics, getGoogleAnalyticsClientId, initializeAnalytics, isSupported, logEvent, setAnalyticsCollectionEnabled, setConsent, setCurrentScreen, setDefaultEventParameters, setUserId, setUserProperties, settings };\n//# sourceMappingURL=index.esm2017.js.map\n","import { initializeApp, getApps, getApp } from 'firebase/app';\r\nimport { getAuth, setPersistence, browserLocalPersistence } from 'firebase/auth';\r\nimport { initializeFirestore, getFirestore, persistentLocalCache, persistentMultipleTabManager, Firestore } from 'firebase/firestore';\r\nimport { getStorage } from 'firebase/storage';\r\nimport { getAnalytics, isSupported } from 'firebase/analytics';\r\n\r\n// Validate and format Firebase configuration\r\nconst validateConfig = (config: any) => {\r\n  const requiredFields = [\r\n    'apiKey',\r\n    'authDomain',\r\n    'projectId',\r\n    'storageBucket',\r\n    'messagingSenderId',\r\n    'appId'\r\n  ];\r\n\r\n  for (const field of requiredFields) {\r\n    if (!config[field]) {\r\n      throw new Error(`Missing required Firebase config field: ${field}`);\r\n    }\r\n  }\r\n\r\n  // Ensure authDomain is properly formatted\r\n  if (!config.authDomain.includes('.')) {\r\n    throw new Error('Invalid authDomain format');\r\n  }\r\n\r\n  // Log the project ID for debugging\r\n  console.log('Firebase Project ID:', config.projectId);\r\n\r\n  return config;\r\n};\r\n\r\nconst firebaseConfig = validateConfig({\r\n  apiKey: \"AIzaSyCpDr8QI3d4_7xStw_5agh_nHGX8Agojas\",\r\n  authDomain: \"zero-waste-swap.firebaseapp.com\",\r\n  projectId: \"zero-waste-swap\",\r\n  storageBucket: \"zero-waste-swap.firebasestorage.app\",\r\n  messagingSenderId: \"32063996385\",\r\n  appId: \"1:32063996385:web:fcd62891f07e28826092a0\",\r\n  measurementId: \"G-KBDTETVZ1J\"\r\n});\r\n\r\n// Initialize Firebase only if it hasn't been initialized\r\nconst app = !getApps().length ? initializeApp(firebaseConfig) : getApp();\r\n\r\n// Initialize Auth with local persistence\r\nexport const auth = getAuth(app);\r\nsetPersistence(auth, browserLocalPersistence).catch((err) => {\r\n  console.error('Error setting auth persistence:', err);\r\n});\r\n\r\n// Initialize Firestore with enhanced settings for connection stability\r\nlet db: Firestore;\r\ntry {\r\n  db = initializeFirestore(app, {\r\n    localCache: persistentLocalCache({\r\n      tabManager: persistentMultipleTabManager()\r\n    }),\r\n    experimentalForceLongPolling: true, // Use long polling instead of WebSocket\r\n    ignoreUndefinedProperties: true, // Ignore undefined properties to prevent errors\r\n  });\r\n\r\n  // Enable multi-tab persistence\r\n  // enableMultiTabIndexedDbPersistence(db).catch((err) => {\r\n  //   if (err.code === 'failed-precondition') {\r\n  //     console.warn('Multiple tabs open, persistence can only be enabled in one tab at a time.');\r\n  //   } else if (err.code === 'unimplemented') {\r\n  //     console.warn('The current browser does not support persistence.');\r\n  //   } else {\r\n  //     console.error('Error enabling persistence:', err);\r\n  //   }\r\n  // });\r\n\r\n  // Test Firestore connection\r\n  console.log('Firestore initialized successfully');\r\n} catch (error) {\r\n  console.error('Error initializing Firestore:', error);\r\n  // If Firestore is already initialized, get the existing instance\r\n  db = getFirestore(app);\r\n}\r\n\r\nexport { db };\r\n\r\n// Initialize Storage\r\nexport const storage = getStorage(app);\r\n\r\n// Optional: Connect to emulators if needed\r\nif (import.meta.env.VITE_USE_FIREBASE_EMULATORS === 'true') {\r\n  const host = window.location.hostname;\r\n  if (host === 'localhost' || host === '127.0.0.1') {\r\n    console.log('Connecting to Firebase emulators...');\r\n    try {\r\n      // Connect to Firestore emulator\r\n      import('firebase/firestore').then(({ connectFirestoreEmulator }) => {\r\n        connectFirestoreEmulator(db, 'localhost', 8080);\r\n      });\r\n      \r\n      // Connect to Auth emulator\r\n      import('firebase/auth').then(({ connectAuthEmulator }) => {\r\n        connectAuthEmulator(auth, 'http://localhost:9099');\r\n      });\r\n      \r\n      // Connect to Storage emulator\r\n      import('firebase/storage').then(({ connectStorageEmulator }) => {\r\n        connectStorageEmulator(storage, 'localhost', 9199);\r\n      });\r\n    } catch (error) {\r\n      console.error('Error setting up emulator connections:', error);\r\n    }\r\n  }\r\n}\r\n\r\n// Initialize analytics conditionally\r\nexport const analytics = isSupported().then(yes => yes ? getAnalytics(app) : null); ","import { createContext, useState, useEffect, ReactNode, useContext } from 'react';\r\nimport {\r\n  User,\r\n  signInWithEmailAndPassword,\r\n  createUserWithEmailAndPassword,\r\n  signOut,\r\n  onAuthStateChanged,\r\n  updateProfile,\r\n  sendPasswordResetEmail,\r\n} from 'firebase/auth';\r\nimport { auth } from '../config/firebase';\r\n\r\ninterface AuthContextType {\r\n  user: User | null;\r\n  loading: boolean;\r\n  error: string | null;\r\n  token: string | null;\r\n  login: (email: string, password: string) => Promise<void>;\r\n  register: (email: string, password: string, name: string) => Promise<void>;\r\n  logout: () => Promise<void>;\r\n  clearError: () => void;\r\n  resetPassword: (email: string) => Promise<void>;\r\n}\r\n\r\nexport const AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport function AuthProvider({ children }: { children: ReactNode }) {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [token, setToken] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = onAuthStateChanged(auth, async (user) => {\r\n      setUser(user);\r\n      if (user) {\r\n        try {\r\n          const token = await user.getIdToken();\r\n          setToken(token);\r\n        } catch (err) {\r\n          console.error('Error getting token:', err);\r\n          setToken(null);\r\n        }\r\n      } else {\r\n        setToken(null);\r\n      }\r\n      setLoading(false);\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, []);\r\n\r\n  const login = async (email: string, password: string) => {\r\n    try {\r\n      setError(null);\r\n      const userCredential = await signInWithEmailAndPassword(auth, email, password);\r\n      const token = await userCredential.user.getIdToken();\r\n      setToken(token);\r\n    } catch (err: any) {\r\n      let errorMessage = 'Грешка при влизане. Моля, опитайте отново.';\r\n\r\n      switch (err.code) {\r\n        case 'auth/user-not-found':\r\n          errorMessage = 'Няма акаунт с този имейл';\r\n          break;\r\n        case 'auth/wrong-password':\r\n          errorMessage = 'Грешна парола';\r\n          break;\r\n        case 'auth/invalid-credential':\r\n          errorMessage = 'Грешен имейл или парола';\r\n          break;\r\n        case 'auth/invalid-email':\r\n          errorMessage = 'Невалиден имейл адрес';\r\n          break;\r\n        case 'auth/too-many-requests':\r\n          errorMessage = 'Твърде много неуспешни опити. Моля, опитайте по-късно';\r\n          break;\r\n        default:\r\n          errorMessage = err.message || errorMessage;\r\n      }\r\n\r\n      setError(errorMessage);\r\n      throw new Error(errorMessage);\r\n    }\r\n  };\r\n\r\n  const register = async (email: string, password: string, name: string) => {\r\n    try {\r\n      setError(null);\r\n      const userCredential = await createUserWithEmailAndPassword(auth, email, password);\r\n\r\n      // Update user profile with name\r\n      await updateProfile(userCredential.user, {\r\n        displayName: name\r\n      });\r\n\r\n      const token = await userCredential.user.getIdToken();\r\n      setToken(token);\r\n    } catch (err: any) {\r\n      let errorMessage = 'Грешка при регистрация. Моля, опитайте отново.';\r\n\r\n      switch (err.code) {\r\n        case 'auth/email-already-in-use':\r\n          errorMessage = 'Този имейл вече е регистриран';\r\n          break;\r\n        case 'auth/invalid-email':\r\n          errorMessage = 'Невалиден имейл адрес';\r\n          break;\r\n        case 'auth/operation-not-allowed':\r\n          errorMessage = 'Акаунти с имейл/парола не са разрешени';\r\n          break;\r\n        case 'auth/weak-password':\r\n          errorMessage = 'Паролата трябва да е поне 8 символа';\r\n          break;\r\n        default:\r\n          errorMessage = err.message || errorMessage;\r\n      }\r\n\r\n      setError(errorMessage);\r\n      throw new Error(errorMessage);\r\n    }\r\n  };\r\n\r\n  const logout = async () => {\r\n    try {\r\n      setError(null);\r\n      await signOut(auth);\r\n      setToken(null);\r\n    } catch (err: any) {\r\n      setError(err.message || 'Грешка при излизане');\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  const clearError = () => {\r\n    setError(null);\r\n  };\r\n\r\n  const resetPassword = async (email: string) => {\r\n    try {\r\n      setError(null);\r\n      await sendPasswordResetEmail(auth, email);\r\n    } catch (err: any) {\r\n      let errorMessage = 'Грешка при изпращане на имейл за възстановяване на паролата.';\r\n      \r\n      switch (err.code) {\r\n        case 'auth/invalid-email':\r\n          errorMessage = 'Невалиден имейл адрес';\r\n          break;\r\n        case 'auth/user-not-found':\r\n          errorMessage = 'Няма акаунт с този имейл';\r\n          break;\r\n        default:\r\n          errorMessage = err.message || errorMessage;\r\n      }\r\n\r\n      setError(errorMessage);\r\n      throw new Error(errorMessage);\r\n    }\r\n  };\r\n\r\n  const value = {\r\n    user,\r\n    loading,\r\n    error,\r\n    token,\r\n    login,\r\n    register,\r\n    logout,\r\n    clearError,\r\n    resetPassword,\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={value}>\r\n      {!loading && children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n}; ","const PACKET_TYPES = Object.create(null); // no Map = no polyfill\nPACKET_TYPES[\"open\"] = \"0\";\nPACKET_TYPES[\"close\"] = \"1\";\nPACKET_TYPES[\"ping\"] = \"2\";\nPACKET_TYPES[\"pong\"] = \"3\";\nPACKET_TYPES[\"message\"] = \"4\";\nPACKET_TYPES[\"upgrade\"] = \"5\";\nPACKET_TYPES[\"noop\"] = \"6\";\nconst PACKET_TYPES_REVERSE = Object.create(null);\nObject.keys(PACKET_TYPES).forEach((key) => {\n    PACKET_TYPES_REVERSE[PACKET_TYPES[key]] = key;\n});\nconst ERROR_PACKET = { type: \"error\", data: \"parser error\" };\nexport { PACKET_TYPES, PACKET_TYPES_REVERSE, ERROR_PACKET };\n","import { PACKET_TYPES } from \"./commons.js\";\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        Object.prototype.toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\n// ArrayBuffer.isView method is not defined in IE10\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj && obj.buffer instanceof ArrayBuffer;\n};\nconst encodePacket = ({ type, data }, supportsBinary, callback) => {\n    if (withNativeBlob && data instanceof Blob) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(data, callback);\n        }\n    }\n    else if (withNativeArrayBuffer &&\n        (data instanceof ArrayBuffer || isView(data))) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(new Blob([data]), callback);\n        }\n    }\n    // plain string\n    return callback(PACKET_TYPES[type] + (data || \"\"));\n};\nconst encodeBlobAsBase64 = (data, callback) => {\n    const fileReader = new FileReader();\n    fileReader.onload = function () {\n        const content = fileReader.result.split(\",\")[1];\n        callback(\"b\" + (content || \"\"));\n    };\n    return fileReader.readAsDataURL(data);\n};\nfunction toArray(data) {\n    if (data instanceof Uint8Array) {\n        return data;\n    }\n    else if (data instanceof ArrayBuffer) {\n        return new Uint8Array(data);\n    }\n    else {\n        return new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n    }\n}\nlet TEXT_ENCODER;\nexport function encodePacketToBinary(packet, callback) {\n    if (withNativeBlob && packet.data instanceof Blob) {\n        return packet.data.arrayBuffer().then(toArray).then(callback);\n    }\n    else if (withNativeArrayBuffer &&\n        (packet.data instanceof ArrayBuffer || isView(packet.data))) {\n        return callback(toArray(packet.data));\n    }\n    encodePacket(packet, false, (encoded) => {\n        if (!TEXT_ENCODER) {\n            TEXT_ENCODER = new TextEncoder();\n        }\n        callback(TEXT_ENCODER.encode(encoded));\n    });\n}\nexport { encodePacket };\n","// imported from https://github.com/socketio/base64-arraybuffer\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n// Use a lookup table to find the index.\nconst lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (let i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\nexport const encode = (arraybuffer) => {\n    let bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = '';\n    for (i = 0; i < len; i += 3) {\n        base64 += chars[bytes[i] >> 2];\n        base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n        base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n        base64 += chars[bytes[i + 2] & 63];\n    }\n    if (len % 3 === 2) {\n        base64 = base64.substring(0, base64.length - 1) + '=';\n    }\n    else if (len % 3 === 1) {\n        base64 = base64.substring(0, base64.length - 2) + '==';\n    }\n    return base64;\n};\nexport const decode = (base64) => {\n    let bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n    const arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n    return arraybuffer;\n};\n","import { ERROR_PACKET, PACKET_TYPES_REVERSE, } from \"./commons.js\";\nimport { decode } from \"./contrib/base64-arraybuffer.js\";\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nexport const decodePacket = (encodedPacket, binaryType) => {\n    if (typeof encodedPacket !== \"string\") {\n        return {\n            type: \"message\",\n            data: mapBinary(encodedPacket, binaryType),\n        };\n    }\n    const type = encodedPacket.charAt(0);\n    if (type === \"b\") {\n        return {\n            type: \"message\",\n            data: decodeBase64Packet(encodedPacket.substring(1), binaryType),\n        };\n    }\n    const packetType = PACKET_TYPES_REVERSE[type];\n    if (!packetType) {\n        return ERROR_PACKET;\n    }\n    return encodedPacket.length > 1\n        ? {\n            type: PACKET_TYPES_REVERSE[type],\n            data: encodedPacket.substring(1),\n        }\n        : {\n            type: PACKET_TYPES_REVERSE[type],\n        };\n};\nconst decodeBase64Packet = (data, binaryType) => {\n    if (withNativeArrayBuffer) {\n        const decoded = decode(data);\n        return mapBinary(decoded, binaryType);\n    }\n    else {\n        return { base64: true, data }; // fallback for old browsers\n    }\n};\nconst mapBinary = (data, binaryType) => {\n    switch (binaryType) {\n        case \"blob\":\n            if (data instanceof Blob) {\n                // from WebSocket + binaryType \"blob\"\n                return data;\n            }\n            else {\n                // from HTTP long-polling or WebTransport\n                return new Blob([data]);\n            }\n        case \"arraybuffer\":\n        default:\n            if (data instanceof ArrayBuffer) {\n                // from HTTP long-polling (base64) or WebSocket + binaryType \"arraybuffer\"\n                return data;\n            }\n            else {\n                // from WebTransport (Uint8Array)\n                return data.buffer;\n            }\n    }\n};\n","import { encodePacket, encodePacketToBinary } from \"./encodePacket.js\";\nimport { decodePacket } from \"./decodePacket.js\";\nimport { ERROR_PACKET, } from \"./commons.js\";\nconst SEPARATOR = String.fromCharCode(30); // see https://en.wikipedia.org/wiki/Delimiter#ASCII_delimited_text\nconst encodePayload = (packets, callback) => {\n    // some packets may be added to the array while encoding, so the initial length must be saved\n    const length = packets.length;\n    const encodedPackets = new Array(length);\n    let count = 0;\n    packets.forEach((packet, i) => {\n        // force base64 encoding for binary packets\n        encodePacket(packet, false, (encodedPacket) => {\n            encodedPackets[i] = encodedPacket;\n            if (++count === length) {\n                callback(encodedPackets.join(SEPARATOR));\n            }\n        });\n    });\n};\nconst decodePayload = (encodedPayload, binaryType) => {\n    const encodedPackets = encodedPayload.split(SEPARATOR);\n    const packets = [];\n    for (let i = 0; i < encodedPackets.length; i++) {\n        const decodedPacket = decodePacket(encodedPackets[i], binaryType);\n        packets.push(decodedPacket);\n        if (decodedPacket.type === \"error\") {\n            break;\n        }\n    }\n    return packets;\n};\nexport function createPacketEncoderStream() {\n    return new TransformStream({\n        transform(packet, controller) {\n            encodePacketToBinary(packet, (encodedPacket) => {\n                const payloadLength = encodedPacket.length;\n                let header;\n                // inspired by the WebSocket format: https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_servers#decoding_payload_length\n                if (payloadLength < 126) {\n                    header = new Uint8Array(1);\n                    new DataView(header.buffer).setUint8(0, payloadLength);\n                }\n                else if (payloadLength < 65536) {\n                    header = new Uint8Array(3);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 126);\n                    view.setUint16(1, payloadLength);\n                }\n                else {\n                    header = new Uint8Array(9);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 127);\n                    view.setBigUint64(1, BigInt(payloadLength));\n                }\n                // first bit indicates whether the payload is plain text (0) or binary (1)\n                if (packet.data && typeof packet.data !== \"string\") {\n                    header[0] |= 0x80;\n                }\n                controller.enqueue(header);\n                controller.enqueue(encodedPacket);\n            });\n        },\n    });\n}\nlet TEXT_DECODER;\nfunction totalLength(chunks) {\n    return chunks.reduce((acc, chunk) => acc + chunk.length, 0);\n}\nfunction concatChunks(chunks, size) {\n    if (chunks[0].length === size) {\n        return chunks.shift();\n    }\n    const buffer = new Uint8Array(size);\n    let j = 0;\n    for (let i = 0; i < size; i++) {\n        buffer[i] = chunks[0][j++];\n        if (j === chunks[0].length) {\n            chunks.shift();\n            j = 0;\n        }\n    }\n    if (chunks.length && j < chunks[0].length) {\n        chunks[0] = chunks[0].slice(j);\n    }\n    return buffer;\n}\nexport function createPacketDecoderStream(maxPayload, binaryType) {\n    if (!TEXT_DECODER) {\n        TEXT_DECODER = new TextDecoder();\n    }\n    const chunks = [];\n    let state = 0 /* State.READ_HEADER */;\n    let expectedLength = -1;\n    let isBinary = false;\n    return new TransformStream({\n        transform(chunk, controller) {\n            chunks.push(chunk);\n            while (true) {\n                if (state === 0 /* State.READ_HEADER */) {\n                    if (totalLength(chunks) < 1) {\n                        break;\n                    }\n                    const header = concatChunks(chunks, 1);\n                    isBinary = (header[0] & 0x80) === 0x80;\n                    expectedLength = header[0] & 0x7f;\n                    if (expectedLength < 126) {\n                        state = 3 /* State.READ_PAYLOAD */;\n                    }\n                    else if (expectedLength === 126) {\n                        state = 1 /* State.READ_EXTENDED_LENGTH_16 */;\n                    }\n                    else {\n                        state = 2 /* State.READ_EXTENDED_LENGTH_64 */;\n                    }\n                }\n                else if (state === 1 /* State.READ_EXTENDED_LENGTH_16 */) {\n                    if (totalLength(chunks) < 2) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 2);\n                    expectedLength = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length).getUint16(0);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else if (state === 2 /* State.READ_EXTENDED_LENGTH_64 */) {\n                    if (totalLength(chunks) < 8) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 8);\n                    const view = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length);\n                    const n = view.getUint32(0);\n                    if (n > Math.pow(2, 53 - 32) - 1) {\n                        // the maximum safe integer in JavaScript is 2^53 - 1\n                        controller.enqueue(ERROR_PACKET);\n                        break;\n                    }\n                    expectedLength = n * Math.pow(2, 32) + view.getUint32(4);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else {\n                    if (totalLength(chunks) < expectedLength) {\n                        break;\n                    }\n                    const data = concatChunks(chunks, expectedLength);\n                    controller.enqueue(decodePacket(isBinary ? data : TEXT_DECODER.decode(data), binaryType));\n                    state = 0 /* State.READ_HEADER */;\n                }\n                if (expectedLength === 0 || expectedLength > maxPayload) {\n                    controller.enqueue(ERROR_PACKET);\n                    break;\n                }\n            }\n        },\n    });\n}\nexport const protocol = 4;\nexport { encodePacket, encodePayload, decodePacket, decodePayload, };\n","/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nexport function Emitter(obj) {\n  if (obj) return mixin(obj);\n}\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  function on() {\n    this.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks['$' + event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks['$' + event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n\n  // Remove event specific arrays for event types that no\n  // one is subscribed for to avoid memory leak.\n  if (callbacks.length === 0) {\n    delete this._callbacks['$' + event];\n  }\n\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n\n  var args = new Array(arguments.length - 1)\n    , callbacks = this._callbacks['$' + event];\n\n  for (var i = 1; i < arguments.length; i++) {\n    args[i - 1] = arguments[i];\n  }\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n// alias used for reserved events (protected method)\nEmitter.prototype.emitReserved = Emitter.prototype.emit;\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks['$' + event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n","export const nextTick = (() => {\n    const isPromiseAvailable = typeof Promise === \"function\" && typeof Promise.resolve === \"function\";\n    if (isPromiseAvailable) {\n        return (cb) => Promise.resolve().then(cb);\n    }\n    else {\n        return (cb, setTimeoutFn) => setTimeoutFn(cb, 0);\n    }\n})();\nexport const globalThisShim = (() => {\n    if (typeof self !== \"undefined\") {\n        return self;\n    }\n    else if (typeof window !== \"undefined\") {\n        return window;\n    }\n    else {\n        return Function(\"return this\")();\n    }\n})();\nexport const defaultBinaryType = \"arraybuffer\";\nexport function createCookieJar() { }\n","import { globalThisShim as globalThis } from \"./globals.node.js\";\nexport function pick(obj, ...attr) {\n    return attr.reduce((acc, k) => {\n        if (obj.hasOwnProperty(k)) {\n            acc[k] = obj[k];\n        }\n        return acc;\n    }, {});\n}\n// Keep a reference to the real timeout functions so they can be used when overridden\nconst NATIVE_SET_TIMEOUT = globalThis.setTimeout;\nconst NATIVE_CLEAR_TIMEOUT = globalThis.clearTimeout;\nexport function installTimerFunctions(obj, opts) {\n    if (opts.useNativeTimers) {\n        obj.setTimeoutFn = NATIVE_SET_TIMEOUT.bind(globalThis);\n        obj.clearTimeoutFn = NATIVE_CLEAR_TIMEOUT.bind(globalThis);\n    }\n    else {\n        obj.setTimeoutFn = globalThis.setTimeout.bind(globalThis);\n        obj.clearTimeoutFn = globalThis.clearTimeout.bind(globalThis);\n    }\n}\n// base64 encoded buffers are about 33% bigger (https://en.wikipedia.org/wiki/Base64)\nconst BASE64_OVERHEAD = 1.33;\n// we could also have used `new Blob([obj]).size`, but it isn't supported in IE9\nexport function byteLength(obj) {\n    if (typeof obj === \"string\") {\n        return utf8Length(obj);\n    }\n    // arraybuffer or blob\n    return Math.ceil((obj.byteLength || obj.size) * BASE64_OVERHEAD);\n}\nfunction utf8Length(str) {\n    let c = 0, length = 0;\n    for (let i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length;\n}\n/**\n * Generates a random 8-characters string.\n */\nexport function randomString() {\n    return (Date.now().toString(36).substring(3) +\n        Math.random().toString(36).substring(2, 5));\n}\n","// imported from https://github.com/galkn/querystring\n/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\nexport function encode(obj) {\n    let str = '';\n    for (let i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            if (str.length)\n                str += '&';\n            str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n        }\n    }\n    return str;\n}\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\nexport function decode(qs) {\n    let qry = {};\n    let pairs = qs.split('&');\n    for (let i = 0, l = pairs.length; i < l; i++) {\n        let pair = pairs[i].split('=');\n        qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    }\n    return qry;\n}\n","import { decodePacket } from \"engine.io-parser\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions } from \"./util.js\";\nimport { encode } from \"./contrib/parseqs.js\";\nexport class TransportError extends Error {\n    constructor(reason, description, context) {\n        super(reason);\n        this.description = description;\n        this.context = context;\n        this.type = \"TransportError\";\n    }\n}\nexport class Transport extends Emitter {\n    /**\n     * Transport abstract constructor.\n     *\n     * @param {Object} opts - options\n     * @protected\n     */\n    constructor(opts) {\n        super();\n        this.writable = false;\n        installTimerFunctions(this, opts);\n        this.opts = opts;\n        this.query = opts.query;\n        this.socket = opts.socket;\n        this.supportsBinary = !opts.forceBase64;\n    }\n    /**\n     * Emits an error.\n     *\n     * @param {String} reason\n     * @param description\n     * @param context - the error context\n     * @return {Transport} for chaining\n     * @protected\n     */\n    onError(reason, description, context) {\n        super.emitReserved(\"error\", new TransportError(reason, description, context));\n        return this;\n    }\n    /**\n     * Opens the transport.\n     */\n    open() {\n        this.readyState = \"opening\";\n        this.doOpen();\n        return this;\n    }\n    /**\n     * Closes the transport.\n     */\n    close() {\n        if (this.readyState === \"opening\" || this.readyState === \"open\") {\n            this.doClose();\n            this.onClose();\n        }\n        return this;\n    }\n    /**\n     * Sends multiple packets.\n     *\n     * @param {Array} packets\n     */\n    send(packets) {\n        if (this.readyState === \"open\") {\n            this.write(packets);\n        }\n        else {\n            // this might happen if the transport was silently closed in the beforeunload event handler\n        }\n    }\n    /**\n     * Called upon open\n     *\n     * @protected\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        this.writable = true;\n        super.emitReserved(\"open\");\n    }\n    /**\n     * Called with data.\n     *\n     * @param {String} data\n     * @protected\n     */\n    onData(data) {\n        const packet = decodePacket(data, this.socket.binaryType);\n        this.onPacket(packet);\n    }\n    /**\n     * Called with a decoded packet.\n     *\n     * @protected\n     */\n    onPacket(packet) {\n        super.emitReserved(\"packet\", packet);\n    }\n    /**\n     * Called upon close.\n     *\n     * @protected\n     */\n    onClose(details) {\n        this.readyState = \"closed\";\n        super.emitReserved(\"close\", details);\n    }\n    /**\n     * Pauses the transport, in order not to lose packets during an upgrade.\n     *\n     * @param onPause\n     */\n    pause(onPause) { }\n    createUri(schema, query = {}) {\n        return (schema +\n            \"://\" +\n            this._hostname() +\n            this._port() +\n            this.opts.path +\n            this._query(query));\n    }\n    _hostname() {\n        const hostname = this.opts.hostname;\n        return hostname.indexOf(\":\") === -1 ? hostname : \"[\" + hostname + \"]\";\n    }\n    _port() {\n        if (this.opts.port &&\n            ((this.opts.secure && Number(this.opts.port !== 443)) ||\n                (!this.opts.secure && Number(this.opts.port) !== 80))) {\n            return \":\" + this.opts.port;\n        }\n        else {\n            return \"\";\n        }\n    }\n    _query(query) {\n        const encodedQuery = encode(query);\n        return encodedQuery.length ? \"?\" + encodedQuery : \"\";\n    }\n}\n","import { Transport } from \"../transport.js\";\nimport { randomString } from \"../util.js\";\nimport { encodePayload, decodePayload } from \"engine.io-parser\";\nexport class Polling extends Transport {\n    constructor() {\n        super(...arguments);\n        this._polling = false;\n    }\n    get name() {\n        return \"polling\";\n    }\n    /**\n     * Opens the socket (triggers polling). We write a PING message to determine\n     * when the transport is open.\n     *\n     * @protected\n     */\n    doOpen() {\n        this._poll();\n    }\n    /**\n     * Pauses polling.\n     *\n     * @param {Function} onPause - callback upon buffers are flushed and transport is paused\n     * @package\n     */\n    pause(onPause) {\n        this.readyState = \"pausing\";\n        const pause = () => {\n            this.readyState = \"paused\";\n            onPause();\n        };\n        if (this._polling || !this.writable) {\n            let total = 0;\n            if (this._polling) {\n                total++;\n                this.once(\"pollComplete\", function () {\n                    --total || pause();\n                });\n            }\n            if (!this.writable) {\n                total++;\n                this.once(\"drain\", function () {\n                    --total || pause();\n                });\n            }\n        }\n        else {\n            pause();\n        }\n    }\n    /**\n     * Starts polling cycle.\n     *\n     * @private\n     */\n    _poll() {\n        this._polling = true;\n        this.doPoll();\n        this.emitReserved(\"poll\");\n    }\n    /**\n     * Overloads onData to detect payloads.\n     *\n     * @protected\n     */\n    onData(data) {\n        const callback = (packet) => {\n            // if its the first message we consider the transport open\n            if (\"opening\" === this.readyState && packet.type === \"open\") {\n                this.onOpen();\n            }\n            // if its a close packet, we close the ongoing requests\n            if (\"close\" === packet.type) {\n                this.onClose({ description: \"transport closed by the server\" });\n                return false;\n            }\n            // otherwise bypass onData and handle the message\n            this.onPacket(packet);\n        };\n        // decode payload\n        decodePayload(data, this.socket.binaryType).forEach(callback);\n        // if an event did not trigger closing\n        if (\"closed\" !== this.readyState) {\n            // if we got data we're not polling\n            this._polling = false;\n            this.emitReserved(\"pollComplete\");\n            if (\"open\" === this.readyState) {\n                this._poll();\n            }\n            else {\n            }\n        }\n    }\n    /**\n     * For polling, send a close packet.\n     *\n     * @protected\n     */\n    doClose() {\n        const close = () => {\n            this.write([{ type: \"close\" }]);\n        };\n        if (\"open\" === this.readyState) {\n            close();\n        }\n        else {\n            // in case we're trying to close while\n            // handshaking is in progress (GH-164)\n            this.once(\"open\", close);\n        }\n    }\n    /**\n     * Writes a packets payload.\n     *\n     * @param {Array} packets - data packets\n     * @protected\n     */\n    write(packets) {\n        this.writable = false;\n        encodePayload(packets, (data) => {\n            this.doWrite(data, () => {\n                this.writable = true;\n                this.emitReserved(\"drain\");\n            });\n        });\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"https\" : \"http\";\n        const query = this.query || {};\n        // cache busting is forced\n        if (false !== this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = randomString();\n        }\n        if (!this.supportsBinary && !query.sid) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\n","// imported from https://github.com/component/has-cors\nlet value = false;\ntry {\n    value = typeof XMLHttpRequest !== 'undefined' &&\n        'withCredentials' in new XMLHttpRequest();\n}\ncatch (err) {\n    // if XMLHttp support is disabled in IE then it will throw\n    // when trying to create\n}\nexport const hasCORS = value;\n","import { Polling } from \"./polling.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions, pick } from \"../util.js\";\nimport { globalThisShim as globalThis } from \"../globals.node.js\";\nimport { hasCORS } from \"../contrib/has-cors.js\";\nfunction empty() { }\nexport class BaseXHR extends Polling {\n    /**\n     * XHR Polling constructor.\n     *\n     * @param {Object} opts\n     * @package\n     */\n    constructor(opts) {\n        super(opts);\n        if (typeof location !== \"undefined\") {\n            const isSSL = \"https:\" === location.protocol;\n            let port = location.port;\n            // some user agents have empty `location.port`\n            if (!port) {\n                port = isSSL ? \"443\" : \"80\";\n            }\n            this.xd =\n                (typeof location !== \"undefined\" &&\n                    opts.hostname !== location.hostname) ||\n                    port !== opts.port;\n        }\n    }\n    /**\n     * Sends data.\n     *\n     * @param {String} data to send.\n     * @param {Function} called upon flush.\n     * @private\n     */\n    doWrite(data, fn) {\n        const req = this.request({\n            method: \"POST\",\n            data: data,\n        });\n        req.on(\"success\", fn);\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr post error\", xhrStatus, context);\n        });\n    }\n    /**\n     * Starts a poll cycle.\n     *\n     * @private\n     */\n    doPoll() {\n        const req = this.request();\n        req.on(\"data\", this.onData.bind(this));\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr poll error\", xhrStatus, context);\n        });\n        this.pollXhr = req;\n    }\n}\nexport class Request extends Emitter {\n    /**\n     * Request constructor\n     *\n     * @param {Object} options\n     * @package\n     */\n    constructor(createRequest, uri, opts) {\n        super();\n        this.createRequest = createRequest;\n        installTimerFunctions(this, opts);\n        this._opts = opts;\n        this._method = opts.method || \"GET\";\n        this._uri = uri;\n        this._data = undefined !== opts.data ? opts.data : null;\n        this._create();\n    }\n    /**\n     * Creates the XHR object and sends the request.\n     *\n     * @private\n     */\n    _create() {\n        var _a;\n        const opts = pick(this._opts, \"agent\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"autoUnref\");\n        opts.xdomain = !!this._opts.xd;\n        const xhr = (this._xhr = this.createRequest(opts));\n        try {\n            xhr.open(this._method, this._uri, true);\n            try {\n                if (this._opts.extraHeaders) {\n                    // @ts-ignore\n                    xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n                    for (let i in this._opts.extraHeaders) {\n                        if (this._opts.extraHeaders.hasOwnProperty(i)) {\n                            xhr.setRequestHeader(i, this._opts.extraHeaders[i]);\n                        }\n                    }\n                }\n            }\n            catch (e) { }\n            if (\"POST\" === this._method) {\n                try {\n                    xhr.setRequestHeader(\"Content-type\", \"text/plain;charset=UTF-8\");\n                }\n                catch (e) { }\n            }\n            try {\n                xhr.setRequestHeader(\"Accept\", \"*/*\");\n            }\n            catch (e) { }\n            (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.addCookies(xhr);\n            // ie6 check\n            if (\"withCredentials\" in xhr) {\n                xhr.withCredentials = this._opts.withCredentials;\n            }\n            if (this._opts.requestTimeout) {\n                xhr.timeout = this._opts.requestTimeout;\n            }\n            xhr.onreadystatechange = () => {\n                var _a;\n                if (xhr.readyState === 3) {\n                    (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(\n                    // @ts-ignore\n                    xhr.getResponseHeader(\"set-cookie\"));\n                }\n                if (4 !== xhr.readyState)\n                    return;\n                if (200 === xhr.status || 1223 === xhr.status) {\n                    this._onLoad();\n                }\n                else {\n                    // make sure the `error` event handler that's user-set\n                    // does not throw in the same tick and gets caught here\n                    this.setTimeoutFn(() => {\n                        this._onError(typeof xhr.status === \"number\" ? xhr.status : 0);\n                    }, 0);\n                }\n            };\n            xhr.send(this._data);\n        }\n        catch (e) {\n            // Need to defer since .create() is called directly from the constructor\n            // and thus the 'error' event can only be only bound *after* this exception\n            // occurs.  Therefore, also, we cannot throw here at all.\n            this.setTimeoutFn(() => {\n                this._onError(e);\n            }, 0);\n            return;\n        }\n        if (typeof document !== \"undefined\") {\n            this._index = Request.requestsCount++;\n            Request.requests[this._index] = this;\n        }\n    }\n    /**\n     * Called upon error.\n     *\n     * @private\n     */\n    _onError(err) {\n        this.emitReserved(\"error\", err, this._xhr);\n        this._cleanup(true);\n    }\n    /**\n     * Cleans up house.\n     *\n     * @private\n     */\n    _cleanup(fromError) {\n        if (\"undefined\" === typeof this._xhr || null === this._xhr) {\n            return;\n        }\n        this._xhr.onreadystatechange = empty;\n        if (fromError) {\n            try {\n                this._xhr.abort();\n            }\n            catch (e) { }\n        }\n        if (typeof document !== \"undefined\") {\n            delete Request.requests[this._index];\n        }\n        this._xhr = null;\n    }\n    /**\n     * Called upon load.\n     *\n     * @private\n     */\n    _onLoad() {\n        const data = this._xhr.responseText;\n        if (data !== null) {\n            this.emitReserved(\"data\", data);\n            this.emitReserved(\"success\");\n            this._cleanup();\n        }\n    }\n    /**\n     * Aborts the request.\n     *\n     * @package\n     */\n    abort() {\n        this._cleanup();\n    }\n}\nRequest.requestsCount = 0;\nRequest.requests = {};\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\nif (typeof document !== \"undefined\") {\n    // @ts-ignore\n    if (typeof attachEvent === \"function\") {\n        // @ts-ignore\n        attachEvent(\"onunload\", unloadHandler);\n    }\n    else if (typeof addEventListener === \"function\") {\n        const terminationEvent = \"onpagehide\" in globalThis ? \"pagehide\" : \"unload\";\n        addEventListener(terminationEvent, unloadHandler, false);\n    }\n}\nfunction unloadHandler() {\n    for (let i in Request.requests) {\n        if (Request.requests.hasOwnProperty(i)) {\n            Request.requests[i].abort();\n        }\n    }\n}\nconst hasXHR2 = (function () {\n    const xhr = newRequest({\n        xdomain: false,\n    });\n    return xhr && xhr.responseType !== null;\n})();\n/**\n * HTTP long-polling based on the built-in `XMLHttpRequest` object.\n *\n * Usage: browser\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n */\nexport class XHR extends BaseXHR {\n    constructor(opts) {\n        super(opts);\n        const forceBase64 = opts && opts.forceBase64;\n        this.supportsBinary = hasXHR2 && !forceBase64;\n    }\n    request(opts = {}) {\n        Object.assign(opts, { xd: this.xd }, this.opts);\n        return new Request(newRequest, this.uri(), opts);\n    }\n}\nfunction newRequest(opts) {\n    const xdomain = opts.xdomain;\n    // XMLHttpRequest can be disabled on IE\n    try {\n        if (\"undefined\" !== typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n            return new XMLHttpRequest();\n        }\n    }\n    catch (e) { }\n    if (!xdomain) {\n        try {\n            return new globalThis[[\"Active\"].concat(\"Object\").join(\"X\")](\"Microsoft.XMLHTTP\");\n        }\n        catch (e) { }\n    }\n}\n","import { Transport } from \"../transport.js\";\nimport { pick, randomString } from \"../util.js\";\nimport { encodePacket } from \"engine.io-parser\";\nimport { globalThisShim as globalThis, nextTick } from \"../globals.node.js\";\n// detect ReactNative environment\nconst isReactNative = typeof navigator !== \"undefined\" &&\n    typeof navigator.product === \"string\" &&\n    navigator.product.toLowerCase() === \"reactnative\";\nexport class BaseWS extends Transport {\n    get name() {\n        return \"websocket\";\n    }\n    doOpen() {\n        const uri = this.uri();\n        const protocols = this.opts.protocols;\n        // React Native only supports the 'headers' option, and will print a warning if anything else is passed\n        const opts = isReactNative\n            ? {}\n            : pick(this.opts, \"agent\", \"perMessageDeflate\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"localAddress\", \"protocolVersion\", \"origin\", \"maxPayload\", \"family\", \"checkServerIdentity\");\n        if (this.opts.extraHeaders) {\n            opts.headers = this.opts.extraHeaders;\n        }\n        try {\n            this.ws = this.createSocket(uri, protocols, opts);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this.ws.binaryType = this.socket.binaryType;\n        this.addEventListeners();\n    }\n    /**\n     * Adds event listeners to the socket\n     *\n     * @private\n     */\n    addEventListeners() {\n        this.ws.onopen = () => {\n            if (this.opts.autoUnref) {\n                this.ws._socket.unref();\n            }\n            this.onOpen();\n        };\n        this.ws.onclose = (closeEvent) => this.onClose({\n            description: \"websocket connection closed\",\n            context: closeEvent,\n        });\n        this.ws.onmessage = (ev) => this.onData(ev.data);\n        this.ws.onerror = (e) => this.onError(\"websocket error\", e);\n    }\n    write(packets) {\n        this.writable = false;\n        // encodePacket efficient as it uses WS framing\n        // no need for encodePayload\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            encodePacket(packet, this.supportsBinary, (data) => {\n                // Sometimes the websocket has already been closed but the browser didn't\n                // have a chance of informing us about it yet, in that case send will\n                // throw an error\n                try {\n                    this.doWrite(packet, data);\n                }\n                catch (e) {\n                }\n                if (lastPacket) {\n                    // fake drain\n                    // defer to next tick to allow Socket to clear writeBuffer\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        if (typeof this.ws !== \"undefined\") {\n            this.ws.onerror = () => { };\n            this.ws.close();\n            this.ws = null;\n        }\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"wss\" : \"ws\";\n        const query = this.query || {};\n        // append timestamp to URI\n        if (this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = randomString();\n        }\n        // communicate binary support capabilities\n        if (!this.supportsBinary) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\nconst WebSocketCtor = globalThis.WebSocket || globalThis.MozWebSocket;\n/**\n * WebSocket transport based on the built-in `WebSocket` object.\n *\n * Usage: browser, Node.js (since v21), Deno, Bun\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket\n * @see https://caniuse.com/mdn-api_websocket\n * @see https://nodejs.org/api/globals.html#websocket\n */\nexport class WS extends BaseWS {\n    createSocket(uri, protocols, opts) {\n        return !isReactNative\n            ? protocols\n                ? new WebSocketCtor(uri, protocols)\n                : new WebSocketCtor(uri)\n            : new WebSocketCtor(uri, protocols, opts);\n    }\n    doWrite(_packet, data) {\n        this.ws.send(data);\n    }\n}\n","import { Transport } from \"../transport.js\";\nimport { nextTick } from \"../globals.node.js\";\nimport { createPacketDecoderStream, createPacketEncoderStream, } from \"engine.io-parser\";\n/**\n * WebTransport transport based on the built-in `WebTransport` object.\n *\n * Usage: browser, Node.js (with the `@fails-components/webtransport` package)\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebTransport\n * @see https://caniuse.com/webtransport\n */\nexport class WT extends Transport {\n    get name() {\n        return \"webtransport\";\n    }\n    doOpen() {\n        try {\n            // @ts-ignore\n            this._transport = new WebTransport(this.createUri(\"https\"), this.opts.transportOptions[this.name]);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this._transport.closed\n            .then(() => {\n            this.onClose();\n        })\n            .catch((err) => {\n            this.onError(\"webtransport error\", err);\n        });\n        // note: we could have used async/await, but that would require some additional polyfills\n        this._transport.ready.then(() => {\n            this._transport.createBidirectionalStream().then((stream) => {\n                const decoderStream = createPacketDecoderStream(Number.MAX_SAFE_INTEGER, this.socket.binaryType);\n                const reader = stream.readable.pipeThrough(decoderStream).getReader();\n                const encoderStream = createPacketEncoderStream();\n                encoderStream.readable.pipeTo(stream.writable);\n                this._writer = encoderStream.writable.getWriter();\n                const read = () => {\n                    reader\n                        .read()\n                        .then(({ done, value }) => {\n                        if (done) {\n                            return;\n                        }\n                        this.onPacket(value);\n                        read();\n                    })\n                        .catch((err) => {\n                    });\n                };\n                read();\n                const packet = { type: \"open\" };\n                if (this.query.sid) {\n                    packet.data = `{\"sid\":\"${this.query.sid}\"}`;\n                }\n                this._writer.write(packet).then(() => this.onOpen());\n            });\n        });\n    }\n    write(packets) {\n        this.writable = false;\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            this._writer.write(packet).then(() => {\n                if (lastPacket) {\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        var _a;\n        (_a = this._transport) === null || _a === void 0 ? void 0 : _a.close();\n    }\n}\n","import { XHR } from \"./polling-xhr.node.js\";\nimport { WS } from \"./websocket.node.js\";\nimport { WT } from \"./webtransport.js\";\nexport const transports = {\n    websocket: WS,\n    webtransport: WT,\n    polling: XHR,\n};\n","// imported from https://github.com/galkn/parseuri\n/**\n * Parses a URI\n *\n * Note: we could also have used the built-in URL object, but it isn't supported on all platforms.\n *\n * See:\n * - https://developer.mozilla.org/en-US/docs/Web/API/URL\n * - https://caniuse.com/url\n * - https://www.rfc-editor.org/rfc/rfc3986#appendix-B\n *\n * History of the parse() method:\n * - first commit: https://github.com/socketio/socket.io-client/commit/4ee1d5d94b3906a9c052b459f1a818b15f38f91c\n * - export into its own module: https://github.com/socketio/engine.io-client/commit/de2c561e4564efeb78f1bdb1ba39ef81b2822cb3\n * - reimport: https://github.com/socketio/engine.io-client/commit/df32277c3f6d622eec5ed09f493cae3f3391d242\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\nconst re = /^(?:(?![^:@\\/?#]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@\\/?#]*)(?::([^:@\\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\nconst parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\nexport function parse(str) {\n    if (str.length > 8000) {\n        throw \"URI too long\";\n    }\n    const src = str, b = str.indexOf('['), e = str.indexOf(']');\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n    let m = re.exec(str || ''), uri = {}, i = 14;\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n    uri.pathNames = pathNames(uri, uri['path']);\n    uri.queryKey = queryKey(uri, uri['query']);\n    return uri;\n}\nfunction pathNames(obj, path) {\n    const regx = /\\/{2,9}/g, names = path.replace(regx, \"/\").split(\"/\");\n    if (path.slice(0, 1) == '/' || path.length === 0) {\n        names.splice(0, 1);\n    }\n    if (path.slice(-1) == '/') {\n        names.splice(names.length - 1, 1);\n    }\n    return names;\n}\nfunction queryKey(uri, query) {\n    const data = {};\n    query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function ($0, $1, $2) {\n        if ($1) {\n            data[$1] = $2;\n        }\n    });\n    return data;\n}\n","import { transports as DEFAULT_TRANSPORTS } from \"./transports/index.js\";\nimport { installTimerFunctions, byteLength } from \"./util.js\";\nimport { decode } from \"./contrib/parseqs.js\";\nimport { parse } from \"./contrib/parseuri.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { protocol } from \"engine.io-parser\";\nimport { createCookieJar, defaultBinaryType, nextTick, } from \"./globals.node.js\";\nconst withEventListeners = typeof addEventListener === \"function\" &&\n    typeof removeEventListener === \"function\";\nconst OFFLINE_EVENT_LISTENERS = [];\nif (withEventListeners) {\n    // within a ServiceWorker, any event handler for the 'offline' event must be added on the initial evaluation of the\n    // script, so we create one single event listener here which will forward the event to the socket instances\n    addEventListener(\"offline\", () => {\n        OFFLINE_EVENT_LISTENERS.forEach((listener) => listener());\n    }, false);\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes without upgrade mechanism, which means that it will keep the first low-level transport that\n * successfully establishes the connection.\n *\n * In order to allow tree-shaking, there are no transports included, that's why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithoutUpgrade, WebSocket } from \"engine.io-client\";\n *\n * const socket = new SocketWithoutUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithUpgrade\n * @see Socket\n */\nexport class SocketWithoutUpgrade extends Emitter {\n    /**\n     * Socket constructor.\n     *\n     * @param {String|Object} uri - uri or options\n     * @param {Object} opts - options\n     */\n    constructor(uri, opts) {\n        super();\n        this.binaryType = defaultBinaryType;\n        this.writeBuffer = [];\n        this._prevBufferLen = 0;\n        this._pingInterval = -1;\n        this._pingTimeout = -1;\n        this._maxPayload = -1;\n        /**\n         * The expiration timestamp of the {@link _pingTimeoutTimer} object is tracked, in case the timer is throttled and the\n         * callback is not fired on time. This can happen for example when a laptop is suspended or when a phone is locked.\n         */\n        this._pingTimeoutTime = Infinity;\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = null;\n        }\n        if (uri) {\n            const parsedUri = parse(uri);\n            opts.hostname = parsedUri.host;\n            opts.secure =\n                parsedUri.protocol === \"https\" || parsedUri.protocol === \"wss\";\n            opts.port = parsedUri.port;\n            if (parsedUri.query)\n                opts.query = parsedUri.query;\n        }\n        else if (opts.host) {\n            opts.hostname = parse(opts.host).host;\n        }\n        installTimerFunctions(this, opts);\n        this.secure =\n            null != opts.secure\n                ? opts.secure\n                : typeof location !== \"undefined\" && \"https:\" === location.protocol;\n        if (opts.hostname && !opts.port) {\n            // if no port is specified manually, use the protocol default\n            opts.port = this.secure ? \"443\" : \"80\";\n        }\n        this.hostname =\n            opts.hostname ||\n                (typeof location !== \"undefined\" ? location.hostname : \"localhost\");\n        this.port =\n            opts.port ||\n                (typeof location !== \"undefined\" && location.port\n                    ? location.port\n                    : this.secure\n                        ? \"443\"\n                        : \"80\");\n        this.transports = [];\n        this._transportsByName = {};\n        opts.transports.forEach((t) => {\n            const transportName = t.prototype.name;\n            this.transports.push(transportName);\n            this._transportsByName[transportName] = t;\n        });\n        this.opts = Object.assign({\n            path: \"/engine.io\",\n            agent: false,\n            withCredentials: false,\n            upgrade: true,\n            timestampParam: \"t\",\n            rememberUpgrade: false,\n            addTrailingSlash: true,\n            rejectUnauthorized: true,\n            perMessageDeflate: {\n                threshold: 1024,\n            },\n            transportOptions: {},\n            closeOnBeforeunload: false,\n        }, opts);\n        this.opts.path =\n            this.opts.path.replace(/\\/$/, \"\") +\n                (this.opts.addTrailingSlash ? \"/\" : \"\");\n        if (typeof this.opts.query === \"string\") {\n            this.opts.query = decode(this.opts.query);\n        }\n        if (withEventListeners) {\n            if (this.opts.closeOnBeforeunload) {\n                // Firefox closes the connection when the \"beforeunload\" event is emitted but not Chrome. This event listener\n                // ensures every browser behaves the same (no \"disconnect\" event at the Socket.IO level when the page is\n                // closed/reloaded)\n                this._beforeunloadEventListener = () => {\n                    if (this.transport) {\n                        // silently close the transport\n                        this.transport.removeAllListeners();\n                        this.transport.close();\n                    }\n                };\n                addEventListener(\"beforeunload\", this._beforeunloadEventListener, false);\n            }\n            if (this.hostname !== \"localhost\") {\n                this._offlineEventListener = () => {\n                    this._onClose(\"transport close\", {\n                        description: \"network connection lost\",\n                    });\n                };\n                OFFLINE_EVENT_LISTENERS.push(this._offlineEventListener);\n            }\n        }\n        if (this.opts.withCredentials) {\n            this._cookieJar = createCookieJar();\n        }\n        this._open();\n    }\n    /**\n     * Creates transport of the given type.\n     *\n     * @param {String} name - transport name\n     * @return {Transport}\n     * @private\n     */\n    createTransport(name) {\n        const query = Object.assign({}, this.opts.query);\n        // append engine.io protocol identifier\n        query.EIO = protocol;\n        // transport name\n        query.transport = name;\n        // session id if we already have one\n        if (this.id)\n            query.sid = this.id;\n        const opts = Object.assign({}, this.opts, {\n            query,\n            socket: this,\n            hostname: this.hostname,\n            secure: this.secure,\n            port: this.port,\n        }, this.opts.transportOptions[name]);\n        return new this._transportsByName[name](opts);\n    }\n    /**\n     * Initializes transport to use and starts probe.\n     *\n     * @private\n     */\n    _open() {\n        if (this.transports.length === 0) {\n            // Emit error on next tick so it can be listened to\n            this.setTimeoutFn(() => {\n                this.emitReserved(\"error\", \"No transports available\");\n            }, 0);\n            return;\n        }\n        const transportName = this.opts.rememberUpgrade &&\n            SocketWithoutUpgrade.priorWebsocketSuccess &&\n            this.transports.indexOf(\"websocket\") !== -1\n            ? \"websocket\"\n            : this.transports[0];\n        this.readyState = \"opening\";\n        const transport = this.createTransport(transportName);\n        transport.open();\n        this.setTransport(transport);\n    }\n    /**\n     * Sets the current transport. Disables the existing one (if any).\n     *\n     * @private\n     */\n    setTransport(transport) {\n        if (this.transport) {\n            this.transport.removeAllListeners();\n        }\n        // set up transport\n        this.transport = transport;\n        // set up transport listeners\n        transport\n            .on(\"drain\", this._onDrain.bind(this))\n            .on(\"packet\", this._onPacket.bind(this))\n            .on(\"error\", this._onError.bind(this))\n            .on(\"close\", (reason) => this._onClose(\"transport close\", reason));\n    }\n    /**\n     * Called when connection is deemed open.\n     *\n     * @private\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        SocketWithoutUpgrade.priorWebsocketSuccess =\n            \"websocket\" === this.transport.name;\n        this.emitReserved(\"open\");\n        this.flush();\n    }\n    /**\n     * Handles a packet.\n     *\n     * @private\n     */\n    _onPacket(packet) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            this.emitReserved(\"packet\", packet);\n            // Socket is live - any packet counts\n            this.emitReserved(\"heartbeat\");\n            switch (packet.type) {\n                case \"open\":\n                    this.onHandshake(JSON.parse(packet.data));\n                    break;\n                case \"ping\":\n                    this._sendPacket(\"pong\");\n                    this.emitReserved(\"ping\");\n                    this.emitReserved(\"pong\");\n                    this._resetPingTimeout();\n                    break;\n                case \"error\":\n                    const err = new Error(\"server error\");\n                    // @ts-ignore\n                    err.code = packet.data;\n                    this._onError(err);\n                    break;\n                case \"message\":\n                    this.emitReserved(\"data\", packet.data);\n                    this.emitReserved(\"message\", packet.data);\n                    break;\n            }\n        }\n        else {\n        }\n    }\n    /**\n     * Called upon handshake completion.\n     *\n     * @param {Object} data - handshake obj\n     * @private\n     */\n    onHandshake(data) {\n        this.emitReserved(\"handshake\", data);\n        this.id = data.sid;\n        this.transport.query.sid = data.sid;\n        this._pingInterval = data.pingInterval;\n        this._pingTimeout = data.pingTimeout;\n        this._maxPayload = data.maxPayload;\n        this.onOpen();\n        // In case open handler closes socket\n        if (\"closed\" === this.readyState)\n            return;\n        this._resetPingTimeout();\n    }\n    /**\n     * Sets and resets ping timeout timer based on server pings.\n     *\n     * @private\n     */\n    _resetPingTimeout() {\n        this.clearTimeoutFn(this._pingTimeoutTimer);\n        const delay = this._pingInterval + this._pingTimeout;\n        this._pingTimeoutTime = Date.now() + delay;\n        this._pingTimeoutTimer = this.setTimeoutFn(() => {\n            this._onClose(\"ping timeout\");\n        }, delay);\n        if (this.opts.autoUnref) {\n            this._pingTimeoutTimer.unref();\n        }\n    }\n    /**\n     * Called on `drain` event\n     *\n     * @private\n     */\n    _onDrain() {\n        this.writeBuffer.splice(0, this._prevBufferLen);\n        // setting prevBufferLen = 0 is very important\n        // for example, when upgrading, upgrade packet is sent over,\n        // and a nonzero prevBufferLen could cause problems on `drain`\n        this._prevBufferLen = 0;\n        if (0 === this.writeBuffer.length) {\n            this.emitReserved(\"drain\");\n        }\n        else {\n            this.flush();\n        }\n    }\n    /**\n     * Flush write buffers.\n     *\n     * @private\n     */\n    flush() {\n        if (\"closed\" !== this.readyState &&\n            this.transport.writable &&\n            !this.upgrading &&\n            this.writeBuffer.length) {\n            const packets = this._getWritablePackets();\n            this.transport.send(packets);\n            // keep track of current length of writeBuffer\n            // splice writeBuffer and callbackBuffer on `drain`\n            this._prevBufferLen = packets.length;\n            this.emitReserved(\"flush\");\n        }\n    }\n    /**\n     * Ensure the encoded size of the writeBuffer is below the maxPayload value sent by the server (only for HTTP\n     * long-polling)\n     *\n     * @private\n     */\n    _getWritablePackets() {\n        const shouldCheckPayloadSize = this._maxPayload &&\n            this.transport.name === \"polling\" &&\n            this.writeBuffer.length > 1;\n        if (!shouldCheckPayloadSize) {\n            return this.writeBuffer;\n        }\n        let payloadSize = 1; // first packet type\n        for (let i = 0; i < this.writeBuffer.length; i++) {\n            const data = this.writeBuffer[i].data;\n            if (data) {\n                payloadSize += byteLength(data);\n            }\n            if (i > 0 && payloadSize > this._maxPayload) {\n                return this.writeBuffer.slice(0, i);\n            }\n            payloadSize += 2; // separator + packet type\n        }\n        return this.writeBuffer;\n    }\n    /**\n     * Checks whether the heartbeat timer has expired but the socket has not yet been notified.\n     *\n     * Note: this method is private for now because it does not really fit the WebSocket API, but if we put it in the\n     * `write()` method then the message would not be buffered by the Socket.IO client.\n     *\n     * @return {boolean}\n     * @private\n     */\n    /* private */ _hasPingExpired() {\n        if (!this._pingTimeoutTime)\n            return true;\n        const hasExpired = Date.now() > this._pingTimeoutTime;\n        if (hasExpired) {\n            this._pingTimeoutTime = 0;\n            nextTick(() => {\n                this._onClose(\"ping timeout\");\n            }, this.setTimeoutFn);\n        }\n        return hasExpired;\n    }\n    /**\n     * Sends a message.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    write(msg, options, fn) {\n        this._sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a message. Alias of {@link Socket#write}.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    send(msg, options, fn) {\n        this._sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param {String} type: packet type.\n     * @param {String} data.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @private\n     */\n    _sendPacket(type, data, options, fn) {\n        if (\"function\" === typeof data) {\n            fn = data;\n            data = undefined;\n        }\n        if (\"function\" === typeof options) {\n            fn = options;\n            options = null;\n        }\n        if (\"closing\" === this.readyState || \"closed\" === this.readyState) {\n            return;\n        }\n        options = options || {};\n        options.compress = false !== options.compress;\n        const packet = {\n            type: type,\n            data: data,\n            options: options,\n        };\n        this.emitReserved(\"packetCreate\", packet);\n        this.writeBuffer.push(packet);\n        if (fn)\n            this.once(\"flush\", fn);\n        this.flush();\n    }\n    /**\n     * Closes the connection.\n     */\n    close() {\n        const close = () => {\n            this._onClose(\"forced close\");\n            this.transport.close();\n        };\n        const cleanupAndClose = () => {\n            this.off(\"upgrade\", cleanupAndClose);\n            this.off(\"upgradeError\", cleanupAndClose);\n            close();\n        };\n        const waitForUpgrade = () => {\n            // wait for upgrade to finish since we can't send packets while pausing a transport\n            this.once(\"upgrade\", cleanupAndClose);\n            this.once(\"upgradeError\", cleanupAndClose);\n        };\n        if (\"opening\" === this.readyState || \"open\" === this.readyState) {\n            this.readyState = \"closing\";\n            if (this.writeBuffer.length) {\n                this.once(\"drain\", () => {\n                    if (this.upgrading) {\n                        waitForUpgrade();\n                    }\n                    else {\n                        close();\n                    }\n                });\n            }\n            else if (this.upgrading) {\n                waitForUpgrade();\n            }\n            else {\n                close();\n            }\n        }\n        return this;\n    }\n    /**\n     * Called upon transport error\n     *\n     * @private\n     */\n    _onError(err) {\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        if (this.opts.tryAllTransports &&\n            this.transports.length > 1 &&\n            this.readyState === \"opening\") {\n            this.transports.shift();\n            return this._open();\n        }\n        this.emitReserved(\"error\", err);\n        this._onClose(\"transport error\", err);\n    }\n    /**\n     * Called upon transport close.\n     *\n     * @private\n     */\n    _onClose(reason, description) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            // clear timers\n            this.clearTimeoutFn(this._pingTimeoutTimer);\n            // stop event from firing again for transport\n            this.transport.removeAllListeners(\"close\");\n            // ensure transport won't stay open\n            this.transport.close();\n            // ignore further transport communication\n            this.transport.removeAllListeners();\n            if (withEventListeners) {\n                if (this._beforeunloadEventListener) {\n                    removeEventListener(\"beforeunload\", this._beforeunloadEventListener, false);\n                }\n                if (this._offlineEventListener) {\n                    const i = OFFLINE_EVENT_LISTENERS.indexOf(this._offlineEventListener);\n                    if (i !== -1) {\n                        OFFLINE_EVENT_LISTENERS.splice(i, 1);\n                    }\n                }\n            }\n            // set ready state\n            this.readyState = \"closed\";\n            // clear session id\n            this.id = null;\n            // emit close event\n            this.emitReserved(\"close\", reason, description);\n            // clean buffers after, so users can still\n            // grab the buffers on `close` event\n            this.writeBuffer = [];\n            this._prevBufferLen = 0;\n        }\n    }\n}\nSocketWithoutUpgrade.protocol = protocol;\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * In order to allow tree-shaking, there are no transports included, that's why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithUpgrade, WebSocket } from \"engine.io-client\";\n *\n * const socket = new SocketWithUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see Socket\n */\nexport class SocketWithUpgrade extends SocketWithoutUpgrade {\n    constructor() {\n        super(...arguments);\n        this._upgrades = [];\n    }\n    onOpen() {\n        super.onOpen();\n        if (\"open\" === this.readyState && this.opts.upgrade) {\n            for (let i = 0; i < this._upgrades.length; i++) {\n                this._probe(this._upgrades[i]);\n            }\n        }\n    }\n    /**\n     * Probes a transport.\n     *\n     * @param {String} name - transport name\n     * @private\n     */\n    _probe(name) {\n        let transport = this.createTransport(name);\n        let failed = false;\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        const onTransportOpen = () => {\n            if (failed)\n                return;\n            transport.send([{ type: \"ping\", data: \"probe\" }]);\n            transport.once(\"packet\", (msg) => {\n                if (failed)\n                    return;\n                if (\"pong\" === msg.type && \"probe\" === msg.data) {\n                    this.upgrading = true;\n                    this.emitReserved(\"upgrading\", transport);\n                    if (!transport)\n                        return;\n                    SocketWithoutUpgrade.priorWebsocketSuccess =\n                        \"websocket\" === transport.name;\n                    this.transport.pause(() => {\n                        if (failed)\n                            return;\n                        if (\"closed\" === this.readyState)\n                            return;\n                        cleanup();\n                        this.setTransport(transport);\n                        transport.send([{ type: \"upgrade\" }]);\n                        this.emitReserved(\"upgrade\", transport);\n                        transport = null;\n                        this.upgrading = false;\n                        this.flush();\n                    });\n                }\n                else {\n                    const err = new Error(\"probe error\");\n                    // @ts-ignore\n                    err.transport = transport.name;\n                    this.emitReserved(\"upgradeError\", err);\n                }\n            });\n        };\n        function freezeTransport() {\n            if (failed)\n                return;\n            // Any callback called by transport should be ignored since now\n            failed = true;\n            cleanup();\n            transport.close();\n            transport = null;\n        }\n        // Handle any error that happens while probing\n        const onerror = (err) => {\n            const error = new Error(\"probe error: \" + err);\n            // @ts-ignore\n            error.transport = transport.name;\n            freezeTransport();\n            this.emitReserved(\"upgradeError\", error);\n        };\n        function onTransportClose() {\n            onerror(\"transport closed\");\n        }\n        // When the socket is closed while we're probing\n        function onclose() {\n            onerror(\"socket closed\");\n        }\n        // When the socket is upgraded while we're probing\n        function onupgrade(to) {\n            if (transport && to.name !== transport.name) {\n                freezeTransport();\n            }\n        }\n        // Remove all listeners on the transport and on self\n        const cleanup = () => {\n            transport.removeListener(\"open\", onTransportOpen);\n            transport.removeListener(\"error\", onerror);\n            transport.removeListener(\"close\", onTransportClose);\n            this.off(\"close\", onclose);\n            this.off(\"upgrading\", onupgrade);\n        };\n        transport.once(\"open\", onTransportOpen);\n        transport.once(\"error\", onerror);\n        transport.once(\"close\", onTransportClose);\n        this.once(\"close\", onclose);\n        this.once(\"upgrading\", onupgrade);\n        if (this._upgrades.indexOf(\"webtransport\") !== -1 &&\n            name !== \"webtransport\") {\n            // favor WebTransport\n            this.setTimeoutFn(() => {\n                if (!failed) {\n                    transport.open();\n                }\n            }, 200);\n        }\n        else {\n            transport.open();\n        }\n    }\n    onHandshake(data) {\n        this._upgrades = this._filterUpgrades(data.upgrades);\n        super.onHandshake(data);\n    }\n    /**\n     * Filters upgrades, returning only those matching client transports.\n     *\n     * @param {Array} upgrades - server upgrades\n     * @private\n     */\n    _filterUpgrades(upgrades) {\n        const filteredUpgrades = [];\n        for (let i = 0; i < upgrades.length; i++) {\n            if (~this.transports.indexOf(upgrades[i]))\n                filteredUpgrades.push(upgrades[i]);\n        }\n        return filteredUpgrades;\n    }\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * @example\n * import { Socket } from \"engine.io-client\";\n *\n * const socket = new Socket();\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see SocketWithUpgrade\n */\nexport class Socket extends SocketWithUpgrade {\n    constructor(uri, opts = {}) {\n        const o = typeof uri === \"object\" ? uri : opts;\n        if (!o.transports ||\n            (o.transports && typeof o.transports[0] === \"string\")) {\n            o.transports = (o.transports || [\"polling\", \"websocket\", \"webtransport\"])\n                .map((transportName) => DEFAULT_TRANSPORTS[transportName])\n                .filter((t) => !!t);\n        }\n        super(uri, o);\n    }\n}\n","import { parse } from \"engine.io-client\";\n/**\n * URL parser.\n *\n * @param uri - url\n * @param path - the request path of the connection\n * @param loc - An object meant to mimic window.location.\n *        Defaults to window.location.\n * @public\n */\nexport function url(uri, path = \"\", loc) {\n    let obj = uri;\n    // default to window.location\n    loc = loc || (typeof location !== \"undefined\" && location);\n    if (null == uri)\n        uri = loc.protocol + \"//\" + loc.host;\n    // relative path support\n    if (typeof uri === \"string\") {\n        if (\"/\" === uri.charAt(0)) {\n            if (\"/\" === uri.charAt(1)) {\n                uri = loc.protocol + uri;\n            }\n            else {\n                uri = loc.host + uri;\n            }\n        }\n        if (!/^(https?|wss?):\\/\\//.test(uri)) {\n            if (\"undefined\" !== typeof loc) {\n                uri = loc.protocol + \"//\" + uri;\n            }\n            else {\n                uri = \"https://\" + uri;\n            }\n        }\n        // parse\n        obj = parse(uri);\n    }\n    // make sure we treat `localhost:80` and `localhost` equally\n    if (!obj.port) {\n        if (/^(http|ws)$/.test(obj.protocol)) {\n            obj.port = \"80\";\n        }\n        else if (/^(http|ws)s$/.test(obj.protocol)) {\n            obj.port = \"443\";\n        }\n    }\n    obj.path = obj.path || \"/\";\n    const ipv6 = obj.host.indexOf(\":\") !== -1;\n    const host = ipv6 ? \"[\" + obj.host + \"]\" : obj.host;\n    // define unique id\n    obj.id = obj.protocol + \"://\" + host + \":\" + obj.port + path;\n    // define href\n    obj.href =\n        obj.protocol +\n            \"://\" +\n            host +\n            (loc && loc.port === obj.port ? \"\" : \":\" + obj.port);\n    return obj;\n}\n","const withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj.buffer instanceof ArrayBuffer;\n};\nconst toString = Object.prototype.toString;\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeFile = typeof File === \"function\" ||\n    (typeof File !== \"undefined\" &&\n        toString.call(File) === \"[object FileConstructor]\");\n/**\n * Returns true if obj is a Buffer, an ArrayBuffer, a Blob or a File.\n *\n * @private\n */\nexport function isBinary(obj) {\n    return ((withNativeArrayBuffer && (obj instanceof ArrayBuffer || isView(obj))) ||\n        (withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File));\n}\nexport function hasBinary(obj, toJSON) {\n    if (!obj || typeof obj !== \"object\") {\n        return false;\n    }\n    if (Array.isArray(obj)) {\n        for (let i = 0, l = obj.length; i < l; i++) {\n            if (hasBinary(obj[i])) {\n                return true;\n            }\n        }\n        return false;\n    }\n    if (isBinary(obj)) {\n        return true;\n    }\n    if (obj.toJSON &&\n        typeof obj.toJSON === \"function\" &&\n        arguments.length === 1) {\n        return hasBinary(obj.toJSON(), true);\n    }\n    for (const key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n            return true;\n        }\n    }\n    return false;\n}\n","import { isBinary } from \"./is-binary.js\";\n/**\n * Replaces every Buffer | ArrayBuffer | Blob | File in packet with a numbered placeholder.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @public\n */\nexport function deconstructPacket(packet) {\n    const buffers = [];\n    const packetData = packet.data;\n    const pack = packet;\n    pack.data = _deconstructPacket(packetData, buffers);\n    pack.attachments = buffers.length; // number of binary 'attachments'\n    return { packet: pack, buffers: buffers };\n}\nfunction _deconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (isBinary(data)) {\n        const placeholder = { _placeholder: true, num: buffers.length };\n        buffers.push(data);\n        return placeholder;\n    }\n    else if (Array.isArray(data)) {\n        const newData = new Array(data.length);\n        for (let i = 0; i < data.length; i++) {\n            newData[i] = _deconstructPacket(data[i], buffers);\n        }\n        return newData;\n    }\n    else if (typeof data === \"object\" && !(data instanceof Date)) {\n        const newData = {};\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                newData[key] = _deconstructPacket(data[key], buffers);\n            }\n        }\n        return newData;\n    }\n    return data;\n}\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @public\n */\nexport function reconstructPacket(packet, buffers) {\n    packet.data = _reconstructPacket(packet.data, buffers);\n    delete packet.attachments; // no longer useful\n    return packet;\n}\nfunction _reconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (data && data._placeholder === true) {\n        const isIndexValid = typeof data.num === \"number\" &&\n            data.num >= 0 &&\n            data.num < buffers.length;\n        if (isIndexValid) {\n            return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n        }\n        else {\n            throw new Error(\"illegal attachments\");\n        }\n    }\n    else if (Array.isArray(data)) {\n        for (let i = 0; i < data.length; i++) {\n            data[i] = _reconstructPacket(data[i], buffers);\n        }\n    }\n    else if (typeof data === \"object\") {\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                data[key] = _reconstructPacket(data[key], buffers);\n            }\n        }\n    }\n    return data;\n}\n","import { Emitter } from \"@socket.io/component-emitter\";\nimport { deconstructPacket, reconstructPacket } from \"./binary.js\";\nimport { isBinary, hasBinary } from \"./is-binary.js\";\n/**\n * These strings must not be used as event names, as they have a special meaning.\n */\nconst RESERVED_EVENTS = [\n    \"connect\",\n    \"connect_error\",\n    \"disconnect\",\n    \"disconnecting\",\n    \"newListener\",\n    \"removeListener\", // used by the Node.js EventEmitter\n];\n/**\n * Protocol version.\n *\n * @public\n */\nexport const protocol = 5;\nexport var PacketType;\n(function (PacketType) {\n    PacketType[PacketType[\"CONNECT\"] = 0] = \"CONNECT\";\n    PacketType[PacketType[\"DISCONNECT\"] = 1] = \"DISCONNECT\";\n    PacketType[PacketType[\"EVENT\"] = 2] = \"EVENT\";\n    PacketType[PacketType[\"ACK\"] = 3] = \"ACK\";\n    PacketType[PacketType[\"CONNECT_ERROR\"] = 4] = \"CONNECT_ERROR\";\n    PacketType[PacketType[\"BINARY_EVENT\"] = 5] = \"BINARY_EVENT\";\n    PacketType[PacketType[\"BINARY_ACK\"] = 6] = \"BINARY_ACK\";\n})(PacketType || (PacketType = {}));\n/**\n * A socket.io Encoder instance\n */\nexport class Encoder {\n    /**\n     * Encoder constructor\n     *\n     * @param {function} replacer - custom replacer to pass down to JSON.parse\n     */\n    constructor(replacer) {\n        this.replacer = replacer;\n    }\n    /**\n     * Encode a packet as a single string if non-binary, or as a\n     * buffer sequence, depending on packet type.\n     *\n     * @param {Object} obj - packet object\n     */\n    encode(obj) {\n        if (obj.type === PacketType.EVENT || obj.type === PacketType.ACK) {\n            if (hasBinary(obj)) {\n                return this.encodeAsBinary({\n                    type: obj.type === PacketType.EVENT\n                        ? PacketType.BINARY_EVENT\n                        : PacketType.BINARY_ACK,\n                    nsp: obj.nsp,\n                    data: obj.data,\n                    id: obj.id,\n                });\n            }\n        }\n        return [this.encodeAsString(obj)];\n    }\n    /**\n     * Encode packet as string.\n     */\n    encodeAsString(obj) {\n        // first is type\n        let str = \"\" + obj.type;\n        // attachments if we have them\n        if (obj.type === PacketType.BINARY_EVENT ||\n            obj.type === PacketType.BINARY_ACK) {\n            str += obj.attachments + \"-\";\n        }\n        // if we have a namespace other than `/`\n        // we append it followed by a comma `,`\n        if (obj.nsp && \"/\" !== obj.nsp) {\n            str += obj.nsp + \",\";\n        }\n        // immediately followed by the id\n        if (null != obj.id) {\n            str += obj.id;\n        }\n        // json data\n        if (null != obj.data) {\n            str += JSON.stringify(obj.data, this.replacer);\n        }\n        return str;\n    }\n    /**\n     * Encode packet as 'buffer sequence' by removing blobs, and\n     * deconstructing packet into object with placeholders and\n     * a list of buffers.\n     */\n    encodeAsBinary(obj) {\n        const deconstruction = deconstructPacket(obj);\n        const pack = this.encodeAsString(deconstruction.packet);\n        const buffers = deconstruction.buffers;\n        buffers.unshift(pack); // add packet info to beginning of data list\n        return buffers; // write all the buffers\n    }\n}\n// see https://stackoverflow.com/questions/8511281/check-if-a-value-is-an-object-in-javascript\nfunction isObject(value) {\n    return Object.prototype.toString.call(value) === \"[object Object]\";\n}\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n */\nexport class Decoder extends Emitter {\n    /**\n     * Decoder constructor\n     *\n     * @param {function} reviver - custom reviver to pass down to JSON.stringify\n     */\n    constructor(reviver) {\n        super();\n        this.reviver = reviver;\n    }\n    /**\n     * Decodes an encoded packet string into packet JSON.\n     *\n     * @param {String} obj - encoded packet\n     */\n    add(obj) {\n        let packet;\n        if (typeof obj === \"string\") {\n            if (this.reconstructor) {\n                throw new Error(\"got plaintext data when reconstructing a packet\");\n            }\n            packet = this.decodeString(obj);\n            const isBinaryEvent = packet.type === PacketType.BINARY_EVENT;\n            if (isBinaryEvent || packet.type === PacketType.BINARY_ACK) {\n                packet.type = isBinaryEvent ? PacketType.EVENT : PacketType.ACK;\n                // binary packet's json\n                this.reconstructor = new BinaryReconstructor(packet);\n                // no attachments, labeled binary but no binary data to follow\n                if (packet.attachments === 0) {\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n            else {\n                // non-binary full packet\n                super.emitReserved(\"decoded\", packet);\n            }\n        }\n        else if (isBinary(obj) || obj.base64) {\n            // raw binary data\n            if (!this.reconstructor) {\n                throw new Error(\"got binary data when not reconstructing a packet\");\n            }\n            else {\n                packet = this.reconstructor.takeBinaryData(obj);\n                if (packet) {\n                    // received final buffer\n                    this.reconstructor = null;\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n        }\n        else {\n            throw new Error(\"Unknown type: \" + obj);\n        }\n    }\n    /**\n     * Decode a packet String (JSON data)\n     *\n     * @param {String} str\n     * @return {Object} packet\n     */\n    decodeString(str) {\n        let i = 0;\n        // look up type\n        const p = {\n            type: Number(str.charAt(0)),\n        };\n        if (PacketType[p.type] === undefined) {\n            throw new Error(\"unknown packet type \" + p.type);\n        }\n        // look up attachments if type binary\n        if (p.type === PacketType.BINARY_EVENT ||\n            p.type === PacketType.BINARY_ACK) {\n            const start = i + 1;\n            while (str.charAt(++i) !== \"-\" && i != str.length) { }\n            const buf = str.substring(start, i);\n            if (buf != Number(buf) || str.charAt(i) !== \"-\") {\n                throw new Error(\"Illegal attachments\");\n            }\n            p.attachments = Number(buf);\n        }\n        // look up namespace (if any)\n        if (\"/\" === str.charAt(i + 1)) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (\",\" === c)\n                    break;\n                if (i === str.length)\n                    break;\n            }\n            p.nsp = str.substring(start, i);\n        }\n        else {\n            p.nsp = \"/\";\n        }\n        // look up id\n        const next = str.charAt(i + 1);\n        if (\"\" !== next && Number(next) == next) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (null == c || Number(c) != c) {\n                    --i;\n                    break;\n                }\n                if (i === str.length)\n                    break;\n            }\n            p.id = Number(str.substring(start, i + 1));\n        }\n        // look up json data\n        if (str.charAt(++i)) {\n            const payload = this.tryParse(str.substr(i));\n            if (Decoder.isPayloadValid(p.type, payload)) {\n                p.data = payload;\n            }\n            else {\n                throw new Error(\"invalid payload\");\n            }\n        }\n        return p;\n    }\n    tryParse(str) {\n        try {\n            return JSON.parse(str, this.reviver);\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    static isPayloadValid(type, payload) {\n        switch (type) {\n            case PacketType.CONNECT:\n                return isObject(payload);\n            case PacketType.DISCONNECT:\n                return payload === undefined;\n            case PacketType.CONNECT_ERROR:\n                return typeof payload === \"string\" || isObject(payload);\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                return (Array.isArray(payload) &&\n                    (typeof payload[0] === \"number\" ||\n                        (typeof payload[0] === \"string\" &&\n                            RESERVED_EVENTS.indexOf(payload[0]) === -1)));\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                return Array.isArray(payload);\n        }\n    }\n    /**\n     * Deallocates a parser's resources\n     */\n    destroy() {\n        if (this.reconstructor) {\n            this.reconstructor.finishedReconstruction();\n            this.reconstructor = null;\n        }\n    }\n}\n/**\n * A manager of a binary event's 'buffer sequence'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n */\nclass BinaryReconstructor {\n    constructor(packet) {\n        this.packet = packet;\n        this.buffers = [];\n        this.reconPack = packet;\n    }\n    /**\n     * Method to be called when binary data received from connection\n     * after a BINARY_EVENT packet.\n     *\n     * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n     * @return {null | Object} returns null if more binary data is expected or\n     *   a reconstructed packet object if all buffers have been received.\n     */\n    takeBinaryData(binData) {\n        this.buffers.push(binData);\n        if (this.buffers.length === this.reconPack.attachments) {\n            // done with buffer list\n            const packet = reconstructPacket(this.reconPack, this.buffers);\n            this.finishedReconstruction();\n            return packet;\n        }\n        return null;\n    }\n    /**\n     * Cleans up binary packet reconstruction variables.\n     */\n    finishedReconstruction() {\n        this.reconPack = null;\n        this.buffers = [];\n    }\n}\n","export function on(obj, ev, fn) {\n    obj.on(ev, fn);\n    return function subDestroy() {\n        obj.off(ev, fn);\n    };\n}\n","import { PacketType } from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\n/**\n * Internal events.\n * These events can't be emitted by the user.\n */\nconst RESERVED_EVENTS = Object.freeze({\n    connect: 1,\n    connect_error: 1,\n    disconnect: 1,\n    disconnecting: 1,\n    // EventEmitter reserved events: https://nodejs.org/api/events.html#events_event_newlistener\n    newListener: 1,\n    removeListener: 1,\n});\n/**\n * A Socket is the fundamental class for interacting with the server.\n *\n * A Socket belongs to a certain Namespace (by default /) and uses an underlying {@link Manager} to communicate.\n *\n * @example\n * const socket = io();\n *\n * socket.on(\"connect\", () => {\n *   console.log(\"connected\");\n * });\n *\n * // send an event to the server\n * socket.emit(\"foo\", \"bar\");\n *\n * socket.on(\"foobar\", () => {\n *   // an event was received from the server\n * });\n *\n * // upon disconnection\n * socket.on(\"disconnect\", (reason) => {\n *   console.log(`disconnected due to ${reason}`);\n * });\n */\nexport class Socket extends Emitter {\n    /**\n     * `Socket` constructor.\n     */\n    constructor(io, nsp, opts) {\n        super();\n        /**\n         * Whether the socket is currently connected to the server.\n         *\n         * @example\n         * const socket = io();\n         *\n         * socket.on(\"connect\", () => {\n         *   console.log(socket.connected); // true\n         * });\n         *\n         * socket.on(\"disconnect\", () => {\n         *   console.log(socket.connected); // false\n         * });\n         */\n        this.connected = false;\n        /**\n         * Whether the connection state was recovered after a temporary disconnection. In that case, any missed packets will\n         * be transmitted by the server.\n         */\n        this.recovered = false;\n        /**\n         * Buffer for packets received before the CONNECT packet\n         */\n        this.receiveBuffer = [];\n        /**\n         * Buffer for packets that will be sent once the socket is connected\n         */\n        this.sendBuffer = [];\n        /**\n         * The queue of packets to be sent with retry in case of failure.\n         *\n         * Packets are sent one by one, each waiting for the server acknowledgement, in order to guarantee the delivery order.\n         * @private\n         */\n        this._queue = [];\n        /**\n         * A sequence to generate the ID of the {@link QueuedPacket}.\n         * @private\n         */\n        this._queueSeq = 0;\n        this.ids = 0;\n        /**\n         * A map containing acknowledgement handlers.\n         *\n         * The `withError` attribute is used to differentiate handlers that accept an error as first argument:\n         *\n         * - `socket.emit(\"test\", (err, value) => { ... })` with `ackTimeout` option\n         * - `socket.timeout(5000).emit(\"test\", (err, value) => { ... })`\n         * - `const value = await socket.emitWithAck(\"test\")`\n         *\n         * From those that don't:\n         *\n         * - `socket.emit(\"test\", (value) => { ... });`\n         *\n         * In the first case, the handlers will be called with an error when:\n         *\n         * - the timeout is reached\n         * - the socket gets disconnected\n         *\n         * In the second case, the handlers will be simply discarded upon disconnection, since the client will never receive\n         * an acknowledgement from the server.\n         *\n         * @private\n         */\n        this.acks = {};\n        this.flags = {};\n        this.io = io;\n        this.nsp = nsp;\n        if (opts && opts.auth) {\n            this.auth = opts.auth;\n        }\n        this._opts = Object.assign({}, opts);\n        if (this.io._autoConnect)\n            this.open();\n    }\n    /**\n     * Whether the socket is currently disconnected\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"connect\", () => {\n     *   console.log(socket.disconnected); // false\n     * });\n     *\n     * socket.on(\"disconnect\", () => {\n     *   console.log(socket.disconnected); // true\n     * });\n     */\n    get disconnected() {\n        return !this.connected;\n    }\n    /**\n     * Subscribe to open, close and packet events\n     *\n     * @private\n     */\n    subEvents() {\n        if (this.subs)\n            return;\n        const io = this.io;\n        this.subs = [\n            on(io, \"open\", this.onopen.bind(this)),\n            on(io, \"packet\", this.onpacket.bind(this)),\n            on(io, \"error\", this.onerror.bind(this)),\n            on(io, \"close\", this.onclose.bind(this)),\n        ];\n    }\n    /**\n     * Whether the Socket will try to reconnect when its Manager connects or reconnects.\n     *\n     * @example\n     * const socket = io();\n     *\n     * console.log(socket.active); // true\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   if (reason === \"io server disconnect\") {\n     *     // the disconnection was initiated by the server, you need to manually reconnect\n     *     console.log(socket.active); // false\n     *   }\n     *   // else the socket will automatically try to reconnect\n     *   console.log(socket.active); // true\n     * });\n     */\n    get active() {\n        return !!this.subs;\n    }\n    /**\n     * \"Opens\" the socket.\n     *\n     * @example\n     * const socket = io({\n     *   autoConnect: false\n     * });\n     *\n     * socket.connect();\n     */\n    connect() {\n        if (this.connected)\n            return this;\n        this.subEvents();\n        if (!this.io[\"_reconnecting\"])\n            this.io.open(); // ensure open\n        if (\"open\" === this.io._readyState)\n            this.onopen();\n        return this;\n    }\n    /**\n     * Alias for {@link connect()}.\n     */\n    open() {\n        return this.connect();\n    }\n    /**\n     * Sends a `message` event.\n     *\n     * This method mimics the WebSocket.send() method.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/send\n     *\n     * @example\n     * socket.send(\"hello\");\n     *\n     * // this is equivalent to\n     * socket.emit(\"message\", \"hello\");\n     *\n     * @return self\n     */\n    send(...args) {\n        args.unshift(\"message\");\n        this.emit.apply(this, args);\n        return this;\n    }\n    /**\n     * Override `emit`.\n     * If the event is in `events`, it's emitted normally.\n     *\n     * @example\n     * socket.emit(\"hello\", \"world\");\n     *\n     * // all serializable datastructures are supported (no need to call JSON.stringify)\n     * socket.emit(\"hello\", 1, \"2\", { 3: [\"4\"], 5: Uint8Array.from([6]) });\n     *\n     * // with an acknowledgement from the server\n     * socket.emit(\"hello\", \"world\", (val) => {\n     *   // ...\n     * });\n     *\n     * @return self\n     */\n    emit(ev, ...args) {\n        var _a, _b, _c;\n        if (RESERVED_EVENTS.hasOwnProperty(ev)) {\n            throw new Error('\"' + ev.toString() + '\" is a reserved event name');\n        }\n        args.unshift(ev);\n        if (this._opts.retries && !this.flags.fromQueue && !this.flags.volatile) {\n            this._addToQueue(args);\n            return this;\n        }\n        const packet = {\n            type: PacketType.EVENT,\n            data: args,\n        };\n        packet.options = {};\n        packet.options.compress = this.flags.compress !== false;\n        // event ack callback\n        if (\"function\" === typeof args[args.length - 1]) {\n            const id = this.ids++;\n            const ack = args.pop();\n            this._registerAckCallback(id, ack);\n            packet.id = id;\n        }\n        const isTransportWritable = (_b = (_a = this.io.engine) === null || _a === void 0 ? void 0 : _a.transport) === null || _b === void 0 ? void 0 : _b.writable;\n        const isConnected = this.connected && !((_c = this.io.engine) === null || _c === void 0 ? void 0 : _c._hasPingExpired());\n        const discardPacket = this.flags.volatile && !isTransportWritable;\n        if (discardPacket) {\n        }\n        else if (isConnected) {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        }\n        else {\n            this.sendBuffer.push(packet);\n        }\n        this.flags = {};\n        return this;\n    }\n    /**\n     * @private\n     */\n    _registerAckCallback(id, ack) {\n        var _a;\n        const timeout = (_a = this.flags.timeout) !== null && _a !== void 0 ? _a : this._opts.ackTimeout;\n        if (timeout === undefined) {\n            this.acks[id] = ack;\n            return;\n        }\n        // @ts-ignore\n        const timer = this.io.setTimeoutFn(() => {\n            delete this.acks[id];\n            for (let i = 0; i < this.sendBuffer.length; i++) {\n                if (this.sendBuffer[i].id === id) {\n                    this.sendBuffer.splice(i, 1);\n                }\n            }\n            ack.call(this, new Error(\"operation has timed out\"));\n        }, timeout);\n        const fn = (...args) => {\n            // @ts-ignore\n            this.io.clearTimeoutFn(timer);\n            ack.apply(this, args);\n        };\n        fn.withError = true;\n        this.acks[id] = fn;\n    }\n    /**\n     * Emits an event and waits for an acknowledgement\n     *\n     * @example\n     * // without timeout\n     * const response = await socket.emitWithAck(\"hello\", \"world\");\n     *\n     * // with a specific timeout\n     * try {\n     *   const response = await socket.timeout(1000).emitWithAck(\"hello\", \"world\");\n     * } catch (err) {\n     *   // the server did not acknowledge the event in the given delay\n     * }\n     *\n     * @return a Promise that will be fulfilled when the server acknowledges the event\n     */\n    emitWithAck(ev, ...args) {\n        return new Promise((resolve, reject) => {\n            const fn = (arg1, arg2) => {\n                return arg1 ? reject(arg1) : resolve(arg2);\n            };\n            fn.withError = true;\n            args.push(fn);\n            this.emit(ev, ...args);\n        });\n    }\n    /**\n     * Add the packet to the queue.\n     * @param args\n     * @private\n     */\n    _addToQueue(args) {\n        let ack;\n        if (typeof args[args.length - 1] === \"function\") {\n            ack = args.pop();\n        }\n        const packet = {\n            id: this._queueSeq++,\n            tryCount: 0,\n            pending: false,\n            args,\n            flags: Object.assign({ fromQueue: true }, this.flags),\n        };\n        args.push((err, ...responseArgs) => {\n            if (packet !== this._queue[0]) {\n                // the packet has already been acknowledged\n                return;\n            }\n            const hasError = err !== null;\n            if (hasError) {\n                if (packet.tryCount > this._opts.retries) {\n                    this._queue.shift();\n                    if (ack) {\n                        ack(err);\n                    }\n                }\n            }\n            else {\n                this._queue.shift();\n                if (ack) {\n                    ack(null, ...responseArgs);\n                }\n            }\n            packet.pending = false;\n            return this._drainQueue();\n        });\n        this._queue.push(packet);\n        this._drainQueue();\n    }\n    /**\n     * Send the first packet of the queue, and wait for an acknowledgement from the server.\n     * @param force - whether to resend a packet that has not been acknowledged yet\n     *\n     * @private\n     */\n    _drainQueue(force = false) {\n        if (!this.connected || this._queue.length === 0) {\n            return;\n        }\n        const packet = this._queue[0];\n        if (packet.pending && !force) {\n            return;\n        }\n        packet.pending = true;\n        packet.tryCount++;\n        this.flags = packet.flags;\n        this.emit.apply(this, packet.args);\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param packet\n     * @private\n     */\n    packet(packet) {\n        packet.nsp = this.nsp;\n        this.io._packet(packet);\n    }\n    /**\n     * Called upon engine `open`.\n     *\n     * @private\n     */\n    onopen() {\n        if (typeof this.auth == \"function\") {\n            this.auth((data) => {\n                this._sendConnectPacket(data);\n            });\n        }\n        else {\n            this._sendConnectPacket(this.auth);\n        }\n    }\n    /**\n     * Sends a CONNECT packet to initiate the Socket.IO session.\n     *\n     * @param data\n     * @private\n     */\n    _sendConnectPacket(data) {\n        this.packet({\n            type: PacketType.CONNECT,\n            data: this._pid\n                ? Object.assign({ pid: this._pid, offset: this._lastOffset }, data)\n                : data,\n        });\n    }\n    /**\n     * Called upon engine or manager `error`.\n     *\n     * @param err\n     * @private\n     */\n    onerror(err) {\n        if (!this.connected) {\n            this.emitReserved(\"connect_error\", err);\n        }\n    }\n    /**\n     * Called upon engine `close`.\n     *\n     * @param reason\n     * @param description\n     * @private\n     */\n    onclose(reason, description) {\n        this.connected = false;\n        delete this.id;\n        this.emitReserved(\"disconnect\", reason, description);\n        this._clearAcks();\n    }\n    /**\n     * Clears the acknowledgement handlers upon disconnection, since the client will never receive an acknowledgement from\n     * the server.\n     *\n     * @private\n     */\n    _clearAcks() {\n        Object.keys(this.acks).forEach((id) => {\n            const isBuffered = this.sendBuffer.some((packet) => String(packet.id) === id);\n            if (!isBuffered) {\n                // note: handlers that do not accept an error as first argument are ignored here\n                const ack = this.acks[id];\n                delete this.acks[id];\n                if (ack.withError) {\n                    ack.call(this, new Error(\"socket has been disconnected\"));\n                }\n            }\n        });\n    }\n    /**\n     * Called with socket packet.\n     *\n     * @param packet\n     * @private\n     */\n    onpacket(packet) {\n        const sameNamespace = packet.nsp === this.nsp;\n        if (!sameNamespace)\n            return;\n        switch (packet.type) {\n            case PacketType.CONNECT:\n                if (packet.data && packet.data.sid) {\n                    this.onconnect(packet.data.sid, packet.data.pid);\n                }\n                else {\n                    this.emitReserved(\"connect_error\", new Error(\"It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)\"));\n                }\n                break;\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                this.onevent(packet);\n                break;\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                this.onack(packet);\n                break;\n            case PacketType.DISCONNECT:\n                this.ondisconnect();\n                break;\n            case PacketType.CONNECT_ERROR:\n                this.destroy();\n                const err = new Error(packet.data.message);\n                // @ts-ignore\n                err.data = packet.data.data;\n                this.emitReserved(\"connect_error\", err);\n                break;\n        }\n    }\n    /**\n     * Called upon a server event.\n     *\n     * @param packet\n     * @private\n     */\n    onevent(packet) {\n        const args = packet.data || [];\n        if (null != packet.id) {\n            args.push(this.ack(packet.id));\n        }\n        if (this.connected) {\n            this.emitEvent(args);\n        }\n        else {\n            this.receiveBuffer.push(Object.freeze(args));\n        }\n    }\n    emitEvent(args) {\n        if (this._anyListeners && this._anyListeners.length) {\n            const listeners = this._anyListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, args);\n            }\n        }\n        super.emit.apply(this, args);\n        if (this._pid && args.length && typeof args[args.length - 1] === \"string\") {\n            this._lastOffset = args[args.length - 1];\n        }\n    }\n    /**\n     * Produces an ack callback to emit with an event.\n     *\n     * @private\n     */\n    ack(id) {\n        const self = this;\n        let sent = false;\n        return function (...args) {\n            // prevent double callbacks\n            if (sent)\n                return;\n            sent = true;\n            self.packet({\n                type: PacketType.ACK,\n                id: id,\n                data: args,\n            });\n        };\n    }\n    /**\n     * Called upon a server acknowledgement.\n     *\n     * @param packet\n     * @private\n     */\n    onack(packet) {\n        const ack = this.acks[packet.id];\n        if (typeof ack !== \"function\") {\n            return;\n        }\n        delete this.acks[packet.id];\n        // @ts-ignore FIXME ack is incorrectly inferred as 'never'\n        if (ack.withError) {\n            packet.data.unshift(null);\n        }\n        // @ts-ignore\n        ack.apply(this, packet.data);\n    }\n    /**\n     * Called upon server connect.\n     *\n     * @private\n     */\n    onconnect(id, pid) {\n        this.id = id;\n        this.recovered = pid && this._pid === pid;\n        this._pid = pid; // defined only if connection state recovery is enabled\n        this.connected = true;\n        this.emitBuffered();\n        this.emitReserved(\"connect\");\n        this._drainQueue(true);\n    }\n    /**\n     * Emit buffered events (received and emitted).\n     *\n     * @private\n     */\n    emitBuffered() {\n        this.receiveBuffer.forEach((args) => this.emitEvent(args));\n        this.receiveBuffer = [];\n        this.sendBuffer.forEach((packet) => {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        });\n        this.sendBuffer = [];\n    }\n    /**\n     * Called upon server disconnect.\n     *\n     * @private\n     */\n    ondisconnect() {\n        this.destroy();\n        this.onclose(\"io server disconnect\");\n    }\n    /**\n     * Called upon forced client/server side disconnections,\n     * this method ensures the manager stops tracking us and\n     * that reconnections don't get triggered for this.\n     *\n     * @private\n     */\n    destroy() {\n        if (this.subs) {\n            // clean subscriptions to avoid reconnections\n            this.subs.forEach((subDestroy) => subDestroy());\n            this.subs = undefined;\n        }\n        this.io[\"_destroy\"](this);\n    }\n    /**\n     * Disconnects the socket manually. In that case, the socket will not try to reconnect.\n     *\n     * If this is the last active Socket instance of the {@link Manager}, the low-level connection will be closed.\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   // console.log(reason); prints \"io client disconnect\"\n     * });\n     *\n     * socket.disconnect();\n     *\n     * @return self\n     */\n    disconnect() {\n        if (this.connected) {\n            this.packet({ type: PacketType.DISCONNECT });\n        }\n        // remove socket from pool\n        this.destroy();\n        if (this.connected) {\n            // fire events\n            this.onclose(\"io client disconnect\");\n        }\n        return this;\n    }\n    /**\n     * Alias for {@link disconnect()}.\n     *\n     * @return self\n     */\n    close() {\n        return this.disconnect();\n    }\n    /**\n     * Sets the compress flag.\n     *\n     * @example\n     * socket.compress(false).emit(\"hello\");\n     *\n     * @param compress - if `true`, compresses the sending data\n     * @return self\n     */\n    compress(compress) {\n        this.flags.compress = compress;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the event message will be dropped when this socket is not\n     * ready to send messages.\n     *\n     * @example\n     * socket.volatile.emit(\"hello\"); // the server may or may not receive it\n     *\n     * @returns self\n     */\n    get volatile() {\n        this.flags.volatile = true;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the callback will be called with an error when the\n     * given number of milliseconds have elapsed without an acknowledgement from the server:\n     *\n     * @example\n     * socket.timeout(5000).emit(\"my-event\", (err) => {\n     *   if (err) {\n     *     // the server did not acknowledge the event in the given delay\n     *   }\n     * });\n     *\n     * @returns self\n     */\n    timeout(timeout) {\n        this.flags.timeout = timeout;\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * @example\n     * socket.onAny((event, ...args) => {\n     *   console.log(`got ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * @example\n     * socket.prependAny((event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * }\n     *\n     * socket.onAny(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAny(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAny();\n     *\n     * @param listener\n     */\n    offAny(listener) {\n        if (!this._anyListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAny() {\n        return this._anyListeners || [];\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.onAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.prependAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * }\n     *\n     * socket.onAnyOutgoing(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAnyOutgoing(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAnyOutgoing();\n     *\n     * @param [listener] - the catch-all listener (optional)\n     */\n    offAnyOutgoing(listener) {\n        if (!this._anyOutgoingListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyOutgoingListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyOutgoingListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAnyOutgoing() {\n        return this._anyOutgoingListeners || [];\n    }\n    /**\n     * Notify the listeners for each packet sent\n     *\n     * @param packet\n     *\n     * @private\n     */\n    notifyOutgoingListeners(packet) {\n        if (this._anyOutgoingListeners && this._anyOutgoingListeners.length) {\n            const listeners = this._anyOutgoingListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, packet.data);\n            }\n        }\n    }\n}\n","/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\nexport function Backoff(opts) {\n    opts = opts || {};\n    this.ms = opts.min || 100;\n    this.max = opts.max || 10000;\n    this.factor = opts.factor || 2;\n    this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n    this.attempts = 0;\n}\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\nBackoff.prototype.duration = function () {\n    var ms = this.ms * Math.pow(this.factor, this.attempts++);\n    if (this.jitter) {\n        var rand = Math.random();\n        var deviation = Math.floor(rand * this.jitter * ms);\n        ms = (Math.floor(rand * 10) & 1) == 0 ? ms - deviation : ms + deviation;\n    }\n    return Math.min(ms, this.max) | 0;\n};\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\nBackoff.prototype.reset = function () {\n    this.attempts = 0;\n};\n/**\n * Set the minimum duration\n *\n * @api public\n */\nBackoff.prototype.setMin = function (min) {\n    this.ms = min;\n};\n/**\n * Set the maximum duration\n *\n * @api public\n */\nBackoff.prototype.setMax = function (max) {\n    this.max = max;\n};\n/**\n * Set the jitter\n *\n * @api public\n */\nBackoff.prototype.setJitter = function (jitter) {\n    this.jitter = jitter;\n};\n","import { Socket as Engine, installTimerFunctions, nextTick, } from \"engine.io-client\";\nimport { Socket } from \"./socket.js\";\nimport * as parser from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Backoff } from \"./contrib/backo2.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\nexport class Manager extends Emitter {\n    constructor(uri, opts) {\n        var _a;\n        super();\n        this.nsps = {};\n        this.subs = [];\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = undefined;\n        }\n        opts = opts || {};\n        opts.path = opts.path || \"/socket.io\";\n        this.opts = opts;\n        installTimerFunctions(this, opts);\n        this.reconnection(opts.reconnection !== false);\n        this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n        this.reconnectionDelay(opts.reconnectionDelay || 1000);\n        this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n        this.randomizationFactor((_a = opts.randomizationFactor) !== null && _a !== void 0 ? _a : 0.5);\n        this.backoff = new Backoff({\n            min: this.reconnectionDelay(),\n            max: this.reconnectionDelayMax(),\n            jitter: this.randomizationFactor(),\n        });\n        this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n        this._readyState = \"closed\";\n        this.uri = uri;\n        const _parser = opts.parser || parser;\n        this.encoder = new _parser.Encoder();\n        this.decoder = new _parser.Decoder();\n        this._autoConnect = opts.autoConnect !== false;\n        if (this._autoConnect)\n            this.open();\n    }\n    reconnection(v) {\n        if (!arguments.length)\n            return this._reconnection;\n        this._reconnection = !!v;\n        if (!v) {\n            this.skipReconnect = true;\n        }\n        return this;\n    }\n    reconnectionAttempts(v) {\n        if (v === undefined)\n            return this._reconnectionAttempts;\n        this._reconnectionAttempts = v;\n        return this;\n    }\n    reconnectionDelay(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelay;\n        this._reconnectionDelay = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMin(v);\n        return this;\n    }\n    randomizationFactor(v) {\n        var _a;\n        if (v === undefined)\n            return this._randomizationFactor;\n        this._randomizationFactor = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setJitter(v);\n        return this;\n    }\n    reconnectionDelayMax(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelayMax;\n        this._reconnectionDelayMax = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMax(v);\n        return this;\n    }\n    timeout(v) {\n        if (!arguments.length)\n            return this._timeout;\n        this._timeout = v;\n        return this;\n    }\n    /**\n     * Starts trying to reconnect if reconnection is enabled and we have not\n     * started reconnecting yet\n     *\n     * @private\n     */\n    maybeReconnectOnOpen() {\n        // Only try to reconnect if it's the first time we're connecting\n        if (!this._reconnecting &&\n            this._reconnection &&\n            this.backoff.attempts === 0) {\n            // keeps reconnection from firing twice for the same reconnection loop\n            this.reconnect();\n        }\n    }\n    /**\n     * Sets the current transport `socket`.\n     *\n     * @param {Function} fn - optional, callback\n     * @return self\n     * @public\n     */\n    open(fn) {\n        if (~this._readyState.indexOf(\"open\"))\n            return this;\n        this.engine = new Engine(this.uri, this.opts);\n        const socket = this.engine;\n        const self = this;\n        this._readyState = \"opening\";\n        this.skipReconnect = false;\n        // emit `open`\n        const openSubDestroy = on(socket, \"open\", function () {\n            self.onopen();\n            fn && fn();\n        });\n        const onError = (err) => {\n            this.cleanup();\n            this._readyState = \"closed\";\n            this.emitReserved(\"error\", err);\n            if (fn) {\n                fn(err);\n            }\n            else {\n                // Only do this if there is no fn to handle the error\n                this.maybeReconnectOnOpen();\n            }\n        };\n        // emit `error`\n        const errorSub = on(socket, \"error\", onError);\n        if (false !== this._timeout) {\n            const timeout = this._timeout;\n            // set timer\n            const timer = this.setTimeoutFn(() => {\n                openSubDestroy();\n                onError(new Error(\"timeout\"));\n                socket.close();\n            }, timeout);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n        this.subs.push(openSubDestroy);\n        this.subs.push(errorSub);\n        return this;\n    }\n    /**\n     * Alias for open()\n     *\n     * @return self\n     * @public\n     */\n    connect(fn) {\n        return this.open(fn);\n    }\n    /**\n     * Called upon transport open.\n     *\n     * @private\n     */\n    onopen() {\n        // clear old subs\n        this.cleanup();\n        // mark as open\n        this._readyState = \"open\";\n        this.emitReserved(\"open\");\n        // add new subs\n        const socket = this.engine;\n        this.subs.push(on(socket, \"ping\", this.onping.bind(this)), on(socket, \"data\", this.ondata.bind(this)), on(socket, \"error\", this.onerror.bind(this)), on(socket, \"close\", this.onclose.bind(this)), \n        // @ts-ignore\n        on(this.decoder, \"decoded\", this.ondecoded.bind(this)));\n    }\n    /**\n     * Called upon a ping.\n     *\n     * @private\n     */\n    onping() {\n        this.emitReserved(\"ping\");\n    }\n    /**\n     * Called with data.\n     *\n     * @private\n     */\n    ondata(data) {\n        try {\n            this.decoder.add(data);\n        }\n        catch (e) {\n            this.onclose(\"parse error\", e);\n        }\n    }\n    /**\n     * Called when parser fully decodes a packet.\n     *\n     * @private\n     */\n    ondecoded(packet) {\n        // the nextTick call prevents an exception in a user-provided event listener from triggering a disconnection due to a \"parse error\"\n        nextTick(() => {\n            this.emitReserved(\"packet\", packet);\n        }, this.setTimeoutFn);\n    }\n    /**\n     * Called upon socket error.\n     *\n     * @private\n     */\n    onerror(err) {\n        this.emitReserved(\"error\", err);\n    }\n    /**\n     * Creates a new socket for the given `nsp`.\n     *\n     * @return {Socket}\n     * @public\n     */\n    socket(nsp, opts) {\n        let socket = this.nsps[nsp];\n        if (!socket) {\n            socket = new Socket(this, nsp, opts);\n            this.nsps[nsp] = socket;\n        }\n        else if (this._autoConnect && !socket.active) {\n            socket.connect();\n        }\n        return socket;\n    }\n    /**\n     * Called upon a socket close.\n     *\n     * @param socket\n     * @private\n     */\n    _destroy(socket) {\n        const nsps = Object.keys(this.nsps);\n        for (const nsp of nsps) {\n            const socket = this.nsps[nsp];\n            if (socket.active) {\n                return;\n            }\n        }\n        this._close();\n    }\n    /**\n     * Writes a packet.\n     *\n     * @param packet\n     * @private\n     */\n    _packet(packet) {\n        const encodedPackets = this.encoder.encode(packet);\n        for (let i = 0; i < encodedPackets.length; i++) {\n            this.engine.write(encodedPackets[i], packet.options);\n        }\n    }\n    /**\n     * Clean up transport subscriptions and packet buffer.\n     *\n     * @private\n     */\n    cleanup() {\n        this.subs.forEach((subDestroy) => subDestroy());\n        this.subs.length = 0;\n        this.decoder.destroy();\n    }\n    /**\n     * Close the current socket.\n     *\n     * @private\n     */\n    _close() {\n        this.skipReconnect = true;\n        this._reconnecting = false;\n        this.onclose(\"forced close\");\n    }\n    /**\n     * Alias for close()\n     *\n     * @private\n     */\n    disconnect() {\n        return this._close();\n    }\n    /**\n     * Called when:\n     *\n     * - the low-level engine is closed\n     * - the parser encountered a badly formatted packet\n     * - all sockets are disconnected\n     *\n     * @private\n     */\n    onclose(reason, description) {\n        var _a;\n        this.cleanup();\n        (_a = this.engine) === null || _a === void 0 ? void 0 : _a.close();\n        this.backoff.reset();\n        this._readyState = \"closed\";\n        this.emitReserved(\"close\", reason, description);\n        if (this._reconnection && !this.skipReconnect) {\n            this.reconnect();\n        }\n    }\n    /**\n     * Attempt a reconnection.\n     *\n     * @private\n     */\n    reconnect() {\n        if (this._reconnecting || this.skipReconnect)\n            return this;\n        const self = this;\n        if (this.backoff.attempts >= this._reconnectionAttempts) {\n            this.backoff.reset();\n            this.emitReserved(\"reconnect_failed\");\n            this._reconnecting = false;\n        }\n        else {\n            const delay = this.backoff.duration();\n            this._reconnecting = true;\n            const timer = this.setTimeoutFn(() => {\n                if (self.skipReconnect)\n                    return;\n                this.emitReserved(\"reconnect_attempt\", self.backoff.attempts);\n                // check again for the case socket closed in above events\n                if (self.skipReconnect)\n                    return;\n                self.open((err) => {\n                    if (err) {\n                        self._reconnecting = false;\n                        self.reconnect();\n                        this.emitReserved(\"reconnect_error\", err);\n                    }\n                    else {\n                        self.onreconnect();\n                    }\n                });\n            }, delay);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n    }\n    /**\n     * Called upon successful reconnect.\n     *\n     * @private\n     */\n    onreconnect() {\n        const attempt = this.backoff.attempts;\n        this._reconnecting = false;\n        this.backoff.reset();\n        this.emitReserved(\"reconnect\", attempt);\n    }\n}\n","import { url } from \"./url.js\";\nimport { Manager } from \"./manager.js\";\nimport { Socket } from \"./socket.js\";\n/**\n * Managers cache.\n */\nconst cache = {};\nfunction lookup(uri, opts) {\n    if (typeof uri === \"object\") {\n        opts = uri;\n        uri = undefined;\n    }\n    opts = opts || {};\n    const parsed = url(uri, opts.path || \"/socket.io\");\n    const source = parsed.source;\n    const id = parsed.id;\n    const path = parsed.path;\n    const sameNamespace = cache[id] && path in cache[id][\"nsps\"];\n    const newConnection = opts.forceNew ||\n        opts[\"force new connection\"] ||\n        false === opts.multiplex ||\n        sameNamespace;\n    let io;\n    if (newConnection) {\n        io = new Manager(source, opts);\n    }\n    else {\n        if (!cache[id]) {\n            cache[id] = new Manager(source, opts);\n        }\n        io = cache[id];\n    }\n    if (parsed.query && !opts.query) {\n        opts.query = parsed.queryKey;\n    }\n    return io.socket(parsed.path, opts);\n}\n// so that \"lookup\" can be used both as a function (e.g. `io(...)`) and as a\n// namespace (e.g. `io.connect(...)`), for backward compatibility\nObject.assign(lookup, {\n    Manager,\n    Socket,\n    io: lookup,\n    connect: lookup,\n});\n/**\n * Protocol version.\n *\n * @public\n */\nexport { protocol } from \"socket.io-parser\";\n/**\n * Expose constructors for standalone build.\n *\n * @public\n */\nexport { Manager, Socket, lookup as io, lookup as connect, lookup as default, };\nexport { Fetch, NodeXHR, XHR, NodeWebSocket, WebSocket, WebTransport, } from \"engine.io-client\";\n","import React, { createContext, useContext, useState, useEffect, useRef, useCallback } from 'react';\nimport { useAuth } from './AuthContext';\nimport { Chat } from '../types/chat';\nimport { Message } from '../types/message';\nimport { io, Socket } from 'socket.io-client';\n\ninterface ChatContextType {\n  chats: Chat[];\n  currentChat: Chat | null;\n  messages: Message[];\n  loading: boolean;\n  error: string | null;\n  unreadCounts: { [chatId: string]: number };\n  unreadCount: number;\n  setCurrentChat: (chat: Chat | null) => void;\n  sendMessage: (chatId: string, text: string) => Promise<void>;\n  startChat: (participantId: string) => Promise<void>;\n  refreshUnreadCounts: () => Promise<void>;\n  fetchChats: () => Promise<void>;\n  socket: Socket | null;\n}\n\nconst ChatContext = createContext<ChatContextType | undefined>(undefined);\n\nexport const ChatProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n  const { user, token } = useAuth();\n  const socketRef = useRef<Socket | null>(null);\n  const [chats, setChats] = useState<Chat[]>([]);\n  const [currentChat, setCurrentChat] = useState<Chat | null>(null);\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [unreadCounts, setUnreadCounts] = useState<{ [chatId: string]: number }>({});\n\n  const apiUrl = process.env.VITE_API_URL || 'http://localhost:3001';\n\n  // Initialize socket connection\n  useEffect(() => {\n    if (!token || !user) return;\n\n    const initializeSocket = async () => {\n      try {\n        // Get a fresh token before connecting\n        const freshToken = await user.getIdToken(true);\n        \n        const socket = io(apiUrl, {\n          auth: {\n            token: freshToken\n          },\n          transports: ['websocket', 'polling'],\n          reconnection: true,\n          reconnectionAttempts: 5,\n          reconnectionDelay: 1000,\n          reconnectionDelayMax: 5000,\n          timeout: 30000,\n          forceNew: true,\n          autoConnect: true\n        });\n\n        socket.on('connect', () => {\n          console.log('Socket connected successfully');\n          setError(null);\n        });\n\n        socket.on('connect_error', async (error) => {\n          console.error('Socket connection error:', error);\n          \n          // If token expired, try to refresh and reconnect\n          if (error.message.includes('id-token-expired')) {\n            try {\n              const newToken = await user.getIdToken(true);\n              socket.auth = { token: newToken };\n              socket.connect();\n            } catch (refreshError) {\n              console.error('Error refreshing token:', refreshError);\n              setError('Failed to refresh authentication. Please log in again.');\n            }\n          } else {\n            setError('Failed to connect to chat server. Retrying...');\n            \n            // Try to reconnect after a delay\n            setTimeout(() => {\n              if (socket.disconnected) {\n                console.log('Attempting to reconnect...');\n                socket.connect();\n              }\n            }, 5000);\n          }\n        });\n\n        socket.on('disconnect', (reason) => {\n          console.log('Socket disconnected:', reason);\n          if (reason === 'io server disconnect' || reason === 'io client disconnect') {\n            // the disconnection was initiated by the server or client, reconnect manually\n            socket.connect();\n          }\n        });\n\n        socket.on('error', (error) => {\n          console.error('Socket error:', error);\n          setError('Chat server error. Attempting to reconnect...');\n        });\n\n        socket.on('reconnect', (attemptNumber) => {\n          console.log('Socket reconnected after', attemptNumber, 'attempts');\n          setError(null);\n        });\n\n        socket.on('reconnect_error', (error) => {\n          console.error('Socket reconnection error:', error);\n          setError('Failed to reconnect to chat server');\n        });\n\n        socket.on('reconnect_failed', () => {\n          console.error('Socket reconnection failed');\n          setError('Unable to reconnect to chat server. Please refresh the page.');\n        });\n\n        socketRef.current = socket;\n\n        return () => {\n          if (socket.connected) {\n            socket.disconnect();\n          }\n          socketRef.current = null;\n        };\n      } catch (error) {\n        console.error('Error initializing socket:', error);\n        setError('Failed to initialize chat connection');\n      }\n    };\n\n    initializeSocket();\n  }, [token, user, apiUrl]);\n\n  // Calculate total unread count\n  const unreadCount = Object.values(unreadCounts).reduce((sum, count) => {\n    const numCount = Number(count);\n    return sum + (isNaN(numCount) ? 0 : numCount);\n  }, 0);\n\n  const refreshUnreadCounts = useCallback(async () => {\n    if (!token || !user) return;\n\n    try {\n      const response = await fetch(`${apiUrl}/api/chats/unread`, {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include'\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        console.error('Failed to fetch unread counts:', {\n          status: response.status,\n          statusText: response.statusText,\n          errorText\n        });\n        throw new Error(`Failed to fetch unread counts: ${response.status} ${response.statusText}`);\n      }\n\n      const counts = await response.json();\n      if (!Array.isArray(counts)) {\n        console.error('Invalid response format for unread counts:', counts);\n        throw new Error('Invalid response format for unread counts');\n      }\n\n      const newUnreadCounts = counts.reduce((acc: { [key: string]: number }, item: { chatId: string, unreadCount: number }) => {\n        const count = Number(item.unreadCount);\n        acc[item.chatId] = isNaN(count) ? 0 : count;\n        return acc;\n      }, {});\n\n      setUnreadCounts(newUnreadCounts);\n    } catch (err) {\n      console.error('Error fetching unread counts:', err);\n      setUnreadCounts({});\n      setError('Failed to fetch unread counts');\n    }\n  }, [token, user, apiUrl]);\n\n  const fetchChats = useCallback(async () => {\n    if (!token || !user) return;\n\n    setLoading(true);\n    try {\n      // Get a fresh token\n      const freshToken = await user.getIdToken(true);\n      console.log('Fetching chats with token:', freshToken.substring(0, 10) + '...');\n      \n      const response = await fetch(`${apiUrl}/api/chats`, {\n        headers: {\n          'Authorization': `Bearer ${freshToken}`,\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include'\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        console.error('Failed to fetch chats:', {\n          status: response.status,\n          statusText: response.statusText,\n          errorText\n        });\n        throw new Error(`Failed to fetch chats: ${response.status} ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      if (!Array.isArray(data)) {\n        console.error('Invalid response format for chats:', data);\n        throw new Error('Invalid response format for chats');\n      }\n\n      // Debug log\n      console.log('Chats fetched:', {\n        count: data.length,\n        currentUser: {\n          uid: user.uid,\n          email: user.email\n        },\n        firstChat: data[0] ? {\n          _id: data[0]._id,\n          participants: data[0].participants.map((p: { uid: string; username?: string; email?: string; displayName?: string }) => ({\n            uid: p.uid,\n            username: p.username,\n            email: p.email,\n            displayName: p.displayName\n          }))\n        } : null\n      });\n\n      // Ensure participants have the correct structure\n      const processedData = data.map(chat => ({\n        ...chat,\n        participants: chat.participants.map((p: any) => ({\n          uid: p.uid,\n          username: p.username,\n          email: p.email,\n          displayName: p.displayName,\n          photoURL: p.photoURL\n        }))\n      }));\n\n      setChats(processedData);\n      setError(null);\n    } catch (err) {\n      console.error('Error fetching chats:', err);\n      setChats([]);\n      setError('Failed to fetch chats');\n    } finally {\n      setLoading(false);\n    }\n  }, [token, user, apiUrl]);\n\n  const fetchMessages = useCallback(async (chatId: string) => {\n    if (!token || !user) return;\n\n    setLoading(true);\n    try {\n      const response = await fetch(`${apiUrl}/api/chats/${chatId}`, {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        },\n      });\n\n      if (!response.ok) throw new Error('Failed to fetch messages');\n      const data = await response.json();\n      setMessages(data);\n    } catch (err) {\n      console.error('Error fetching messages:', err);\n      setMessages([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [token, user, apiUrl]);\n\n  const handleSetCurrentChat = useCallback(async (chat: Chat | null) => {\n    setCurrentChat(chat);\n    if (chat?._id) {\n      // Mark messages as read when opening chat\n      try {\n        const response = await fetch(`${apiUrl}/api/chats/${chat._id}/read`, {\n          method: 'PUT',\n          headers: {\n            'Authorization': `Bearer ${token}`,\n            'Content-Type': 'application/json'\n          }\n        });\n\n        if (response.ok) {\n          const { unreadCount } = await response.json();\n          // Update unread counts in the UI\n          setUnreadCounts(prev => ({\n            ...prev,\n            [chat._id]: unreadCount\n          }));\n        }\n      } catch (error) {\n        console.error('Error marking messages as read:', error);\n      }\n\n      fetchMessages(chat._id);\n    } else {\n      setMessages([]);\n    }\n  }, [fetchMessages, token, apiUrl]);\n\n  const sendMessage = async (chatId: string, text: string) => {\n    if (!token || !user) throw new Error('Not authenticated');\n\n    try {\n      const response = await fetch(`${apiUrl}/api/chats/${chatId}/messages`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`,\n        },\n        body: JSON.stringify({ text }),\n      });\n\n      if (!response.ok) throw new Error('Failed to send message');\n      const newMessage = await response.json();\n      setMessages(prev => [...prev, newMessage]);\n      await refreshUnreadCounts();\n    } catch (err) {\n      console.error('Error sending message:', err);\n      throw err;\n    }\n  };\n\n  const startChat = async (participantId: string) => {\n    if (!token || !user) throw new Error('Not authenticated');\n\n    try {\n      const response = await fetch(`${apiUrl}/api/chats`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`,\n        },\n        body: JSON.stringify({ participantId }),\n      });\n\n      if (!response.ok) throw new Error('Failed to start chat');\n      const newChat = await response.json();\n      setChats(prev => {\n        const exists = prev.some(chat => chat._id === newChat._id);\n        return exists ? prev : [...prev, newChat];\n      });\n      setCurrentChat(newChat);\n      return newChat;\n    } catch (err) {\n      console.error('Error starting chat:', err);\n      throw err;\n    }\n  };\n\n  useEffect(() => {\n    if (token && user) {\n      fetchChats();\n      refreshUnreadCounts();\n    }\n  }, [token, user, fetchChats, refreshUnreadCounts]);\n\n  const value: ChatContextType = {\n    chats,\n    currentChat,\n    messages,\n    loading,\n    error,\n    unreadCounts,\n    unreadCount,\n    setCurrentChat: handleSetCurrentChat,\n    sendMessage,\n    startChat,\n    refreshUnreadCounts,\n    fetchChats,\n    socket: socketRef.current,\n  };\n\n  return <ChatContext.Provider value={value}>{children}</ChatContext.Provider>;\n};\n\nexport const useChat = () => {\n  const context = useContext(ChatContext);\n  if (context === undefined) {\n    throw new Error('useChat must be used within a ChatProvider');\n  }\n  return context;\n}; ","import { createTheme } from '@mui/material/styles';\r\n\r\nexport const theme = createTheme({\r\n  palette: {\r\n    primary: {\r\n      main: '#2E7D32', // A fresh green color\r\n      light: '#4CAF50',\r\n      dark: '#1B5E20',\r\n      contrastText: '#ffffff',\r\n    },\r\n    secondary: {\r\n      main: '#FFA000', // Warm amber color\r\n      light: '#FFB74D',\r\n      dark: '#F57C00',\r\n      contrastText: '#000000',\r\n    },\r\n    background: {\r\n      default: '#F5F7FA',\r\n      paper: '#FFFFFF',\r\n    },\r\n    text: {\r\n      primary: '#2C3E50',\r\n      secondary: '#546E7A',\r\n    },\r\n    error: {\r\n      main: '#D32F2F',\r\n      light: '#EF5350',\r\n      dark: '#C62828',\r\n    },\r\n    success: {\r\n      main: '#2E7D32',\r\n      light: '#4CAF50',\r\n      dark: '#1B5E20',\r\n    },\r\n  },\r\n  typography: {\r\n    fontFamily: '\"Poppins\", \"Roboto\", \"Helvetica\", \"Arial\", sans-serif',\r\n    h1: {\r\n      fontSize: '2.5rem',\r\n      fontWeight: 600,\r\n      lineHeight: 1.2,\r\n    },\r\n    h2: {\r\n      fontSize: '2rem',\r\n      fontWeight: 600,\r\n      lineHeight: 1.3,\r\n    },\r\n    h3: {\r\n      fontSize: '1.75rem',\r\n      fontWeight: 600,\r\n      lineHeight: 1.4,\r\n    },\r\n    h4: {\r\n      fontSize: '1.5rem',\r\n      fontWeight: 500,\r\n      lineHeight: 1.4,\r\n    },\r\n    h5: {\r\n      fontSize: '1.25rem',\r\n      fontWeight: 500,\r\n      lineHeight: 1.4,\r\n    },\r\n    h6: {\r\n      fontSize: '1rem',\r\n      fontWeight: 500,\r\n      lineHeight: 1.4,\r\n    },\r\n    body1: {\r\n      fontSize: '1rem',\r\n      lineHeight: 1.5,\r\n    },\r\n    body2: {\r\n      fontSize: '0.875rem',\r\n      lineHeight: 1.5,\r\n    },\r\n    button: {\r\n      textTransform: 'none',\r\n      fontWeight: 500,\r\n    },\r\n  },\r\n  shape: {\r\n    borderRadius: 8,\r\n  },\r\n  components: {\r\n    MuiButton: {\r\n      styleOverrides: {\r\n        root: {\r\n          borderRadius: 8,\r\n          padding: '8px 16px',\r\n          fontSize: '0.875rem',\r\n        },\r\n        contained: {\r\n          boxShadow: 'none',\r\n          '&:hover': {\r\n            boxShadow: '0px 2px 4px rgba(0,0,0,0.1)',\r\n          },\r\n        },\r\n      },\r\n    },\r\n    MuiCard: {\r\n      styleOverrides: {\r\n        root: {\r\n          borderRadius: 12,\r\n          boxShadow: '0px 4px 20px rgba(0,0,0,0.05)',\r\n          transition: 'transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out',\r\n          '&:hover': {\r\n            transform: 'translateY(-4px)',\r\n            boxShadow: '0px 8px 24px rgba(0,0,0,0.1)',\r\n          },\r\n        },\r\n      },\r\n    },\r\n    MuiTextField: {\r\n      styleOverrides: {\r\n        root: {\r\n          '& .MuiOutlinedInput-root': {\r\n            borderRadius: 8,\r\n          },\r\n        },\r\n      },\r\n    },\r\n    MuiAppBar: {\r\n      styleOverrides: {\r\n        root: {\r\n          boxShadow: '0px 2px 8px rgba(0,0,0,0.1)',\r\n          background: 'rgba(255,255,255,0.9)',\r\n          backdropFilter: 'blur(8px)',\r\n          color: '#2C3E50',\r\n          borderBottom: '1px solid rgba(0,0,0,0.05)',\r\n        },\r\n      },\r\n    },\r\n  },\r\n}); ","\"use strict\";\n'use client';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"default\", {\n  enumerable: true,\n  get: function () {\n    return _utils.createSvgIcon;\n  }\n});\nvar _utils = require(\"@mui/material/utils\");","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54z\"\n}), 'Favorite');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3m-4.4 15.55-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05\"\n}), 'FavoriteBorder');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5\"\n}), 'LocationOn');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2M6 9h12v2H6zm8 5H6v-2h8zm4-6H6V6h12z\"\n}), 'Chat');","// Placeholder images\r\nexport const heroImage = 'https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80';\r\n\r\nexport const vegetablesImage = 'https://images.unsplash.com/photo-1518843875459-f738682238a6?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2042&q=80';\r\n\r\nexport const shoppingBagsImage = 'https://images.unsplash.com/photo-1555529669-e69e7aa0ba9a?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80';\r\n\r\nexport const bambooImage = 'https://jungleculture.eco/cdn/shop/files/SQUARE-Bamboo-Cutlery-Set_1_d599e041-8557-4a55-9a54-7067752fbff0_2048x.jpg?v=1691488817';\r\n\r\nexport const shoesImage = 'https://images.unsplash.com/photo-1542291026-7eec264c27ff?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80';\r\n\r\nexport const coffeeMakerImage = 'https://m.media-amazon.com/images/I/818gyfjYmZL.jpg';\r\n\r\nexport const jacketImage = 'https://www.houseofkids.com/media/catalog/product/cache/1/image/9df78eab33525d08d6e5fb8d27136e95/5/f/5f3503400a50bHugo_Boss-_jakke-j26417-09b_0_Front_website.jpg';\r\n\r\nexport const boardGamesImage = 'https://dailyworkerplacement.com/wp-content/uploads/2017/12/shelfb-1648x1140.jpg';\r\n\r\nexport const yogaMatImage = 'https://yolohayoga.com/cdn/shop/files/Aura-Cork-Yoga-Mat.jpg?v=1695911413';\r\n\r\nexport const blenderImage = 'https://www.dualit.com/cdn/shop/files/Blender-Chrome-Lifestyle-1.jpg?v=1685022361';\r\n\r\nexport const childrenBooksImage = 'https://ik.imagekit.io/panmac/tr:f-auto,w-740,pr-true//bcd02f72-b50c-0179-8b4b-5e44f5340bd4/c56137c1-a008-48ee-b479-71c378adcbb2/Modern-children%27s-books-we-think-will-be-classics.jpg';\r\n\r\nexport const gardenToolsImage = 'https://m.media-amazon.com/images/I/71z-qa1M5dL._AC_SL1500_.jpg';\r\n\r\nexport const laptopStandImage = 'https://hniesfp.imgix.net/8/images/detailed/312/AALNBS-SGR_1.jpg?fit=fill&bg=0FFF&w=1500&h=1000&auto=format,compress';\r\n\r\nexport const bicycleImage = 'https://intensecycles.com/cdn/shop/files/2_2.png?v=1714596775';\r\n\r\nexport const artSuppliesImage = 'https://m.media-amazon.com/images/I/81qQrGur9QL.jpg';\r\n\r\nexport const deskLampImage = 'https://i5.walmartimages.com/seo/Home-Decorative-Mainstays-LED-Architect-Desk-Lamp-Black-Metal-Powder-Coating-Finish-for-All-Ages_2416f3cf-e5d2-4e9d-9612-d2ad61a014e0.ce7d149337e1d115ba4a61a2c3a11904.jpeg';\r\n\r\nexport const laptopImage = 'https://cdncloudcart.com/402/products/images/148284/laptop-apple-macbook-pro-16a-m3-pro-512gb-space-black-mrw13--16-20--18--512gb-ssd--apple-m3-pro-12-core--apple-m3-pro-18-core-gpu-6542458122175_800x800.png?1698842017';\r\n\r\nexport const nikeShoesImage = 'https://lotus-sport.bg/image/cache/catalog/212/NIKE/3/CD4373-004-mazhki-maratonki-nike-react-vision-black1-min-850x850.jpg';\r\n\r\nexport const clothesImage = 'https://images.unsplash.com/photo-1532453288672-3a27e9be9efd?fm=jpg&q=60&w=3000&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8Y2xvdGhlc3xlbnwwfHwwfHx8MA%3D%3D';\r\n\r\nexport const electronicsImage = 'https://images.unsplash.com/photo-1518770660439-4636190af475?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80';\r\n\r\nexport const booksImage = 'https://images.unsplash.com/photo-1543002588-bfa74002ed7e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80';\r\n\r\nexport const furnitureImage = 'https://st4.depositphotos.com/1023934/37752/i/450/depositphotos_377527168-stock-photo-interior-design-modern-living-room.jpg';\r\n\r\nexport const toysImage = 'https://t3.ftcdn.net/jpg/00/74/44/28/360_F_74442850_C0PsTWPFlOfwcPA3AybYefXDBmnWVsWX.jpg';\r\n\r\nexport const sportsImage = 'https://t4.ftcdn.net/jpg/00/04/43/79/360_F_4437974_DbE4NRiaoRtUeivMyfPoXZFNdCnYmjPq.jpg';\r\n","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14\"\n}), 'Search');","import React from 'react';\r\nimport { TextField, InputAdornment, IconButton, SxProps, Theme } from '@mui/material';\r\nimport SearchIcon from '@mui/icons-material/Search';\r\n\r\ninterface SearchBarProps {\r\n  value: string;\r\n  onChange: (value: string) => void;\r\n  onSearch?: (value: string) => void;\r\n  placeholder?: string;\r\n  sx?: SxProps<Theme>;\r\n  variant?: 'home' | 'search';\r\n}\r\n\r\nconst SearchBar: React.FC<SearchBarProps> = ({ \r\n  value, \r\n  onChange, \r\n  onSearch,\r\n  placeholder = 'Търсене...', \r\n  sx,\r\n  variant = 'search'\r\n}) => {\r\n  const getVariantStyles = (theme: Theme): SxProps<Theme> => {\r\n    const baseStyles: SxProps<Theme> = {\r\n      '& .MuiInputBase-root': {\r\n        backgroundColor: variant === 'home' ? 'rgba(255, 255, 255, 0.9)' : '#ffffff',\r\n        backdropFilter: variant === 'home' ? 'blur(4px)' : 'none',\r\n        borderRadius: 2,\r\n        border: variant === 'home' \r\n          ? '1px solid rgba(255, 255, 255, 0.3)'\r\n          : `1px solid ${theme.palette.divider}`,\r\n        boxShadow: '0 2px 4px rgba(0,0,0,0.05)',\r\n        transition: 'all 0.2s ease-in-out',\r\n        '&:hover': {\r\n          backgroundColor: variant === 'home' ? 'rgba(255, 255, 255, 1)' : '#ffffff',\r\n          border: variant === 'home'\r\n            ? '1px solid rgba(255, 255, 255, 0.5)'\r\n            : `1px solid ${theme.palette.primary.main}`,\r\n          boxShadow: '0 4px 8px rgba(0,0,0,0.1)',\r\n        },\r\n        '&.Mui-focused': {\r\n          backgroundColor: variant === 'home' ? 'rgba(255, 255, 255, 1)' : '#ffffff',\r\n          border: variant === 'home'\r\n            ? '2px solid rgba(255, 255, 255, 0.8)'\r\n            : `2px solid ${theme.palette.primary.main}`,\r\n          boxShadow: '0 8px 16px rgba(0,0,0,0.2)',\r\n        }\r\n      },\r\n      '& .MuiInputBase-input': {\r\n        padding: '16px',\r\n        fontSize: '1.1rem',\r\n        color: theme.palette.text.primary,\r\n        '&::placeholder': {\r\n          color: theme.palette.text.secondary,\r\n          opacity: 0.8\r\n        }\r\n      },\r\n      '& .MuiInputAdornment-root .MuiSvgIcon-root': {\r\n        fontSize: '1.5rem',\r\n        color: theme.palette.primary.main,\r\n        marginLeft: '8px'\r\n      }\r\n    };\r\n\r\n    return baseStyles;\r\n  };\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (onSearch && value.trim()) {\r\n      onSearch(value);\r\n    }\r\n  };\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && onSearch && value.trim()) {\r\n      onSearch(value);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} style={{ width: '100%' }}>\r\n      <TextField\r\n        fullWidth\r\n        value={value}\r\n        onChange={(e) => onChange(e.target.value)}\r\n        onKeyPress={handleKeyPress}\r\n        placeholder={placeholder}\r\n        sx={(theme) => ({\r\n          ...getVariantStyles(theme),\r\n          ...(sx && typeof sx === 'function' ? sx(theme) : sx)\r\n        })}\r\n        InputProps={{\r\n          endAdornment: (\r\n            <InputAdornment position=\"end\">\r\n              <IconButton \r\n                type=\"submit\"\r\n                aria-label=\"search\"\r\n                onClick={() => onSearch && value.trim() && onSearch(value)}\r\n                sx={{ \r\n                  color: 'primary.main',\r\n                  '&:hover': {\r\n                    backgroundColor: 'rgba(46, 125, 50, 0.04)'\r\n                  }\r\n                }}\r\n              >\r\n                <SearchIcon />\r\n              </IconButton>\r\n            </InputAdornment>\r\n          ),\r\n        }}\r\n      />\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default SearchBar; ","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z\"\n}), 'Email');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02z\"\n}), 'Phone');","import React from 'react';\r\nimport {\r\n  Box,\r\n  Container,\r\n  Grid,\r\n  Typography,\r\n  Link,\r\n  Divider,\r\n} from '@mui/material';\r\nimport EmailIcon from '@mui/icons-material/Email';\r\nimport PhoneIcon from '@mui/icons-material/Phone';\r\nimport LocationOnIcon from '@mui/icons-material/LocationOn';\r\nimport { Link as RouterLink } from 'react-router-dom';\r\n\r\ninterface Category {\r\n  name: string;\r\n  icon: string;\r\n}\r\n\r\nconst Footer: React.FC = () => {\r\n  const quickLinks = [\r\n    { title: 'Начало', path: '/' },\r\n    { title: 'За нас', path: '/about' },\r\n    { title: 'Как работи', path: '/how-it-works' },\r\n    { title: 'Създай обява', path: '/create-listing' },\r\n    { title: 'Търсене', path: '/search' },\r\n    { title: 'Контакти', path: '/contact' },\r\n  ];\r\n\r\n  const legalLinks = [\r\n    { title: 'Политика за поверителност', path: '/privacy' },\r\n    { title: 'Условия за ползване', path: '/terms' },\r\n  ];\r\n\r\n  const categories: Category[] = [\r\n    { name: 'Дрехи', icon: '' },\r\n    { name: 'Електроника', icon: '' },\r\n    { name: 'Книги', icon: '' },\r\n    { name: 'Мебели', icon: '' },\r\n    { name: 'Спортни стоки', icon: '' },\r\n    { name: 'Кухненски принадлежности', icon: '' },\r\n    { name: 'Инструменти', icon: '' },\r\n    { name: 'Други', icon: '' }\r\n  ];\r\n\r\n  return (\r\n    <Box\r\n      component=\"footer\"\r\n      sx={{\r\n        bgcolor: 'primary.main',\r\n        color: 'white',\r\n        py: { xs: 4, md: 6 },\r\n        mt: 'auto',\r\n      }}\r\n    >\r\n      <Container maxWidth=\"lg\">\r\n        <Grid container spacing={4}>\r\n          {/* Quick Links */}\r\n          <Grid item xs={12} sm={6} md={3}>\r\n            <Typography variant=\"h6\" gutterBottom sx={{ fontWeight: 600 }}>\r\n              Бързи връзки\r\n            </Typography>\r\n            {quickLinks.map((link) => (\r\n              <Link\r\n                key={link.title}\r\n                component={RouterLink}\r\n                to={link.path}\r\n                color=\"inherit\"\r\n                sx={{\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  mb: 1,\r\n                  textDecoration: 'none',\r\n                  transition: 'all 0.2s ease-in-out',\r\n                  '&:hover': {\r\n                    color: 'secondary.light',\r\n                    transform: 'translateX(8px)',\r\n                  },\r\n                }}\r\n              >\r\n                {link.title}\r\n              </Link>\r\n            ))}\r\n          </Grid>\r\n\r\n          {/* Categories */}\r\n          <Grid item xs={12} sm={6} md={3}>\r\n            <Typography variant=\"h6\" gutterBottom sx={{ fontWeight: 600 }}>\r\n              Категории\r\n            </Typography>\r\n            {categories.map((category) => (\r\n              <Link\r\n                key={category.name}\r\n                component={RouterLink}\r\n                to={`/search?category=${encodeURIComponent(category.name)}`}\r\n                color=\"inherit\"\r\n                sx={{\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  mb: 1,\r\n                  textDecoration: 'none',\r\n                  transition: 'all 0.2s ease-in-out',\r\n                  '&:hover': {\r\n                    color: 'secondary.light',\r\n                    transform: 'translateX(8px)',\r\n                  },\r\n                }}\r\n              >\r\n                {category.name}\r\n              </Link>\r\n            ))}\r\n          </Grid>\r\n\r\n          {/* Contact Info */}\r\n          <Grid item xs={12} sm={6} md={3}>\r\n            <Typography variant=\"h6\" gutterBottom sx={{ fontWeight: 600 }}>\r\n              Контакти\r\n            </Typography>\r\n            <Box sx={{ mb: 2 }}>\r\n              <Link\r\n                href=\"mailto:stilianmihnev@gmail.com\"\r\n                color=\"inherit\"\r\n                sx={{\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  mb: 1,\r\n                  textDecoration: 'none',\r\n                  '&:hover': { color: 'secondary.light' },\r\n                }}\r\n              >\r\n                <EmailIcon sx={{ mr: 1 }} />\r\n                stilianmihnev@gmail.com\r\n              </Link>\r\n              <Link\r\n                href=\"tel:+359888123456\"\r\n                color=\"inherit\"\r\n                sx={{\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  mb: 1,\r\n                  textDecoration: 'none',\r\n                  '&:hover': { color: 'secondary.light' },\r\n                }}\r\n              >\r\n                <PhoneIcon sx={{ mr: 1 }} />\r\n                +359 888 123 456\r\n              </Link>\r\n              <Box \r\n                sx={{ \r\n                  display: 'flex', \r\n                  alignItems: 'center',\r\n                  transition: 'all 0.2s ease-in-out',\r\n                  '&:hover': {\r\n                    color: 'secondary.light',\r\n                    transform: 'translateX(8px)',\r\n                  },\r\n                }}\r\n              >\r\n                <LocationOnIcon sx={{ mr: 1 }} />\r\n                <Typography variant=\"body2\">\r\n                  Сливен, България\r\n                </Typography>\r\n              </Box>\r\n            </Box>\r\n          </Grid>\r\n\r\n          {/* Legal Links */}\r\n          <Grid item xs={12} sm={6} md={3}>\r\n            <Typography variant=\"h6\" gutterBottom sx={{ fontWeight: 600 }}>\r\n              Правна информация\r\n            </Typography>\r\n            {legalLinks.map((link) => (\r\n              <Link\r\n                key={link.title}\r\n                component={RouterLink}\r\n                to={link.path}\r\n                color=\"inherit\"\r\n                sx={{\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  mb: 1,\r\n                  textDecoration: 'none',\r\n                  transition: 'all 0.2s ease-in-out',\r\n                  '&:hover': {\r\n                    color: 'secondary.light',\r\n                    transform: 'translateX(8px)',\r\n                  },\r\n                }}\r\n              >\r\n                {link.title}\r\n              </Link>\r\n            ))}\r\n          </Grid>\r\n        </Grid>\r\n\r\n        <Divider sx={{ my: 4, borderColor: 'rgba(255, 255, 255, 0.1)' }} />\r\n\r\n        <Typography variant=\"body2\" align=\"center\" sx={{ opacity: 0.8 }}>\r\n          © {new Date().getFullYear()} Zero-Waste Swap Platform. Всички права запазени.\r\n        </Typography>\r\n      </Container>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default Footer; ","import { useContext } from 'react';\r\nimport { AuthContext } from '../contexts/AuthContext';\r\n\r\nexport function useAuth() {\r\n  const context = useContext(AuthContext);\r\n  if (context === undefined) {\r\n    throw new Error('useAuth трябва да се използва в AuthProvider');\r\n  }\r\n  return context;\r\n} ","import { useState, useEffect } from 'react';\r\nimport { collection, doc, setDoc, deleteDoc, onSnapshot, query, where, serverTimestamp, getDoc } from 'firebase/firestore';\r\nimport { db } from '../config/firebase';\r\nimport { useAuth } from './useAuth';\r\n\r\nexport const useFavorites = () => {\r\n  const { user } = useAuth();\r\n  const [favorites, setFavorites] = useState<string[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!user) {\r\n      setFavorites([]);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    const favoritesRef = collection(db, 'favorites');\r\n    const q = query(favoritesRef, where('userId', '==', user.uid));\r\n\r\n    const unsubscribe = onSnapshot(q, \r\n      (snapshot) => {\r\n        const favoriteIds = snapshot.docs.map(doc => String(doc.data().listingId));\r\n        setFavorites(favoriteIds);\r\n        setLoading(false);\r\n      },\r\n      (error) => {\r\n        console.error('Error loading favorites:', error);\r\n        setError('Грешка при зареждане на любими');\r\n        setLoading(false);\r\n      }\r\n    );\r\n\r\n    return () => unsubscribe();\r\n  }, [user]);\r\n\r\n  const toggleFavorite = async (listingId: string | number) => {\r\n    if (!user) {\r\n      setError('Моля, влезте в системата, за да добавите в любими');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const listingIdStr = String(listingId);\r\n      const favoriteId = `${user.uid}_${listingIdStr}`;\r\n      const favoriteRef = doc(db, 'favorites', favoriteId);\r\n      \r\n      if (favorites.includes(listingIdStr)) {\r\n        await deleteDoc(favoriteRef);\r\n      } else {\r\n        // For demo listings, we don't need to check if the listing exists\r\n        if (!listingIdStr.startsWith('demo_')) {\r\n          // Check if the listing exists in Firestore\r\n          const listingRef = doc(db, 'listings', listingIdStr);\r\n          const listingDoc = await getDoc(listingRef);\r\n          \r\n          if (!listingDoc.exists()) {\r\n            setError('Обявата не съществува');\r\n            return;\r\n          }\r\n        }\r\n\r\n        const favoriteData = {\r\n          userId: user.uid,\r\n          listingId: listingIdStr,\r\n          createdAt: serverTimestamp(),\r\n          id: favoriteId\r\n        };\r\n        await setDoc(favoriteRef, favoriteData, { merge: true });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error toggling favorite:', error);\r\n      setError('Грешка при обновяване на любими');\r\n    }\r\n  };\r\n\r\n  const isFavorite = (listingId: string | number) => {\r\n    return favorites.includes(String(listingId));\r\n  };\r\n\r\n  return {\r\n    favorites,\r\n    loading,\r\n    error,\r\n    toggleFavorite,\r\n    isFavorite\r\n  };\r\n}; ","import React from 'react';\r\nimport { Box, keyframes } from '@mui/material';\r\n\r\nconst fadeIn = keyframes`\r\n  from {\r\n    opacity: 0;\r\n    transform: translateY(20px);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: translateY(0);\r\n  }\r\n`;\r\n\r\nconst slideIn = keyframes`\r\n  from {\r\n    opacity: 0;\r\n    transform: translateX(-20px);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: translateX(0);\r\n  }\r\n`;\r\n\r\nconst scaleIn = keyframes`\r\n  from {\r\n    opacity: 0;\r\n    transform: scale(0.95);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: scale(1);\r\n  }\r\n`;\r\n\r\ninterface AnimatedPageProps {\r\n  children: React.ReactNode;\r\n  animation?: 'fade' | 'slide' | 'scale';\r\n  delay?: number;\r\n}\r\n\r\nconst AnimatedPage: React.FC<AnimatedPageProps> = ({ \r\n  children, \r\n  animation = 'fade',\r\n  delay = 0 \r\n}) => {\r\n  const getAnimation = () => {\r\n    switch (animation) {\r\n      case 'fade':\r\n        return fadeIn;\r\n      case 'slide':\r\n        return slideIn;\r\n      case 'scale':\r\n        return scaleIn;\r\n      default:\r\n        return fadeIn;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Box\r\n      sx={{\r\n        animation: `${getAnimation()} 0.5s ease-out ${delay}s forwards`,\r\n        opacity: 0,\r\n      }}\r\n    >\r\n      {children}\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default AnimatedPage; ","import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n  Box,\r\n  Container,\r\n  Typography,\r\n  Grid,\r\n  Card,\r\n  CardContent,\r\n  CardMedia,\r\n  IconButton,\r\n  useTheme,\r\n  Chip,\r\n  CircularProgress,\r\n  Alert,\r\n} from '@mui/material';\r\nimport FavoriteIcon from '@mui/icons-material/Favorite';\r\nimport FavoriteBorderIcon from '@mui/icons-material/FavoriteBorder';\r\nimport LocationOnIcon from '@mui/icons-material/LocationOn';\r\nimport ChatIcon from '@mui/icons-material/Chat';\r\nimport { useAnalytics } from '../components/AnalyticsProvider';\r\nimport {\r\n  heroImage,\r\n  vegetablesImage,\r\n  shoppingBagsImage,\r\n  shoesImage,\r\n  coffeeMakerImage,\r\n  jacketImage,\r\n  boardGamesImage,\r\n  yogaMatImage,\r\n  blenderImage,\r\n  childrenBooksImage,\r\n  gardenToolsImage,\r\n  laptopStandImage,\r\n  bicycleImage,\r\n  artSuppliesImage,\r\n  deskLampImage,\r\n  laptopImage,\r\n  clothesImage,\r\n  electronicsImage,\r\n  booksImage,\r\n  furnitureImage,\r\n  toysImage,\r\n  sportsImage,\r\n} from '../assets/placeholders';\r\nimport SearchBar from '../components/SearchBar';\r\nimport Footer from '../components/Footer';\r\nimport { collection, query, orderBy, limit, getDocs } from 'firebase/firestore';\r\nimport { db } from '../config/firebase';\r\nimport { useFavorites } from '../hooks/useFavorites';\r\nimport { useAuth } from '../hooks/useAuth';\r\nimport AnimatedPage from '../components/AnimatedPage';\r\nimport { useChat } from '../contexts/ChatContext';\r\n\r\ninterface Listing {\r\n  id: string;\r\n  title: string;\r\n  description: string;\r\n  category: string;\r\n  condition: string;\r\n  images: string[];\r\n  userEmail: string;\r\n  userName: string;\r\n  createdAt: Date;\r\n  location: {\r\n    address: string;\r\n    latitude: number;\r\n    longitude: number;\r\n  };\r\n  userId: string;\r\n  user: {\r\n    _id: string;\r\n    username: string;\r\n    email: string;\r\n  };\r\n}\r\n\r\nconst Home: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const theme = useTheme();\r\n  const { logPageView } = useAnalytics();\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [recentListings, setRecentListings] = useState<Listing[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const { favorites, toggleFavorite } = useFavorites();\r\n  const { user, token } = useAuth();\r\n  const { setCurrentChat } = useChat();\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [startingChat, setStartingChat] = useState<string | null>(null);\r\n\r\n  const categories = [\r\n    { id: 'clothing', name: 'Дрехи', image: clothesImage },\r\n    { id: 'electronics', name: 'Електроника', image: electronicsImage },\r\n    { id: 'books', name: 'Книги', image: booksImage },\r\n    { id: 'furniture', name: 'Мебели', image: furnitureImage },\r\n    { id: 'toys', name: 'Играчки', image: toysImage },\r\n    { id: 'sports', name: 'Спорт', image: sportsImage },\r\n  ];\r\n\r\n  useEffect(() => {\r\n    logPageView('home');\r\n    fetchRecentListings();\r\n  }, [logPageView]);\r\n\r\n  const fetchRecentListings = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      // Check if user is authenticated\r\n      if (!user) {\r\n        console.log('User not authenticated, fetching public listings');\r\n      }\r\n\r\n      const q = query(\r\n        collection(db, 'listings'),\r\n        orderBy('createdAt', 'desc'),\r\n        limit(8)\r\n      );\r\n\r\n      const querySnapshot = await getDocs(q);\r\n      const listings = querySnapshot.docs.map(doc => {\r\n        const data = doc.data();\r\n        console.log('Raw listing data:', data); // Debug log\r\n        \r\n        // Get the user ID from the document path or data\r\n        const userId = data.userId || doc.ref.parent.parent?.id;\r\n        \r\n        if (!userId) {\r\n          console.warn('Listing missing userId:', doc.id);\r\n          console.log('Listing data:', data);\r\n          // If no userId is found, we can't create a chat, so skip this listing\r\n          return null;\r\n        }\r\n\r\n        // Ensure all required fields are present\r\n        const listing = {\r\n          id: doc.id,\r\n          title: data.title || 'Untitled',\r\n          description: data.description || '',\r\n          category: data.category || 'other',\r\n          condition: data.condition || 'good',\r\n          images: Array.isArray(data.images) ? data.images : [],\r\n          userEmail: data.userEmail || data.email || '',\r\n          userName: data.userName || data.firstName || 'Anonymous',\r\n          createdAt: data.createdAt?.toDate() || new Date(),\r\n          location: data.location || {\r\n            address: '',\r\n            latitude: 0,\r\n            longitude: 0\r\n          },\r\n          userId: userId,\r\n          user: {\r\n            _id: userId,\r\n            username: data.userName || data.firstName || 'Anonymous',\r\n            email: data.userEmail || data.email || ''\r\n          }\r\n        };\r\n\r\n        console.log('Processed listing:', listing); // Debug log\r\n        return listing;\r\n      }).filter(listing => listing !== null); // Filter out listings without userId\r\n\r\n      console.log('Fetched listings:', listings); // Debug log\r\n      setRecentListings(listings);\r\n    } catch (error) {\r\n      console.error('Error fetching recent listings:', error);\r\n      if (error instanceof Error) {\r\n        setError(`Възникна грешка при зареждане на обявите: ${error.message}`);\r\n      } else {\r\n        setError('Възникна грешка при зареждане на обявите');\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSearch = () => {\r\n    navigate(`/search?q=${encodeURIComponent(searchQuery)}`);\r\n  };\r\n\r\n  const handleSearchQueryChange = (value: string) => {\r\n    setSearchQuery(value);\r\n  };\r\n\r\n  const handleCategoryClick = (categoryId: string) => {\r\n    navigate(`/search?category=${categoryId}`);\r\n  };\r\n\r\n  const handleListingClick = (listing: any, isDemoListing: boolean = false) => {\r\n    const listingId = isDemoListing ? `demo_${listing.id}` : listing.id;\r\n    const formattedListing = isDemoListing ? {\r\n      id: listingId,\r\n      ...listing,\r\n      images: [listing.image],\r\n      location: {\r\n        address: listing.location,\r\n        latitude: 0,\r\n        longitude: 0\r\n      },\r\n      userId: 'demo',\r\n      userName: 'Demo User',\r\n      userEmail: 'demo@example.com',\r\n      createdAt: new Date(),\r\n      updatedAt: new Date(),\r\n      condition: 'good',\r\n      status: 'active' as const\r\n    } : listing;\r\n\r\n    navigate(`/listing/${listingId}`, {\r\n      state: { listing: formattedListing }\r\n    });\r\n  };\r\n\r\n  const handleFavoriteClick = async (e: React.MouseEvent, listingId: string) => {\r\n    e.stopPropagation();\r\n    if (user) {\r\n      await toggleFavorite(listingId);\r\n    } else {\r\n      navigate('/login');\r\n    }\r\n  };\r\n\r\n  const handleStartChat = async (e: React.MouseEvent, listing: any) => {\r\n    e.stopPropagation();\r\n    if (!user || !token) {\r\n      navigate('/login');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setStartingChat(listing.id);\r\n      const apiUrl = process.env.VITE_API_URL || 'http://localhost:3001';\r\n      console.log('Starting chat with API URL:', apiUrl);\r\n      console.log('Listing data:', listing);\r\n      \r\n      // Get the participant's Firebase UID\r\n      const participantId = listing.userId || listing.user?._id;\r\n      console.log('Participant ID:', participantId);\r\n      console.log('Current user ID:', user.uid);\r\n      \r\n      if (!participantId) {\r\n        console.error('Missing participant ID in listing:', listing);\r\n        throw new Error('Cannot start chat: User ID not found in listing data');\r\n      }\r\n\r\n      if (participantId === user.uid) {\r\n        throw new Error('Не можете да започнете чат със себе си!');\r\n      }\r\n\r\n      const response = await fetch(`${apiUrl}/api/chats`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${token}`\r\n        },\r\n        body: JSON.stringify({ participantId })\r\n      });\r\n\r\n      console.log('Chat creation response status:', response.status);\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({}));\r\n        console.error('Chat creation error:', errorData);\r\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      const chat = await response.json();\r\n      console.log('Chat created successfully:', chat);\r\n      setCurrentChat(chat);\r\n      navigate('/chat');\r\n    } catch (error) {\r\n      console.error('Error starting chat:', error);\r\n      setError(error instanceof Error ? error.message : 'Failed to start chat. Please try again.');\r\n    } finally {\r\n      setStartingChat(null);\r\n    }\r\n  };\r\n\r\n  const renderListingCard = (listing: any, isDemoListing: boolean = false) => {\r\n    const listingId = isDemoListing ? `demo_${listing.id}` : listing.id;\r\n    const isFavorite = favorites.includes(listingId);\r\n    const images = isDemoListing ? [listing.image] : listing.images;\r\n    const isStartingChat = startingChat === listingId;\r\n\r\n    // Safely handle location data\r\n    let locationText = 'Location not specified';\r\n    if (isDemoListing && listing.location) {\r\n      locationText = listing.location;\r\n    } else if (listing.location) {\r\n      locationText = typeof listing.location === 'string'\r\n        ? listing.location\r\n        : listing.location.address || 'Location not specified';\r\n    }\r\n\r\n    return (\r\n      <Card\r\n        key={`card-${listingId}`}\r\n        sx={{\r\n          height: '100%',\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n          cursor: 'pointer',\r\n          transition: 'all 0.2s ease-in-out',\r\n          '&:hover': {\r\n            transform: 'translateY(-4px)',\r\n            boxShadow: theme.shadows[4]\r\n          }\r\n        }}\r\n        onClick={() => handleListingClick(listing, isDemoListing)}\r\n      >\r\n        <Box sx={{ position: 'relative' }}>\r\n          <CardMedia\r\n            component=\"img\"\r\n            height=\"200\"\r\n            image={images?.[0] || '/placeholder-image.jpg'}\r\n            alt={listing.title}\r\n            sx={{ objectFit: 'cover' }}\r\n          />\r\n          <Box sx={{ position: 'absolute', top: 8, right: 8, display: 'flex', gap: 1 }}>\r\n            <IconButton\r\n              key={`favorite-${listingId}`}\r\n              size=\"small\"\r\n              sx={{\r\n                backgroundColor: 'rgba(255, 255, 255, 0.8)',\r\n                '&:hover': {\r\n                  backgroundColor: 'rgba(255, 255, 255, 0.9)',\r\n                },\r\n              }}\r\n              onClick={(e) => handleFavoriteClick(e, listingId)}\r\n            >\r\n              {isFavorite ? (\r\n                <FavoriteIcon color=\"error\" />\r\n              ) : (\r\n                <FavoriteBorderIcon />\r\n              )}\r\n            </IconButton>\r\n            {!isDemoListing && (\r\n              <IconButton\r\n                key={`chat-${listingId}`}\r\n                size=\"small\"\r\n                sx={{\r\n                  backgroundColor: 'rgba(255, 255, 255, 0.8)',\r\n                  '&:hover': {\r\n                    backgroundColor: 'rgba(255, 255, 255, 0.9)',\r\n                  },\r\n                }}\r\n                onClick={(e) => handleStartChat(e, listing)}\r\n                disabled={isStartingChat || !user}\r\n              >\r\n                {isStartingChat ? (\r\n                  <CircularProgress size={20} />\r\n                ) : (\r\n                  <ChatIcon color={user ? 'primary' : 'disabled'} />\r\n                )}\r\n              </IconButton>\r\n            )}\r\n          </Box>\r\n        </Box>\r\n        <CardContent sx={{ flexGrow: 1 }}>\r\n          <Typography variant=\"h6\" component=\"h2\" gutterBottom>\r\n            {listing.title}\r\n          </Typography>\r\n          <Typography\r\n            variant=\"body2\"\r\n            color=\"text.secondary\"\r\n            sx={{\r\n              overflow: 'hidden',\r\n              textOverflow: 'ellipsis',\r\n              display: '-webkit-box',\r\n              WebkitLineClamp: 2,\r\n              WebkitBoxOrient: 'vertical',\r\n              mb: 2\r\n            }}\r\n          >\r\n            {listing.description}\r\n          </Typography>\r\n          <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>\r\n            <LocationOnIcon fontSize=\"small\" color=\"action\" sx={{ mr: 0.5 }} />\r\n            <Typography variant=\"body2\" color=\"text.secondary\">\r\n              {locationText}\r\n            </Typography>\r\n          </Box>\r\n          {!isDemoListing && listing.category && (\r\n            <Box sx={{ display: 'flex', gap: 1, mt: 1 }}>\r\n              <Chip key={`category-${listingId}`} label={listing.category} size=\"small\" color=\"primary\" variant=\"outlined\" />\r\n              {listing.condition && (\r\n                <Chip key={`condition-${listingId}`} label={listing.condition} size=\"small\" color=\"secondary\" variant=\"outlined\" />\r\n              )}\r\n            </Box>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  };\r\n\r\n  const featuredListings = [\r\n    {\r\n      id: 1,\r\n      title: 'Organic Vegetables',\r\n      description: 'Fresh organic vegetables from our garden, including tomatoes, cucumbers, and leafy greens',\r\n      image: vegetablesImage,\r\n      location: 'Sofia, Bulgaria',\r\n      category: 'Food',\r\n    },\r\n    {\r\n      id: 2,\r\n      title: 'Reusable Shopping Bags',\r\n      description: 'Set of 5 eco-friendly shopping bags made from recycled materials, durable and washable',\r\n      image: shoppingBagsImage,\r\n      location: 'Plovdiv, Bulgaria',\r\n      category: 'Accessories',\r\n    },\r\n    {\r\n      id: 3,\r\n      title: 'Kitchen Set',\r\n      description: 'Complete kitchen set including pots, pans, and utensils, lightly used',\r\n      image: blenderImage,\r\n      location: 'Varna, Bulgaria',\r\n      category: 'Other',\r\n    },\r\n    {\r\n      id: 4,\r\n      title: 'Running Shoes',\r\n      description: 'Nike running shoes, size EU 42, gently used, perfect for beginners',\r\n      image: shoesImage,\r\n      location: 'Burgas, Bulgaria',\r\n      category: 'Clothing',\r\n    },\r\n    {\r\n      id: 5,\r\n      title: 'Coffee Maker',\r\n      description: 'Philips coffee maker, 1.5L capacity, used for 6 months, works perfectly',\r\n      image: coffeeMakerImage,\r\n      location: 'Ruse, Bulgaria',\r\n      category: 'Electronics',\r\n    },\r\n    {\r\n      id: 6,\r\n      title: 'Winter Jacket',\r\n      description: 'Women\\'s winter jacket, size M, water-resistant, excellent condition',\r\n      image: jacketImage,\r\n      location: 'Sofia, Bulgaria',\r\n      category: 'Clothing',\r\n    },\r\n    {\r\n      id: 7,\r\n      title: 'Board Games Collection',\r\n      description: 'Collection of popular board games including Monopoly, Scrabble, and Chess',\r\n      image: boardGamesImage,\r\n      location: 'Plovdiv, Bulgaria',\r\n      category: 'Entertainment',\r\n    },\r\n    {\r\n      id: 8,\r\n      title: 'Yoga Mat',\r\n      description: 'Eco-friendly yoga mat made from natural rubber, 4mm thickness, barely used',\r\n      image: yogaMatImage,\r\n      location: 'Varna, Bulgaria',\r\n      category: 'Sports',\r\n    },\r\n    {\r\n      id: 9,\r\n      title: 'Blender',\r\n      description: 'High-speed blender perfect for smoothies and soups, 800W power',\r\n      image: blenderImage,\r\n      location: 'Burgas, Bulgaria',\r\n      category: 'Appliances',\r\n    },\r\n    {\r\n      id: 10,\r\n      title: 'Children\\'s Books',\r\n      description: 'Collection of 15 children\\'s books in excellent condition, suitable for ages 5-8',\r\n      image: childrenBooksImage,\r\n      location: 'Sofia, Bulgaria',\r\n      category: 'Books',\r\n    },\r\n    {\r\n      id: 11,\r\n      title: 'Garden Tools Set',\r\n      description: 'Complete set of garden tools including shovel, rake, and pruning shears',\r\n      image: gardenToolsImage,\r\n      location: 'Stara Zagora, Bulgaria',\r\n      category: 'Tools',\r\n    },\r\n    {\r\n      id: 12,\r\n      title: 'Laptop Stand',\r\n      description: 'Adjustable aluminum laptop stand, ergonomic design, foldable',\r\n      image: laptopStandImage,\r\n      location: 'Veliko Tarnovo, Bulgaria',\r\n      category: 'Electronics',\r\n    },\r\n    {\r\n      id: 13,\r\n      title: 'Bicycle',\r\n      description: 'Mountain bike in good condition, 26\" wheels, recently serviced',\r\n      image: bicycleImage,\r\n      location: 'Sofia, Bulgaria',\r\n      category: 'Sports',\r\n    },\r\n    {\r\n      id: 14,\r\n      title: 'Art Supplies',\r\n      description: 'Set of acrylic paints, brushes, and canvas boards, perfect for beginners',\r\n      image: artSuppliesImage,\r\n      location: 'Plovdiv, Bulgaria',\r\n      category: 'Hobbies',\r\n    },\r\n    {\r\n      id: 15,\r\n      title: 'Desk Lamp',\r\n      description: 'LED desk lamp with adjustable brightness and color temperature',\r\n      image: deskLampImage,\r\n      location: 'Varna, Bulgaria',\r\n      category: 'Electronics',\r\n    },\r\n    {\r\n      id: 16,\r\n      title: 'Laptop',\r\n      description: 'Apple MacBook Pro 16\" M3 Pro 512GB Space Black',\r\n      image: laptopImage,\r\n      location: 'Sliven, Bulgaria',\r\n      category: 'Electronics',\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <AnimatedPage animation=\"fade\">\r\n      <Box>\r\n        {/* Hero Section */}\r\n        <Box\r\n          sx={{\r\n            position: 'relative',\r\n            height: '100vh',\r\n            minHeight: 600,\r\n            backgroundImage: `url(${heroImage})`,\r\n            backgroundSize: 'cover',\r\n            backgroundPosition: 'center',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            '&::before': {\r\n              content: '\"\"',\r\n              position: 'absolute',\r\n              top: 0,\r\n              left: 0,\r\n              right: 0,\r\n              bottom: 0,\r\n              background: 'linear-gradient(to bottom, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0.6) 100%)',\r\n            },\r\n          }}\r\n        >\r\n          <Container maxWidth=\"md\" sx={{ position: 'relative', zIndex: 1 }}>\r\n            <AnimatedPage animation=\"fade\" delay={0.2}>\r\n              <Typography\r\n                variant=\"h2\"\r\n                component=\"h1\"\r\n                align=\"center\"\r\n                color=\"white\"\r\n                sx={{\r\n                  mb: 2,\r\n                  fontWeight: 'bold',\r\n                  textShadow: '2px 2px 4px rgba(0,0,0,0.5)',\r\n                }}\r\n              >\r\n                Споделете. Обновете. Пазете природата.\r\n              </Typography>\r\n              <Typography\r\n                variant=\"h4\"\r\n                align=\"center\"\r\n                color=\"white\"\r\n                sx={{\r\n                  mb: 4,\r\n                  textShadow: '1px 1px 3px rgba(0,0,0,0.5)',\r\n                  fontWeight: 300,\r\n                }}\r\n              >\r\n                Вашите вещи заслужават втори шанс\r\n              </Typography>\r\n            </AnimatedPage>\r\n            <AnimatedPage animation=\"fade\" delay={0.4}>\r\n              <SearchBar\r\n                value={searchQuery}\r\n                onChange={handleSearchQueryChange}\r\n                onSearch={handleSearch}\r\n                placeholder=\"Намерете подходящият за вас продукт...\"\r\n              />\r\n            </AnimatedPage>\r\n          </Container>\r\n        </Box>\r\n\r\n        {/* Rest of the content */}\r\n        <Box sx={{ mt: -8, position: 'relative', zIndex: 2, bgcolor: 'background.paper' }}>\r\n          {/* Categories Section */}\r\n          <Container maxWidth=\"lg\" sx={{ py: 8 }}>\r\n            <AnimatedPage animation=\"slide\" delay={0.6}>\r\n              <Typography\r\n                variant=\"h4\"\r\n                component=\"h2\"\r\n                gutterBottom\r\n                align=\"center\"\r\n                sx={{\r\n                  mb: 6,\r\n                  position: 'relative',\r\n                  '&::after': {\r\n                    content: '\"\"',\r\n                    position: 'absolute',\r\n                    bottom: -8,\r\n                    left: '50%',\r\n                    transform: 'translateX(-50%)',\r\n                    width: 60,\r\n                    height: 4,\r\n                    bgcolor: 'primary.main',\r\n                    borderRadius: 2,\r\n                  },\r\n                }}\r\n              >\r\n                Категории\r\n              </Typography>\r\n            </AnimatedPage>\r\n            <Grid container spacing={4}>\r\n              {categories.map((category, index) => (\r\n                <Grid item xs={12} sm={6} md={4} key={category.id}>\r\n                  <AnimatedPage animation=\"scale\" delay={0.8 + index * 0.1}>\r\n                    <Card\r\n                      sx={{\r\n                        height: '100%',\r\n                        display: 'flex',\r\n                        flexDirection: 'column',\r\n                        cursor: 'pointer',\r\n                        transition: 'all 0.2s ease-in-out',\r\n                        '&:hover': {\r\n                          transform: 'translateY(-4px)',\r\n                          boxShadow: theme.shadows[4],\r\n                        },\r\n                      }}\r\n                      onClick={() => handleCategoryClick(category.id)}\r\n                    >\r\n                      <CardMedia\r\n                        component=\"img\"\r\n                        height=\"140\"\r\n                        image={category.image}\r\n                        alt={category.name}\r\n                        sx={{ objectFit: 'cover' }}\r\n                      />\r\n                      <CardContent sx={{ flexGrow: 1 }}>\r\n                        <Typography gutterBottom variant=\"h6\" component=\"div\" align=\"center\">\r\n                          {category.name}\r\n                        </Typography>\r\n                      </CardContent>\r\n                    </Card>\r\n                  </AnimatedPage>\r\n                </Grid>\r\n              ))}\r\n            </Grid>\r\n          </Container>\r\n\r\n          {/* Featured Listings */}\r\n          <Container maxWidth=\"lg\" sx={{ py: 8 }}>\r\n            <AnimatedPage animation=\"slide\" delay={0.6}>\r\n              <Typography\r\n                variant=\"h4\"\r\n                component=\"h2\"\r\n                gutterBottom\r\n                align=\"center\"\r\n                sx={{\r\n                  mb: 6,\r\n                  position: 'relative',\r\n                  '&::after': {\r\n                    content: '\"\"',\r\n                    position: 'absolute',\r\n                    bottom: -8,\r\n                    left: '50%',\r\n                    transform: 'translateX(-50%)',\r\n                    width: 60,\r\n                    height: 4,\r\n                    bgcolor: 'primary.main',\r\n                    borderRadius: 2,\r\n                  },\r\n                }}\r\n              >\r\n                Представени обяви\r\n              </Typography>\r\n            </AnimatedPage>\r\n            <Grid container spacing={4} sx={{ mt: 2 }}>\r\n              {featuredListings.map((listing) => (\r\n                <Grid item xs={12} sm={6} md={4} key={`featured-${listing.id}`}>\r\n                  {renderListingCard(listing, true)}\r\n                </Grid>\r\n              ))}\r\n            </Grid>\r\n          </Container>\r\n\r\n          {/* Recent Listings */}\r\n          <Container maxWidth=\"lg\" sx={{ py: 8 }}>\r\n            <AnimatedPage animation=\"slide\" delay={0.6}>\r\n              <Typography\r\n                variant=\"h4\"\r\n                component=\"h2\"\r\n                gutterBottom\r\n                align=\"center\"\r\n                sx={{\r\n                  mb: 6,\r\n                  position: 'relative',\r\n                  '&::after': {\r\n                    content: '\"\"',\r\n                    position: 'absolute',\r\n                    bottom: -8,\r\n                    left: '50%',\r\n                    transform: 'translateX(-50%)',\r\n                    width: 60,\r\n                    height: 4,\r\n                    bgcolor: 'primary.main',\r\n                    borderRadius: 2,\r\n                  },\r\n                }}\r\n              >\r\n                Последни обяви\r\n              </Typography>\r\n            </AnimatedPage>\r\n            {loading ? (\r\n              <Box sx={{ display: 'flex', justifyContent: 'center', py: 4 }}>\r\n                <CircularProgress />\r\n              </Box>\r\n            ) : error ? (\r\n              <Alert severity=\"error\" sx={{ mt: 2 }}>\r\n                {error}\r\n              </Alert>\r\n            ) : recentListings.length === 0 ? (\r\n              <Alert severity=\"info\" sx={{ mt: 2 }}>\r\n                Все още няма обяви\r\n              </Alert>\r\n            ) : (\r\n              <Grid container spacing={4} sx={{ mt: 2 }}>\r\n                {recentListings.map((listing) => (\r\n                  <Grid item xs={12} sm={6} md={4} key={`recent-${listing.id}`}>\r\n                    {renderListingCard(listing)}\r\n                  </Grid>\r\n                ))}\r\n              </Grid>\r\n            )}\r\n          </Container>\r\n\r\n          {/* How It Works Section */}\r\n          <Box sx={{ bgcolor: 'background.paper', py: 8 }}>\r\n            <Container maxWidth=\"lg\">\r\n              <AnimatedPage animation=\"slide\" delay={0.6}>\r\n                <Typography\r\n                  variant=\"h4\"\r\n                  component=\"h2\"\r\n                  gutterBottom\r\n                  align=\"center\"\r\n                  sx={{\r\n                    mb: 6,\r\n                    position: 'relative',\r\n                    '&::after': {\r\n                      content: '\"\"',\r\n                      position: 'absolute',\r\n                      bottom: -8,\r\n                      left: '50%',\r\n                      transform: 'translateX(-50%)',\r\n                      width: 60,\r\n                      height: 4,\r\n                      bgcolor: 'primary.main',\r\n                      borderRadius: 2,\r\n                    },\r\n                  }}\r\n                >\r\n                  Как работи?\r\n                </Typography>\r\n              </AnimatedPage>\r\n              <Grid container spacing={4} sx={{ mt: 2 }}>\r\n                <Grid item xs={12} md={4}>\r\n                  <AnimatedPage animation=\"scale\" delay={0.8}>\r\n                    <Box sx={{ textAlign: 'center' }}>\r\n                      <Typography variant=\"h6\" gutterBottom>\r\n                        1. Създайте обява\r\n                      </Typography>\r\n                      <Typography variant=\"body1\" color=\"text.secondary\">\r\n                        Качете снимки и описание на предмета, който искате да обменяте\r\n                      </Typography>\r\n                    </Box>\r\n                  </AnimatedPage>\r\n                </Grid>\r\n                <Grid item xs={12} md={4}>\r\n                  <AnimatedPage animation=\"scale\" delay={1.0}>\r\n                    <Box sx={{ textAlign: 'center' }}>\r\n                      <Typography variant=\"h6\" gutterBottom>\r\n                        2. Намерете подходящ обмен\r\n                      </Typography>\r\n                      <Typography variant=\"body1\" color=\"text.secondary\">\r\n                        Разгледайте обявите и намерете нещо, което ви интересува\r\n                      </Typography>\r\n                    </Box>\r\n                  </AnimatedPage>\r\n                </Grid>\r\n                <Grid item xs={12} md={4}>\r\n                  <AnimatedPage animation=\"scale\" delay={1.2}>\r\n                    <Box sx={{ textAlign: 'center' }}>\r\n                      <Typography variant=\"h6\" gutterBottom>\r\n                        3. Договорете обмен\r\n                      </Typography>\r\n                      <Typography variant=\"body1\" color=\"text.secondary\">\r\n                        Свържете се с продавача и договорете детайлите на обмена\r\n                      </Typography>\r\n                    </Box>\r\n                  </AnimatedPage>\r\n                </Grid>\r\n              </Grid>\r\n            </Container>\r\n          </Box>\r\n        </Box>\r\n      </Box>\r\n      <Footer />\r\n    </AnimatedPage>\r\n  );\r\n};\r\n\r\nexport default Home; ","import React, { useState } from 'react';\r\nimport { useNavigate, Link as RouterLink } from 'react-router-dom';\r\nimport {\r\n  Container,\r\n  Box,\r\n  Typography,\r\n  TextField,\r\n  Button,\r\n  Link,\r\n  Paper,\r\n  Alert,\r\n  CircularProgress,\r\n  Grid,\r\n} from '@mui/material';\r\nimport { useAuth } from '../hooks/useAuth';\r\nimport AnimatedPage from '../components/AnimatedPage';\r\n\r\nconst Login: React.FC = () => {\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const { login, error, clearError } = useAuth();\r\n  const navigate = useNavigate();\r\n\r\n  const validateEmail = (email: string) => {\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    return emailRegex.test(email);\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    clearError();\r\n\r\n    if (!validateEmail(email)) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      await login(email, password);\r\n      navigate('/');\r\n    } catch (err) {\r\n      // Error is already handled by AuthContext\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <AnimatedPage animation=\"fade\">\r\n      <Box sx={{ pt: 8 }}>\r\n        <Container maxWidth=\"sm\">\r\n          <AnimatedPage animation=\"slide\" delay={0.2}>\r\n            <Box sx={{ mb: 4, textAlign: 'center' }}>\r\n              <Typography variant=\"h4\" component=\"h1\" gutterBottom>\r\n                Вход\r\n              </Typography>\r\n              <Typography variant=\"body1\" color=\"text.secondary\" paragraph>\r\n                Влезте в системата, за да продължите\r\n              </Typography>\r\n            </Box>\r\n          </AnimatedPage>\r\n\r\n          <AnimatedPage animation=\"scale\" delay={0.4}>\r\n            <Paper sx={{ p: 4 }}>\r\n              {error && (\r\n                <Alert severity=\"error\" sx={{ mb: 2 }}>\r\n                  {error}\r\n                </Alert>\r\n              )}\r\n              <form onSubmit={handleSubmit}>\r\n                <Grid container spacing={3}>\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Имейл\"\r\n                      value={email}\r\n                      onChange={(e) => setEmail(e.target.value)}\r\n                      required\r\n                      error={!!error}\r\n                      helperText={!!error && !validateEmail(email) ? 'Моля, въведете валиден имейл адрес' : ''}\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Парола\"\r\n                      type=\"password\"\r\n                      value={password}\r\n                      onChange={(e) => setPassword(e.target.value)}\r\n                      required\r\n                      error={!!error}\r\n                      helperText={error}\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <AnimatedPage animation=\"slide\" delay={0.6}>\r\n                      <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2 }}>\r\n                        <Button\r\n                          type=\"submit\"\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          fullWidth\r\n                          disabled={loading}\r\n                        >\r\n                          {loading ? <CircularProgress size={24} /> : 'Вход'}\r\n                        </Button>\r\n                        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                          <Link component={RouterLink} to=\"/register\" variant=\"body2\">\r\n                            Нямате акаунт? Регистрирайте се\r\n                          </Link>\r\n                          <Link component={RouterLink} to=\"/forgot-password\" variant=\"body2\">\r\n                            Забравена парола?\r\n                          </Link>\r\n                        </Box>\r\n                      </Box>\r\n                    </AnimatedPage>\r\n                  </Grid>\r\n                </Grid>\r\n              </form>\r\n            </Paper>\r\n          </AnimatedPage>\r\n        </Container>\r\n      </Box>\r\n    </AnimatedPage>\r\n  );\r\n};\r\n\r\nexport default Login; ","import React, { useState } from 'react';\r\nimport { useNavigate, Link as RouterLink } from 'react-router-dom';\r\nimport {\r\n  Container,\r\n  Box,\r\n  Typography,\r\n  TextField,\r\n  Button,\r\n  Link,\r\n  Paper,\r\n  InputAdornment,\r\n  IconButton,\r\n  CircularProgress,\r\n  Grid,\r\n} from '@mui/material';\r\nimport {\r\n  Visibility,\r\n  VisibilityOff,\r\n} from '@mui/icons-material';\r\nimport { useAuth } from '../hooks/useAuth';\r\nimport AnimatedPage from '../components/AnimatedPage';\r\n\r\nconst Register: React.FC = () => {\r\n  const [formData, setFormData] = useState({\r\n    name: '',\r\n    email: '',\r\n    password: '',\r\n    confirmPassword: '',\r\n  });\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const { register, error, clearError } = useAuth();\r\n  const navigate = useNavigate();\r\n\r\n  const validateEmail = (email: string) => {\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    return emailRegex.test(email);\r\n  };\r\n\r\n  const validatePassword = (password: string) => {\r\n    return password.length >= 8;\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    clearError();\r\n\r\n    // Validate email\r\n    if (!validateEmail(formData.email)) {\r\n      return;\r\n    }\r\n\r\n    // Validate password\r\n    if (!validatePassword(formData.password)) {\r\n      return;\r\n    }\r\n\r\n    // Check if passwords match\r\n    if (formData.password !== formData.confirmPassword) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      await register(formData.email, formData.password, formData.name);\r\n      navigate('/');\r\n    } catch (err) {\r\n      // Error is already handled by AuthContext\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <AnimatedPage animation=\"fade\">\r\n      <Box sx={{ pt: 8 }}>\r\n        <Container maxWidth=\"sm\">\r\n          <AnimatedPage animation=\"slide\" delay={0.2}>\r\n            <Box sx={{ mb: 4, textAlign: 'center' }}>\r\n              <Typography variant=\"h4\" component=\"h1\" gutterBottom>\r\n                Регистрация\r\n              </Typography>\r\n              <Typography variant=\"body1\" color=\"text.secondary\" paragraph>\r\n                Създайте нов акаунт, за да започнете да споделяте\r\n              </Typography>\r\n            </Box>\r\n          </AnimatedPage>\r\n\r\n          <AnimatedPage animation=\"scale\" delay={0.4}>\r\n            <Paper sx={{ p: 4 }}>\r\n              <form onSubmit={handleSubmit}>\r\n                <Grid container spacing={3}>\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Име\"\r\n                      value={formData.name}\r\n                      onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                      required\r\n                      error={!!error && !validateEmail(formData.name)}\r\n                      helperText={!!error && !validateEmail(formData.name) ? 'Моля, въведете валидно име' : ''}\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Имейл\"\r\n                      value={formData.email}\r\n                      onChange={(e) => setFormData({ ...formData, email: e.target.value })}\r\n                      required\r\n                      error={!!error && !validateEmail(formData.email)}\r\n                      helperText={!!error && !validateEmail(formData.email) ? 'Моля, въведете валиден имейл адрес' : ''}\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Парола\"\r\n                      type={showPassword ? 'text' : 'password'}\r\n                      value={formData.password}\r\n                      onChange={(e) => setFormData({ ...formData, password: e.target.value })}\r\n                      required\r\n                      error={!!error && !validatePassword(formData.password)}\r\n                      helperText={!!error && !validatePassword(formData.password) ? 'Паролата трябва да бъде поне 8 символа' : ''}\r\n                      InputProps={{\r\n                        endAdornment: (\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={() => setShowPassword(!showPassword)}\r\n                              edge=\"end\"\r\n                            >\r\n                              {showPassword ? <VisibilityOff /> : <Visibility />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        ),\r\n                      }}\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Потвърди парола\"\r\n                      type={showConfirmPassword ? 'text' : 'password'}\r\n                      value={formData.confirmPassword}\r\n                      onChange={(e) => setFormData({ ...formData, confirmPassword: e.target.value })}\r\n                      required\r\n                      error={!!error && formData.password !== formData.confirmPassword}\r\n                      helperText={!!error && formData.password !== formData.confirmPassword ? 'Паролите не съвпадат' : ''}\r\n                      InputProps={{\r\n                        endAdornment: (\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle confirm password visibility\"\r\n                              onClick={() => setShowConfirmPassword(!showConfirmPassword)}\r\n                              edge=\"end\"\r\n                            >\r\n                              {showConfirmPassword ? <VisibilityOff /> : <Visibility />}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        ),\r\n                      }}\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <AnimatedPage animation=\"slide\" delay={0.6}>\r\n                      <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2 }}>\r\n                        <Button\r\n                          type=\"submit\"\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          fullWidth\r\n                          disabled={loading}\r\n                        >\r\n                          {loading ? <CircularProgress size={24} /> : 'Регистрация'}\r\n                        </Button>\r\n                        <Box sx={{ display: 'flex', justifyContent: 'center' }}>\r\n                          <Link component={RouterLink} to=\"/login\" variant=\"body2\">\r\n                            Вече имате акаунт? Влезте\r\n                          </Link>\r\n                        </Box>\r\n                      </Box>\r\n                    </AnimatedPage>\r\n                  </Grid>\r\n                </Grid>\r\n              </form>\r\n            </Paper>\r\n          </AnimatedPage>\r\n        </Container>\r\n      </Box>\r\n    </AnimatedPage>\r\n  );\r\n};\r\n\r\nexport default Register; ","import { useState, useEffect } from 'react';\r\nimport { collection, query, orderBy, onSnapshot, getDocs, QuerySnapshot, doc, updateDoc, deleteDoc } from 'firebase/firestore';\r\nimport { db } from '../config/firebase';\r\nimport { Listing } from '../types/listing';\r\n\r\nexport const useListings = () => {\r\n  const [listings, setListings] = useState<Listing[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const updateListing = async (id: string, data: Partial<Listing>) => {\r\n    try {\r\n      setError(null);\r\n      const listingRef = doc(db, 'listings', id);\r\n      await updateDoc(listingRef, data);\r\n    } catch (err) {\r\n      setError('Грешка при обновяване на обявата');\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  const deleteListing = async (id: string) => {\r\n    try {\r\n      setError(null);\r\n      const listingRef = doc(db, 'listings', id);\r\n      await deleteDoc(listingRef);\r\n    } catch (err) {\r\n      setError('Грешка при изтриване на обявата');\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    let unsubscribe: (() => void) | undefined;\r\n    let retryCount = 0;\r\n    const maxRetries = 3;\r\n    let isMounted = true;\r\n\r\n    const processSnapshot = (snapshot: QuerySnapshot) => {\r\n      if (!isMounted) return;\r\n      \r\n      const listingsData = snapshot.docs.map((doc) => ({\r\n        id: doc.id,\r\n        ...doc.data(),\r\n        createdAt: doc.data().createdAt?.toDate(),\r\n        updatedAt: doc.data().updatedAt?.toDate(),\r\n      })) as Listing[];\r\n\r\n      setListings(listingsData);\r\n      setLoading(false);\r\n      retryCount = 0; // Reset retry count on successful update\r\n    };\r\n\r\n    const fetchListings = async () => {\r\n      try {\r\n        if (!isMounted) return;\r\n        \r\n        setLoading(true);\r\n        setError(null);\r\n\r\n        const q = query(collection(db, 'listings'), orderBy('createdAt', 'desc'));\r\n\r\n        // First try onSnapshot\r\n        try {\r\n          unsubscribe = onSnapshot(\r\n            q,\r\n            (snapshot) => {\r\n              processSnapshot(snapshot);\r\n            },\r\n            (error) => {\r\n              console.error('onSnapshot error:', error);\r\n              if (retryCount < maxRetries) {\r\n                retryCount++;\r\n                console.log(`Retrying connection (attempt ${retryCount}/${maxRetries})...`);\r\n                setTimeout(fetchListingsWithGetDocs, 1000 * retryCount); // Exponential backoff\r\n              } else {\r\n                fetchListingsWithGetDocs();\r\n              }\r\n            }\r\n          );\r\n        } catch (error) {\r\n          console.error('Error setting up onSnapshot:', error);\r\n          fetchListingsWithGetDocs();\r\n        }\r\n      } catch (err) {\r\n        console.error('Error in fetchListings:', err);\r\n        if (isMounted) {\r\n          setError('Грешка при зареждане на обявите');\r\n          setLoading(false);\r\n        }\r\n      }\r\n    };\r\n\r\n    const fetchListingsWithGetDocs = async () => {\r\n      try {\r\n        if (!isMounted) return;\r\n        \r\n        const q = query(collection(db, 'listings'), orderBy('createdAt', 'desc'));\r\n        const querySnapshot = await getDocs(q);\r\n        processSnapshot(querySnapshot);\r\n      } catch (err) {\r\n        console.error('Error fetching listings with getDocs:', err);\r\n        if (isMounted) {\r\n          setError('Грешка при зареждане на обявите');\r\n          setLoading(false);\r\n        }\r\n      }\r\n    };\r\n\r\n    fetchListings();\r\n\r\n    return () => {\r\n      isMounted = false;\r\n      if (unsubscribe) {\r\n        unsubscribe();\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return { listings, loading, error, updateListing, deleteListing };\r\n}; ","import { Card, CardContent, CardMedia, Typography, Box, Chip } from '@mui/material';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Listing } from '../types/listing';\r\n\r\ninterface ListingCardProps {\r\n  listing: Listing;\r\n}\r\n\r\nconst ListingCard = ({ listing }: ListingCardProps) => {\r\n  const navigate = useNavigate();\r\n\r\n  return (\r\n    <Card\r\n      sx={{\r\n        mb: 2,\r\n        cursor: 'pointer',\r\n        '&:hover': {\r\n          boxShadow: 6,\r\n        },\r\n      }}\r\n      onClick={() => navigate(`/listing/${listing.id}`, { state: { listing } })}\r\n    >\r\n      <CardMedia\r\n        component=\"img\"\r\n        height=\"140\"\r\n        image={listing.images?.[0] || '/book.webp'}\r\n        alt={listing.title}\r\n        sx={{\r\n          objectFit: 'cover',\r\n          backgroundColor: 'grey.100',\r\n          minHeight: '140px',\r\n        }}\r\n        onError={(e) => {\r\n          const target = e.target as HTMLImageElement;\r\n          target.src = '/placeholder-image.jpg';\r\n        }}\r\n      />\r\n      <CardContent>\r\n        <Typography variant=\"h6\" component=\"div\" gutterBottom>\r\n          {listing.title}\r\n        </Typography>\r\n        <Typography variant=\"body2\" color=\"text.secondary\" paragraph>\r\n          {listing.description}\r\n        </Typography>\r\n        <Box sx={{ display: 'flex', gap: 1, flexWrap: 'wrap' }}>\r\n          <Chip label={listing.category} size=\"small\" />\r\n          <Chip label={listing.condition} size=\"small\" />\r\n        </Box>\r\n        <Typography variant=\"caption\" color=\"text.secondary\" sx={{ mt: 1, display: 'block' }}>\r\n          Публикувано от {listing.userName}\r\n        </Typography>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default ListingCard; ","import React, { useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n  Container,\r\n  Box,\r\n  Typography,\r\n  Grid,\r\n  Avatar,\r\n  Button,\r\n  Card,\r\n  CardContent,\r\n  Alert,\r\n  CircularProgress,\r\n} from '@mui/material';\r\nimport { useAuth } from '../hooks/useAuth';\r\nimport { useListings } from '../hooks/useListings';\r\nimport ListingCard from '../components/ListingCard';\r\nimport AnimatedPage from '../components/AnimatedPage';\r\n\r\nconst Profile: React.FC = () => {\r\n  const { user, loading: authLoading } = useAuth();\r\n  const { listings, loading: listingsLoading } = useListings();\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    if (!authLoading && !user) {\r\n      navigate('/login');\r\n    }\r\n  }, [user, authLoading, navigate]);\r\n\r\n  if (authLoading || !user) {\r\n    return null;\r\n  }\r\n\r\n  const userListings = listings.filter((listing) => {\r\n    console.log('Listing:', listing);\r\n    return listing.userId === user.uid && listing.status === 'active';\r\n  });\r\n  const activeListingsCount = userListings.length;\r\n\r\n  return (\r\n    <AnimatedPage animation=\"fade\">\r\n      <Box sx={{ pt: 8 }}>\r\n        <Container maxWidth=\"lg\">\r\n          <AnimatedPage animation=\"slide\" delay={0.2}>\r\n            <Box sx={{ mb: 4 }}>\r\n              <Typography variant=\"h4\" component=\"h1\" gutterBottom>\r\n                Профил\r\n              </Typography>\r\n              <Typography variant=\"body1\" color=\"text.secondary\" paragraph>\r\n                Управлявайте вашия профил и обяви.\r\n              </Typography>\r\n            </Box>\r\n          </AnimatedPage>\r\n\r\n          <Grid container spacing={4}>\r\n            <Grid item xs={12} md={4}>\r\n              <AnimatedPage animation=\"scale\" delay={0.4}>\r\n                <Card>\r\n                  <CardContent>\r\n                    <Box sx={{ display: 'flex', flexDirection: 'column', alignItems: 'center', mb: 3 }}>\r\n                      <Avatar\r\n                        sx={{ width: 100, height: 100, mb: 2 }}\r\n                        alt={user?.displayName || 'User'}\r\n                        src={user?.photoURL || ''}\r\n                      />\r\n                      <Typography variant=\"h6\" gutterBottom>\r\n                        {user?.displayName || 'Потребител'}\r\n                      </Typography>\r\n                      <Typography variant=\"body2\" color=\"text.secondary\">\r\n                        {user?.email}\r\n                      </Typography>\r\n                      <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1 }}>\r\n                        {activeListingsCount} активни обяви\r\n                      </Typography>\r\n                    </Box>\r\n                    <Box sx={{ display: 'flex', gap: 2 }}>\r\n                      <Button\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                        onClick={() => navigate('/settings')}\r\n                      >\r\n                        Настройки\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                        onClick={() => navigate('/create-listing')}\r\n                      >\r\n                        Нова обява\r\n                      </Button>\r\n                    </Box>\r\n                  </CardContent>\r\n                </Card>\r\n              </AnimatedPage>\r\n            </Grid>\r\n\r\n            <Grid item xs={12} md={8}>\r\n              <AnimatedPage animation=\"slide\" delay={0.6}>\r\n                <Box sx={{ mb: 4 }}>\r\n                  <Typography variant=\"h5\" gutterBottom>\r\n                    Моите обяви\r\n                  </Typography>\r\n                  {listingsLoading ? (\r\n                    <Box sx={{ display: 'flex', justifyContent: 'center', py: 4 }}>\r\n                      <CircularProgress />\r\n                    </Box>\r\n                  ) : userListings.length === 0 ? (\r\n                    <Alert severity=\"info\">\r\n                      Все още нямате публикувани обяви.\r\n                    </Alert>\r\n                  ) : (\r\n                    <Grid container spacing={3}>\r\n                      {userListings.map((listing, index) => (\r\n                        <Grid item xs={12} sm={6} key={listing.id}>\r\n                          <AnimatedPage animation=\"scale\" delay={0.8 + index * 0.1}>\r\n                            <ListingCard listing={listing} />\r\n                          </AnimatedPage>\r\n                        </Grid>\r\n                      ))}\r\n                    </Grid>\r\n                  )}\r\n                </Box>\r\n              </AnimatedPage>\r\n            </Grid>\r\n          </Grid>\r\n        </Container>\r\n      </Box>\r\n    </AnimatedPage>\r\n  );\r\n};\r\n\r\nexport default Profile; ","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z\"\n}), 'CloudUpload');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z\"\n}), 'Delete');","import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n  Container,\r\n  Box,\r\n  Typography,\r\n  TextField,\r\n  Button,\r\n  MenuItem,\r\n  Grid,\r\n  Alert,\r\n  Snackbar,\r\n  CircularProgress,\r\n  Paper,\r\n  FormControl,\r\n  InputLabel,\r\n  Select,\r\n  FormHelperText,\r\n  IconButton,\r\n} from '@mui/material';\r\nimport { useAuth } from '../hooks/useAuth';\r\nimport { addDoc, collection, serverTimestamp } from 'firebase/firestore';\r\nimport { ref, uploadBytes, getDownloadURL } from 'firebase/storage';\r\nimport { db, storage } from '../config/firebase';\r\nimport CloudUploadIcon from '@mui/icons-material/CloudUpload';\r\nimport DeleteIcon from '@mui/icons-material/Delete';\r\nimport AnimatedPage from '../components/AnimatedPage';\r\n\r\nconst categories = [\r\n  'Дрехи',\r\n  'Електроника',\r\n  'Книги',\r\n  'Мебели',\r\n  'Спортни стоки',\r\n  'Други',\r\n];\r\n\r\nconst conditions = ['ново', 'като ново', 'добро', 'задоволително', 'лошо'] as const;\r\n\r\nconst CreateListing: React.FC = () => {\r\n  const { user, loading: authLoading } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [error, setError] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [success, setSuccess] = useState(false);\r\n  const [uploadingImages, setUploadingImages] = useState(false);\r\n  const [formData, setFormData] = useState({\r\n    title: '',\r\n    description: '',\r\n    category: '',\r\n    condition: '',\r\n    images: [] as File[],\r\n    imagePreviews: [] as string[],\r\n    location: {\r\n      latitude: 0,\r\n      longitude: 0,\r\n      address: '',\r\n      region: ''\r\n    },\r\n    userPhone: '',\r\n    firstName: '',\r\n    lastName: '',\r\n    email: ''\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (!authLoading && !user) {\r\n      navigate('/login');\r\n    }\r\n  }, [authLoading, user, navigate]);\r\n\r\n  const validateForm = () => {\r\n    console.log('Validating form...');\r\n    console.log('Title:', formData.title);\r\n    console.log('Description:', formData.description);\r\n    console.log('Category:', formData.category);\r\n    console.log('Condition:', formData.condition);\r\n    console.log('Images:', formData.images.length);\r\n\r\n    if (!formData.title.trim()) {\r\n      setError('Заглавието е задължително');\r\n      return false;\r\n    }\r\n    if (!formData.description.trim()) {\r\n      setError('Описанието е задължително');\r\n      return false;\r\n    }\r\n    if (!formData.category) {\r\n      setError('Категорията е задължителна');\r\n      return false;\r\n    }\r\n    if (!formData.condition) {\r\n      setError('Състоянието е задължително');\r\n      return false;\r\n    }\r\n    if (formData.images.length === 0) {\r\n      setError('Необходима е поне една снимка');\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const handleImageSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files && e.target.files.length > 0) {\r\n      const newImages = Array.from(e.target.files);\r\n      const newPreviews = newImages.map(file => URL.createObjectURL(file));\r\n\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        images: [...prev.images, ...newImages],\r\n        imagePreviews: [...prev.imagePreviews, ...newPreviews]\r\n      }));\r\n    }\r\n  };\r\n\r\n  const handleRemoveImage = (index: number) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      images: prev.images.filter((_, i) => i !== index),\r\n      imagePreviews: prev.imagePreviews.filter((_, i) => i !== index)\r\n    }));\r\n  };\r\n\r\n  const uploadImages = async (files: File[]): Promise<string[]> => {\r\n    if (!user) return [];\r\n\r\n    try {\r\n      setUploadingImages(true);\r\n      const uploadPromises = files.map(async (file) => {\r\n        const timestamp = Date.now();\r\n        const safeFileName = file.name.replace(/[^a-zA-Z0-9.-]/g, '_');\r\n        const filename = `${timestamp}-${safeFileName}`;\r\n        const storagePath = `listings/${user.uid}/${filename}`;\r\n        const storageRef = ref(storage, storagePath);\r\n\r\n        const snapshot = await uploadBytes(storageRef, file);\r\n        return await getDownloadURL(snapshot.ref);\r\n      });\r\n\r\n      return await Promise.all(uploadPromises);\r\n    } catch (err) {\r\n      throw new Error('Грешка при качване на снимките');\r\n    } finally {\r\n      setUploadingImages(false);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError('');\r\n\r\n    if (!validateForm()) {\r\n      return;\r\n    }\r\n\r\n    if (!user) {\r\n      setError('Трябва да сте влезли в системата, за да създадете обява');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n\r\n      // Upload images first\r\n      const imageUrls = await uploadImages(formData.images);\r\n\r\n      if (!imageUrls.length) {\r\n        throw new Error('Грешка при качване на снимките');\r\n      }\r\n\r\n      // Create listing document\r\n      const listingData = {\r\n        ...formData,\r\n        images: imageUrls,\r\n        status: 'active',\r\n        createdAt: serverTimestamp(),\r\n        userId: user.uid,\r\n        userName: user.displayName || 'Anonymous',\r\n        userEmail: user.email,\r\n      };\r\n\r\n      const docRef = await addDoc(collection(db, 'listings'), listingData);\r\n      setSuccess(true);\r\n\r\n      // Wait for the listing to be fully saved and indexed\r\n      await new Promise(resolve => setTimeout(resolve, 2000));\r\n\r\n      // Navigate to the listing details page\r\n      navigate(`/listing/${docRef.id}`);\r\n    } catch (error: any) {\r\n      setError(error.message || 'Грешка при създаване на обявата. Моля, опитайте отново.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (authLoading) {\r\n    return (\r\n      <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', minHeight: '100vh' }}>\r\n        <CircularProgress />\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <AnimatedPage animation=\"fade\">\r\n      <Box sx={{ pt: 8 }}>\r\n        <Container maxWidth=\"md\">\r\n          <AnimatedPage animation=\"slide\" delay={0.2}>\r\n            <Box sx={{ mb: 4 }}>\r\n              <Typography variant=\"h4\" component=\"h1\" gutterBottom>\r\n                Създай нова обява\r\n              </Typography>\r\n              <Typography variant=\"body1\" color=\"text.secondary\" paragraph>\r\n                Споделете предмети, които вече не използвате, и помогнете на други хора да ги намерят.\r\n              </Typography>\r\n            </Box>\r\n          </AnimatedPage>\r\n\r\n          <AnimatedPage animation=\"scale\" delay={0.4}>\r\n            <Paper sx={{ p: 4 }}>\r\n              <form onSubmit={handleSubmit}>\r\n                <Grid container spacing={3}>\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Заглавие\"\r\n                      value={formData.title}\r\n                      onChange={(e) => setFormData({ ...formData, title: e.target.value })}\r\n                      required\r\n                      error={!!error && !formData.title.trim()}\r\n                      helperText={!!error && !formData.title.trim() ? 'Заглавието е задължително' : ''}\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <AnimatedPage animation=\"slide\" delay={0.6}>\r\n                      <Box sx={{ mb: 2 }}>\r\n                        <Button\r\n                          component=\"label\"\r\n                          variant=\"outlined\"\r\n                          startIcon={<CloudUploadIcon />}\r\n                          fullWidth\r\n                        >\r\n                          Качи снимки\r\n                          <input\r\n                            type=\"file\"\r\n                            hidden\r\n                            multiple\r\n                            accept=\"image/*\"\r\n                            onChange={handleImageSelect}\r\n                          />\r\n                        </Button>\r\n                      </Box>\r\n                      {formData.imagePreviews.length > 0 && (\r\n                        <Grid container spacing={2}>\r\n                          {formData.imagePreviews.map((preview, index) => (\r\n                            <Grid item xs={6} sm={4} md={3} key={index}>\r\n                              <Box sx={{ position: 'relative' }}>\r\n                                <img\r\n                                  src={preview}\r\n                                  alt={`Preview ${index + 1}`}\r\n                                  style={{\r\n                                    width: '100%',\r\n                                    height: '150px',\r\n                                    objectFit: 'cover',\r\n                                    borderRadius: '4px'\r\n                                  }}\r\n                                />\r\n                                <IconButton\r\n                                  size=\"small\"\r\n                                  sx={{\r\n                                    position: 'absolute',\r\n                                    top: 8,\r\n                                    right: 8,\r\n                                    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n                                    '&:hover': {\r\n                                      backgroundColor: 'rgba(0, 0, 0, 0.7)'\r\n                                    }\r\n                                  }}\r\n                                  onClick={() => handleRemoveImage(index)}\r\n                                >\r\n                                  <DeleteIcon sx={{ color: 'white' }} />\r\n                                </IconButton>\r\n                              </Box>\r\n                            </Grid>\r\n                          ))}\r\n                        </Grid>\r\n                      )}\r\n                      {!!error && !formData.images.length && (\r\n                        <Typography color=\"error\" variant=\"body2\" sx={{ mt: 1 }}>\r\n                          Необходима е поне една снимка\r\n                        </Typography>\r\n                      )}\r\n                    </AnimatedPage>\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Описание\"\r\n                      value={formData.description}\r\n                      onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                      multiline\r\n                      rows={4}\r\n                      required\r\n                      error={!!error && !formData.description.trim()}\r\n                      helperText={!!error && !formData.description.trim() ? 'Описанието е задължително' : ''}\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12} sm={6}>\r\n                    <FormControl fullWidth required error={!!error && !formData.category}>\r\n                      <InputLabel>Категория</InputLabel>\r\n                      <Select\r\n                        value={formData.category}\r\n                        onChange={(e) => setFormData({ ...formData, category: e.target.value })}\r\n                        label=\"Категория\"\r\n                      >\r\n                        {categories.map((category) => (\r\n                          <MenuItem key={category} value={category}>\r\n                            {category}\r\n                          </MenuItem>\r\n                        ))}\r\n                      </Select>\r\n                      {error && !formData.category && (\r\n                        <FormHelperText>{error}</FormHelperText>\r\n                      )}\r\n                    </FormControl>\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12} sm={6}>\r\n                    <FormControl fullWidth required error={!!error && !formData.condition}>\r\n                      <InputLabel>Състояние</InputLabel>\r\n                      <Select\r\n                        value={formData.condition}\r\n                        onChange={(e) => setFormData({ ...formData, condition: e.target.value })}\r\n                        label=\"Състояние\"\r\n                      >\r\n                        {conditions.map((condition) => (\r\n                          <MenuItem key={condition} value={condition}>\r\n                            {condition}\r\n                          </MenuItem>\r\n                        ))}\r\n                      </Select>\r\n                      {error && !formData.condition && (\r\n                        <FormHelperText>{error}</FormHelperText>\r\n                      )}\r\n                    </FormControl>\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <AnimatedPage animation=\"slide\" delay={0.8}>\r\n                      <TextField\r\n                        label=\"Град\"\r\n                        value={formData.location.address}\r\n                        onChange={(e) => setFormData({ ...formData, location: { ...formData.location, address: e.target.value } })}\r\n                        fullWidth\r\n                        required\r\n                        sx={{ mb: 2 }}\r\n                      />\r\n                    </AnimatedPage>\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <AnimatedPage animation=\"slide\" delay={0.9}>\r\n                      <TextField\r\n                        label=\"Регион\"\r\n                        value={formData.location.region}\r\n                        onChange={(e) => setFormData({ ...formData, location: { ...formData.location, region: e.target.value } })}\r\n                        fullWidth\r\n                        required\r\n                        sx={{ mb: 2 }}\r\n                      />\r\n                    </AnimatedPage>\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12} sm={6}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Име\"\r\n                      value={formData.firstName}\r\n                      onChange={(e) => setFormData({ ...formData, firstName: e.target.value })}\r\n                      required\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12} sm={6}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Фамилия\"\r\n                      value={formData.lastName}\r\n                      onChange={(e) => setFormData({ ...formData, lastName: e.target.value })}\r\n                      required\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Имейл адрес\"\r\n                      value={formData.email}\r\n                      onChange={(e) => setFormData({ ...formData, email: e.target.value })}\r\n                      required\r\n                      type=\"email\"\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Телефонен номер\"\r\n                      value={formData.userPhone}\r\n                      onChange={(e) => setFormData({ ...formData, userPhone: e.target.value })}\r\n                      placeholder=\"+359 888 123 456\"\r\n                      helperText=\"По избор - за по-лесна комуникация с купувачите\"\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <Box sx={{ display: 'flex', gap: 2, justifyContent: 'flex-end' }}>\r\n                      <Button\r\n                        variant=\"outlined\"\r\n                        onClick={() => navigate('/')}\r\n                      >\r\n                        Отказ\r\n                      </Button>\r\n                      <Button\r\n                        type=\"submit\"\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        disabled={loading || uploadingImages}\r\n                      >\r\n                        {loading || uploadingImages ? (\r\n                          <CircularProgress size={24} />\r\n                        ) : (\r\n                          'Публикувай'\r\n                        )}\r\n                      </Button>\r\n                    </Box>\r\n                  </Grid>\r\n                </Grid>\r\n              </form>\r\n            </Paper>\r\n          </AnimatedPage>\r\n        </Container>\r\n      </Box>\r\n\r\n      {error && (\r\n        <Alert severity=\"error\" sx={{ mt: 2 }}>\r\n          {error}\r\n        </Alert>\r\n      )}\r\n\r\n      <Snackbar\r\n        open={success}\r\n        autoHideDuration={2000}\r\n        onClose={() => setSuccess(false)}\r\n      >\r\n        <Alert severity=\"success\">\r\n          Обявата беше създадена успешно!\r\n        </Alert>\r\n      </Snackbar>\r\n    </AnimatedPage>\r\n  );\r\n};\r\n\r\nexport default CreateListing; ","import React, { useEffect, useState } from 'react';\nimport { useLocation, useNavigate, useParams } from 'react-router-dom';\nimport {\n  Container,\n  Box,\n  Typography,\n  Grid,\n  Paper,\n  Button,\n  Chip,\n  IconButton,\n  Dialog,\n  DialogContent,\n  DialogTitle,\n  DialogActions,\n  useTheme,\n  CircularProgress,\n  Alert,\n  Card,\n  CardMedia,\n  CardContent,\n  Avatar,\n  Divider,\n} from '@mui/material';\nimport {\n  LocationOn as LocationIcon,\n  ArrowBack as ArrowBackIcon,\n  ZoomIn as ZoomInIcon,\n  Email as EmailIcon,\n  Phone as PhoneIcon,\n  Person as PersonIcon,\n  Edit as EditIcon,\n  Delete as DeleteIcon,\n  Close as CloseIcon,\n  Visibility as VisibilityIcon,\n  VisibilityOff as VisibilityOffIcon,\n} from '@mui/icons-material';\nimport { useAuth } from '../hooks/useAuth';\nimport { doc, getDoc, deleteDoc } from 'firebase/firestore';\nimport { ref, deleteObject } from 'firebase/storage';\nimport { db, storage } from '../config/firebase';\nimport AnimatedPage from '../components/AnimatedPage';\nimport { useFavorites } from '../hooks/useFavorites';\nimport { Listing } from '../types/listing';\nimport { collection, getDocs, query, where } from 'firebase/firestore';\n\nconst ListingDetails: React.FC = () => {\n  const location = useLocation();\n  const navigate = useNavigate();\n  const { id } = useParams<{ id: string }>();\n  const theme = useTheme();\n  const { user } = useAuth();\n  const { favorites, isFavorite: checkIsFavorite } = useFavorites();\n  \n  const [imageDialogOpen, setImageDialogOpen] = React.useState(false);\n  const [deleteDialogOpen, setDeleteDialogOpen] = React.useState(false);\n  const [loading, setLoading] = React.useState(true);\n  const [error, setError] = React.useState<string | null>(null);\n  const [listing, setListing] = React.useState<Listing | null>(null);\n  const [enlargedImage, setEnlargedImage] = useState<string | null>(null);\n  const [showPhone, setShowPhone] = useState(false);\n  const [otherListings, setOtherListings] = useState<Listing[]>([]);\n  const [loadingOtherListings, setLoadingOtherListings] = useState(false);\n\n  useEffect(() => {\n    const fetchListing = async () => {\n      if (!id) {\n        setError('ID на обявата не е намерен');\n        setLoading(false);\n        return;\n      }\n\n      try {\n        const listingDoc = await getDoc(doc(db, 'listings', id));\n        if (!listingDoc.exists()) {\n          setError('Обявата не е намерена');\n          setLoading(false);\n          return;\n        }\n        const listingData = { id: listingDoc.id, ...listingDoc.data() } as Listing;\n        setListing(listingData);\n\n        // Fetch other listings from the same user\n        if (listingData.userId) {\n          setLoadingOtherListings(true);\n          const q = query(\n            collection(db, 'listings'),\n            where('userId', '==', listingData.userId),\n            where('status', '==', 'active')\n          );\n          const querySnapshot = await getDocs(q);\n          const otherListingsData = querySnapshot.docs\n            .map(doc => ({ id: doc.id, ...doc.data() } as Listing))\n            .filter(listing => listing.id !== id);\n          setOtherListings(otherListingsData);\n        }\n      } catch (err) {\n        setError('Грешка при зареждане на обявата');\n        console.error('Error fetching listing:', err);\n      } finally {\n        setLoading(false);\n        setLoadingOtherListings(false);\n      }\n    };\n\n    // Try to get listing from location state first\n    const locationListing = location.state?.listing;\n    if (locationListing) {\n      setListing(locationListing);\n      setLoading(false);\n    } else {\n      fetchListing();\n    }\n  }, [id, location.state, favorites, checkIsFavorite]);\n\n  const handleEditClick = () => {\n    if (!listing?.id) return;\n    navigate(`/edit-listing/${listing.id}`, { state: { listing } });\n  };\n\n  const handleDelete = async () => {\n    if (!listing?.id) return;\n    \n    try {\n      setLoading(true);\n      // Delete the listing document\n      const listingRef = doc(db, 'listings', listing.id);\n      await deleteDoc(listingRef);\n\n      // Delete associated images from storage if they exist\n      if (listing.images && listing.images.length > 0) {\n        for (const imageUrl of listing.images) {\n          try {\n            // Extract the path from the URL\n            const imagePath = imageUrl.split('listings/')[1];\n            if (imagePath) {\n              const imageRef = ref(storage, `listings/${imagePath}`);\n              await deleteObject(imageRef);\n            }\n          } catch (imageError) {\n            console.error('Error deleting image:', imageError);\n          }\n        }\n      }\n\n      setError('Обявата беше изтрита успешно');\n      navigate('/my-listings');\n    } catch (err) {\n      setError('Грешка при изтриване на обявата');\n      console.error(err);\n    } finally {\n      setLoading(false);\n      setDeleteDialogOpen(false);\n    }\n  };\n\n  const handleImageClick = (image: string) => {\n    setEnlargedImage(image);\n    setImageDialogOpen(true);\n  };\n\n  const handleCloseImageDialog = () => {\n    setImageDialogOpen(false);\n    setEnlargedImage(null);\n  };\n\n  const handleShowPhone = () => {\n    setShowPhone(!showPhone);\n  };\n\n  const formatDate = (date: Listing['createdAt']) => {\n    if (!date) return 'неизвестна дата';\n    \n    try {\n      if (typeof date === 'string') {\n        return new Date(date).toLocaleDateString('bg-BG', {\n          year: 'numeric',\n          month: 'long',\n          day: 'numeric'\n        });\n      } else if (typeof date === 'object' && 'seconds' in date) {\n        return new Date(date.seconds * 1000).toLocaleDateString('bg-BG', {\n          year: 'numeric',\n          month: 'long',\n          day: 'numeric'\n        });\n      }\n      return 'неизвестна дата';\n    } catch (error) {\n      console.error('Error formatting date:', error);\n      return 'неизвестна дата';\n    }\n  };\n\n  if (loading) {\n    return (\n      <Container>\n        <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', minHeight: '60vh' }}>\n          <CircularProgress />\n        </Box>\n      </Container>\n    );\n  }\n\n  if (error) {\n    return (\n      <Container>\n        <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', minHeight: '60vh' }}>\n          <Alert severity=\"error\" sx={{ width: '100%' }}>\n            {error}\n          </Alert>\n        </Box>\n      </Container>\n    );\n  }\n\n  if (!listing) {\n    return (\n      <Container>\n        <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', minHeight: '60vh' }}>\n          <Alert severity=\"error\" sx={{ width: '100%' }}>\n            Обявата не е намерена\n          </Alert>\n        </Box>\n      </Container>\n    );\n  }\n\n  const formatLocation = (location: any) => {\n    if (!location) return 'Местоположението не е посочено';\n    if (typeof location === 'string') return location;\n    \n    // Extract city from address if available\n    const address = location.address || '';\n    const cityMatch = address.match(/([^,]+),/);\n    const city = cityMatch ? cityMatch[1].trim() : address;\n    \n    return city || 'Местоположението не е посочено';\n  };\n\n  return (\n    <AnimatedPage animation=\"fade\">\n      <Box sx={{ py: 4 }}>\n        <Container>\n          <AnimatedPage animation=\"slide\">\n            <Grid container spacing={3}>\n              <Grid item xs={12}>\n                <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 3 }}>\n                  <IconButton \n                    onClick={() => navigate(-1)}\n                    sx={{ mr: 2 }}\n                  >\n                    <ArrowBackIcon />\n                  </IconButton>\n                  <Typography variant=\"h4\" component=\"h1\" sx={{ flex: 1 }}>\n                    {listing.title}\n                  </Typography>\n                  <Box sx={{ display: 'flex', gap: 1 }}>\n                    {user?.uid === listing.userId && (\n                      <>\n                        <IconButton\n                          onClick={handleEditClick}\n                          color=\"primary\"\n                        >\n                          <EditIcon />\n                        </IconButton>\n                        <IconButton\n                          onClick={() => setDeleteDialogOpen(true)}\n                          color=\"error\"\n                        >\n                          <DeleteIcon />\n                        </IconButton>\n                      </>\n                    )}\n                  </Box>\n                </Box>\n              </Grid>\n\n              <Grid item xs={12} md={8}>\n                <Paper sx={{ p: 3 }}>\n                  <Box sx={{ mb: 3 }}>\n                    <Grid container spacing={2}>\n                      {listing.images?.map((image: string, index: number) => (\n                        <Grid item xs={12} sm={6} key={index}>\n                          <Box\n                            onClick={() => handleImageClick(image)}\n                            sx={{\n                              cursor: 'pointer',\n                              position: 'relative',\n                              '&:hover': {\n                                '&::after': {\n                                  content: '\"\"',\n                                  position: 'absolute',\n                                  top: 0,\n                                  left: 0,\n                                  right: 0,\n                                  bottom: 0,\n                                  backgroundColor: 'rgba(0, 0, 0, 0.1)',\n                                  borderRadius: '8px',\n                                },\n                                '& .zoom-icon': {\n                                  opacity: 1,\n                                }\n                              }\n                            }}\n                          >\n                            <img\n                              src={image}\n                              alt={`${listing.title} - Снимка ${index + 1}`}\n                              style={{\n                                width: '100%',\n                                height: '300px',\n                                objectFit: 'cover',\n                                borderRadius: '8px'\n                              }}\n                            />\n                            <ZoomInIcon\n                              className=\"zoom-icon\"\n                              sx={{\n                                position: 'absolute',\n                                top: '50%',\n                                left: '50%',\n                                transform: 'translate(-50%, -50%)',\n                                color: 'white',\n                                fontSize: 40,\n                                opacity: 0,\n                                transition: 'opacity 0.2s',\n                                zIndex: 1\n                              }}\n                            />\n                          </Box>\n                        </Grid>\n                      ))}\n                    </Grid>\n                  </Box>\n\n                  <Typography variant=\"body1\" paragraph>\n                    {listing.description}\n                  </Typography>\n\n                  <Divider sx={{ my: 3 }} />\n\n                  <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 1, mb: 2 }}>\n                    {listing.category && <Chip label={listing.category} color=\"primary\" />}\n                    {listing.condition && <Chip label={listing.condition} color=\"secondary\" />}\n                    {listing.status && (\n                      <Chip\n                        label={listing.status}\n                        color={listing.status === 'active' ? 'success' : 'default'}\n                      />\n                    )}\n                  </Box>\n\n                  {listing.location && (\n                    <Box sx={{ \n                      display: 'flex', \n                      alignItems: 'center', \n                      gap: 1.5, \n                      mb: 3,\n                      mt: 2,\n                      p: 2.5,\n                      bgcolor: 'background.default',\n                      borderRadius: 1.5,\n                      boxShadow: '0 2px 4px rgba(0,0,0,0.05)'\n                    }}>\n                      <LocationIcon color=\"primary\" sx={{ fontSize: 28 }} />\n                      <Typography variant=\"body1\" color=\"text.primary\" sx={{ fontWeight: 500 }}>\n                        {formatLocation(listing.location)}\n                      </Typography>\n                    </Box>\n                  )}\n                </Paper>\n              </Grid>\n\n              <Grid item xs={12} md={4}>\n                <AnimatedPage animation=\"slide\" delay={0.4}>\n                  <Paper sx={{ p: 3 }}>\n                    <Box sx={{ display: 'flex', alignItems: 'center', gap: 2, mb: 3 }}>\n                      <Avatar \n                        sx={{ \n                          width: 64, \n                          height: 64,\n                          bgcolor: 'primary.main',\n                          fontSize: '1.5rem'\n                        }}\n                      >\n                        {listing.userName?.[0]?.toUpperCase() || '?'}\n                      </Avatar>\n                      <Box>\n                        <Typography variant=\"h6\" component=\"h2\">\n                          {listing.userName || 'Неизвестен потребител'}\n                        </Typography>\n                        <Typography variant=\"body2\" color=\"text.secondary\">\n                          Член от {formatDate(listing.createdAt)}\n                        </Typography>\n                      </Box>\n                    </Box>\n\n                    <Divider sx={{ my: 2 }} />\n\n                    <Box sx={{ mb: 3 }}>\n                      <Typography variant=\"subtitle2\" color=\"text.secondary\" gutterBottom>\n                        Контактна информация\n                      </Typography>\n                      <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, mb: 1 }}>\n                        <PersonIcon color=\"action\" />\n                        <Typography variant=\"body2\">\n                          {listing.userName || 'Неизвестен потребител'}\n                        </Typography>\n                      </Box>\n                      <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, mb: 1 }}>\n                        <EmailIcon color=\"action\" />\n                        <Typography variant=\"body2\">\n                          {listing.userEmail}\n                        </Typography>\n                      </Box>\n                      <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                        <PhoneIcon color=\"action\" />\n                        {showPhone ? (\n                          <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                            <Typography variant=\"body2\">\n                              {listing.userPhone || 'Няма телефон'}\n                            </Typography>\n                            <IconButton\n                              size=\"small\"\n                              onClick={handleShowPhone}\n                              sx={{ \n                                color: 'primary.main',\n                                '&:hover': {\n                                  backgroundColor: 'transparent'\n                                }\n                              }}\n                            >\n                              <VisibilityOffIcon fontSize=\"small\" />\n                            </IconButton>\n                          </Box>\n                        ) : (\n                          <Button\n                            variant=\"text\"\n                            size=\"small\"\n                            onClick={handleShowPhone}\n                            startIcon={<VisibilityIcon />}\n                            sx={{ \n                              textTransform: 'none',\n                              color: 'primary.main',\n                              '&:hover': {\n                                backgroundColor: 'transparent'\n                              }\n                            }}\n                          >\n                            Покажи телефон\n                          </Button>\n                        )}\n                      </Box>\n                    </Box>\n\n                    <Box sx={{ mb: 3 }}>\n                      <Typography variant=\"subtitle2\" color=\"text.secondary\" gutterBottom>\n                        Други обяви от този потребител\n                      </Typography>\n                      {loadingOtherListings ? (\n                        <CircularProgress size={24} />\n                      ) : (\n                        <Typography variant=\"body2\">\n                          {otherListings.length} активни обяви\n                        </Typography>\n                      )}\n                      {otherListings.length > 0 && (\n                        <Grid container spacing={2} sx={{ mt: 2 }}>\n                          {otherListings.map((otherListing) => (\n                            <Grid item xs={12} sm={6} key={otherListing.id}>\n                              <Card\n                                sx={{\n                                  cursor: 'pointer',\n                                  '&:hover': {\n                                    boxShadow: theme.shadows[4],\n                                  },\n                                }}\n                                onClick={() => navigate(`/listing/${otherListing.id}`)}\n                              >\n                                <CardMedia\n                                  component=\"img\"\n                                  height=\"140\"\n                                  image={otherListing.images?.[0] || '/placeholder-image.jpg'}\n                                  alt={otherListing.title}\n                                  sx={{ objectFit: 'cover' }}\n                                />\n                                <CardContent>\n                                  <Typography variant=\"subtitle1\" noWrap>\n                                    {otherListing.title}\n                                  </Typography>\n                                  <Typography variant=\"body2\" color=\"text.secondary\" noWrap>\n                                    {otherListing.description}\n                                  </Typography>\n                                </CardContent>\n                              </Card>\n                            </Grid>\n                          ))}\n                        </Grid>\n                      )}\n                    </Box>\n\n                    <Button\n                      variant=\"contained\"\n                      color=\"primary\"\n                      fullWidth\n                      startIcon={<EmailIcon />}\n                      onClick={() => window.location.href = `mailto:${listing.userEmail}`}\n                      disabled={!listing.userEmail}\n                    >\n                      Свържи се\n                    </Button>\n                  </Paper>\n                </AnimatedPage>\n              </Grid>\n            </Grid>\n          </AnimatedPage>\n        </Container>\n      </Box>\n\n      <Dialog\n        open={deleteDialogOpen}\n        onClose={() => setDeleteDialogOpen(false)}\n      >\n        <AnimatedPage animation=\"fade\">\n          <DialogTitle>Потвърди изтриване</DialogTitle>\n          <DialogContent>\n            Сигурни ли сте, че искате да изтриете тази обява? Това действие не може да бъде отменено.\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={() => setDeleteDialogOpen(false)}>Отказ</Button>\n            <Button onClick={handleDelete} color=\"error\" variant=\"contained\" disabled={loading}>\n              {loading ? <CircularProgress size={24} /> : 'Изтрий'}\n            </Button>\n          </DialogActions>\n        </AnimatedPage>\n      </Dialog>\n\n      <Dialog\n        open={imageDialogOpen}\n        onClose={handleCloseImageDialog}\n        maxWidth=\"lg\"\n        fullWidth\n      >\n        <DialogContent sx={{ p: 0, position: 'relative' }}>\n          <IconButton\n            onClick={handleCloseImageDialog}\n            sx={{\n              position: 'absolute',\n              right: 8,\n              top: 8,\n              color: 'white',\n              bgcolor: 'rgba(0, 0, 0, 0.5)',\n              '&:hover': {\n                bgcolor: 'rgba(0, 0, 0, 0.7)',\n              }\n            }}\n          >\n            <CloseIcon />\n          </IconButton>\n          {enlargedImage && (\n            <img\n              src={enlargedImage}\n              alt=\"Enlarged product\"\n              style={{\n                width: '100%',\n                height: 'auto',\n                maxHeight: '80vh',\n                objectFit: 'contain'\n              }}\n            />\n          )}\n        </DialogContent>\n      </Dialog>\n    </AnimatedPage>\n  );\n};\n\nexport default ListingDetails;","import React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport {\r\n  Container,\r\n  Box,\r\n  Typography,\r\n  TextField,\r\n  Button,\r\n  MenuItem,\r\n  Grid,\r\n  Paper,\r\n  IconButton,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n  CircularProgress,\r\n  FormControl,\r\n  InputLabel,\r\n  Select,\r\n  FormHelperText,\r\n} from '@mui/material';\r\nimport DeleteIcon from '@mui/icons-material/Delete';\r\nimport { useAuth } from '../hooks/useAuth';\r\nimport { doc, updateDoc, deleteDoc, getDoc } from 'firebase/firestore';\r\nimport { ref, uploadBytes, getDownloadURL, deleteObject } from 'firebase/storage';\r\nimport { db, storage } from '../config/firebase';\r\nimport { Listing } from '../types/listing';\r\nimport CloudUploadIcon from '@mui/icons-material/CloudUpload';\r\nimport AnimatedPage from '../components/AnimatedPage';\r\nimport { useFavorites } from '../hooks/useFavorites';\r\n\r\nconst categories = [\r\n  'Дрехи',\r\n  'Електроника',\r\n  'Книги',\r\n  'Мебели',\r\n  'Спортни стоки',\r\n  'Други',\r\n];\r\n\r\nconst conditions = ['ново', 'като ново', 'добро', 'задоволително', 'лошо'] as const;\r\n\r\nconst initialFormData: Listing = {\r\n  id: '',\r\n  title: '',\r\n  description: '',\r\n  category: '',\r\n  condition: '',\r\n  status: 'active',\r\n  images: [],\r\n  location: {\r\n    latitude: 0,\r\n    longitude: 0,\r\n    address: '',\r\n    region: ''\r\n  },\r\n  userId: '',\r\n  userName: '',\r\n  userEmail: '',\r\n  userPhone: '',\r\n  firstName: '',\r\n  lastName: '',\r\n  createdAt: '',\r\n  updatedAt: ''\r\n};\r\n\r\nconst EditListing = () => {\r\n  const { id } = useParams();\r\n  const { user, loading: authLoading } = useAuth();\r\n  const navigate = useNavigate();\r\n  const { toggleFavorite } = useFavorites();\r\n  const [error, setError] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [uploadingImages, setUploadingImages] = useState(false);\r\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\r\n  const [formData, setFormData] = useState<Listing>(initialFormData);\r\n  const [newImages, setNewImages] = useState<File[]>([]);\r\n  const [imagePreviews, setImagePreviews] = useState<string[]>([]);\r\n\r\n  useEffect(() => {\r\n    if (!authLoading && !user) {\r\n      navigate('/login');\r\n      return;\r\n    }\r\n\r\n    const fetchListing = async () => {\r\n      if (!id) return;\r\n      \r\n      try {\r\n        setLoading(true);\r\n        const docRef = doc(db, 'listings', id);\r\n        const docSnap = await getDoc(docRef);\r\n        \r\n        if (docSnap.exists()) {\r\n          const data = docSnap.data() as Listing;\r\n          if (data.userId !== user?.uid) {\r\n            navigate('/');\r\n            return;\r\n          }\r\n          setFormData(data);\r\n          setImagePreviews(data.images || []);\r\n        } else {\r\n          setError('Обявата не беше намерена');\r\n        }\r\n      } catch (err) {\r\n        setError('Грешка при зареждане на обявата');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchListing();\r\n  }, [authLoading, user, navigate, id]);\r\n\r\n  const validateForm = () => {\r\n    if (!formData.title?.trim()) {\r\n      setError('Заглавието е задължително');\r\n      return false;\r\n    }\r\n    if (!formData.description?.trim()) {\r\n      setError('Описанието е задължително');\r\n      return false;\r\n    }\r\n    if (!formData.category) {\r\n      setError('Категорията е задължителна');\r\n      return false;\r\n    }\r\n    if (!formData.condition) {\r\n      setError('Състоянието е задължително');\r\n      return false;\r\n    }\r\n    if ((!formData.images || formData.images.length === 0) && newImages.length === 0) {\r\n      setError('Необходима е поне една снимка');\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const handleImageUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (event.target.files && event.target.files.length > 0) {\r\n      const files = Array.from(event.target.files);\r\n      const newPreviews = files.map(file => URL.createObjectURL(file));\r\n      \r\n      setNewImages(prev => [...prev, ...files]);\r\n      setImagePreviews(prev => [...prev, ...newPreviews]);\r\n    }\r\n  };\r\n\r\n  const handleRemoveImage = async (index: number, isNew: boolean) => {\r\n    if (isNew) {\r\n      setNewImages(prev => prev.filter((_, i) => i !== index));\r\n      setImagePreviews(prev => prev.filter((_, i) => i !== index));\r\n    } else {\r\n      if (!formData.images) return;\r\n      \r\n      try {\r\n        const imageUrl = formData.images[index];\r\n        const imageRef = ref(storage, imageUrl);\r\n        await deleteObject(imageRef);\r\n        \r\n        setFormData(prev => ({\r\n          ...prev,\r\n          images: prev.images?.filter((_, i) => i !== index)\r\n        }));\r\n        setImagePreviews(prev => prev.filter((_, i) => i !== index));\r\n      } catch (err) {\r\n        setError('Грешка при изтриване на снимката');\r\n      }\r\n    }\r\n  };\r\n\r\n  const uploadNewImages = async (files: File[]): Promise<string[]> => {\r\n    if (!user) return [];\r\n    \r\n    try {\r\n      setUploadingImages(true);\r\n      const uploadPromises = files.map(async (file) => {\r\n        const timestamp = Date.now();\r\n        const safeFileName = file.name.replace(/[^a-zA-Z0-9.-]/g, '_');\r\n        const filename = `${timestamp}-${safeFileName}`;\r\n        const storagePath = `listings/${user.uid}/${filename}`;\r\n        const storageRef = ref(storage, storagePath);\r\n        \r\n        const snapshot = await uploadBytes(storageRef, file);\r\n        return await getDownloadURL(snapshot.ref);\r\n      });\r\n      \r\n      return await Promise.all(uploadPromises);\r\n    } catch (err) {\r\n      throw new Error('Грешка при качване на снимките');\r\n    } finally {\r\n      setUploadingImages(false);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError('');\r\n    \r\n    if (!validateForm()) {\r\n      return;\r\n    }\r\n    \r\n    if (!user || !id) return;\r\n\r\n    try {\r\n      setLoading(true);\r\n      \r\n      let updatedImages = formData.images || [];\r\n      if (newImages.length > 0) {\r\n        const newImageUrls = await uploadNewImages(newImages);\r\n        updatedImages = [...updatedImages, ...newImageUrls];\r\n      }\r\n\r\n      const docRef = doc(db, 'listings', id);\r\n      await updateDoc(docRef, {\r\n        ...formData,\r\n        images: updatedImages,\r\n        status: 'active',\r\n        updatedAt: new Date(),\r\n      });\r\n      \r\n      navigate(`/listing/${id}`);\r\n    } catch (err) {\r\n      setError('Грешка при актуализиране на обявата. Моля, опитайте отново.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    if (!id) return;\r\n    \r\n    try {\r\n      setLoading(true);\r\n      \r\n      // Delete images from storage\r\n      if (formData.images) {\r\n        const deletePromises = formData.images.map(async (imageUrl) => {\r\n          const imageRef = ref(storage, imageUrl);\r\n          try {\r\n            await deleteObject(imageRef);\r\n          } catch (err) {\r\n            console.error('Error deleting image:', err);\r\n          }\r\n        });\r\n        await Promise.all(deletePromises);\r\n      }\r\n      \r\n      // Delete document\r\n      await deleteDoc(doc(db, 'listings', id));\r\n      await toggleFavorite(id);\r\n      navigate('/profile');\r\n    } catch (err) {\r\n      setError('Грешка при изтриване на обявата. Моля, опитайте отново.');\r\n    } finally {\r\n      setLoading(false);\r\n      setDeleteDialogOpen(false);\r\n    }\r\n  };\r\n\r\n  if (loading && !formData.title) {\r\n    return (\r\n      <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', minHeight: '100vh' }}>\r\n        <CircularProgress />\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <AnimatedPage animation=\"fade\">\r\n      <Box sx={{ pt: 8 }}>\r\n        <Container maxWidth=\"md\">\r\n          <AnimatedPage animation=\"slide\" delay={0.2}>\r\n            <Box sx={{ mb: 4 }}>\r\n              <Typography variant=\"h4\" component=\"h1\" gutterBottom>\r\n                Редактирай обява\r\n              </Typography>\r\n              <Typography variant=\"body1\" color=\"text.secondary\" paragraph>\r\n                Актуализирайте информацията за вашата обява.\r\n              </Typography>\r\n            </Box>\r\n          </AnimatedPage>\r\n\r\n          <AnimatedPage animation=\"scale\" delay={0.4}>\r\n            <Paper sx={{ p: 4 }}>\r\n              <form onSubmit={handleSubmit}>\r\n                <Grid container spacing={3}>\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Заглавие\"\r\n                      value={formData.title}\r\n                      onChange={(e) => setFormData({ ...formData, title: e.target.value })}\r\n                      required\r\n                      error={!!error && !formData.title?.trim()}\r\n                      helperText={!!error && !formData.title?.trim() ? 'Заглавието е задължително' : ''}\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <Box sx={{ mb: 2 }}>\r\n                      <Button\r\n                        component=\"label\"\r\n                        variant=\"outlined\"\r\n                        startIcon={<CloudUploadIcon />}\r\n                        fullWidth\r\n                      >\r\n                        Качи снимки\r\n                        <input\r\n                          type=\"file\"\r\n                          hidden\r\n                          multiple\r\n                          accept=\"image/*\"\r\n                          onChange={handleImageUpload}\r\n                        />\r\n                      </Button>\r\n                    </Box>\r\n                    {imagePreviews.length > 0 && (\r\n                      <Grid container spacing={2}>\r\n                        {imagePreviews.map((preview, index) => (\r\n                          <Grid item xs={6} sm={4} md={3} key={index}>\r\n                            <Box sx={{ position: 'relative' }}>\r\n                              <img\r\n                                src={preview}\r\n                                alt={`Preview ${index + 1}`}\r\n                                style={{\r\n                                  width: '100%',\r\n                                  height: '150px',\r\n                                  objectFit: 'cover',\r\n                                  borderRadius: '4px'\r\n                                }}\r\n                              />\r\n                              <IconButton\r\n                                size=\"small\"\r\n                                sx={{\r\n                                  position: 'absolute',\r\n                                  top: 8,\r\n                                  right: 8,\r\n                                  backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n                                  '&:hover': {\r\n                                    backgroundColor: 'rgba(0, 0, 0, 0.7)'\r\n                                  }\r\n                                }}\r\n                                onClick={() => handleRemoveImage(index, true)}\r\n                              >\r\n                                <DeleteIcon sx={{ color: 'white' }} />\r\n                              </IconButton>\r\n                            </Box>\r\n                          </Grid>\r\n                        ))}\r\n                      </Grid>\r\n                    )}\r\n                    {!!error && (!formData.images || formData.images.length === 0) && newImages.length === 0 && (\r\n                      <Typography color=\"error\" variant=\"body2\" sx={{ mt: 1 }}>\r\n                        Необходима е поне една снимка\r\n                      </Typography>\r\n                    )}\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Описание\"\r\n                      value={formData.description}\r\n                      onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                      multiline\r\n                      rows={4}\r\n                      required\r\n                      error={!!error && !formData.description?.trim()}\r\n                      helperText={!!error && !formData.description?.trim() ? 'Описанието е задължително' : ''}\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12} sm={6}>\r\n                    <FormControl fullWidth required error={!!error && !formData.category}>\r\n                      <InputLabel>Категория</InputLabel>\r\n                      <Select\r\n                        value={formData.category}\r\n                        onChange={(e) => setFormData({ ...formData, category: e.target.value })}\r\n                        label=\"Категория\"\r\n                      >\r\n                        {categories.map((category) => (\r\n                          <MenuItem key={category} value={category}>\r\n                            {category}\r\n                          </MenuItem>\r\n                        ))}\r\n                      </Select>\r\n                      {error && !formData.category && (\r\n                        <FormHelperText>{error}</FormHelperText>\r\n                      )}\r\n                    </FormControl>\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12} sm={6}>\r\n                    <FormControl fullWidth required error={!!error && !formData.condition}>\r\n                      <InputLabel>Състояние</InputLabel>\r\n                      <Select\r\n                        value={formData.condition}\r\n                        onChange={(e) => setFormData({ ...formData, condition: e.target.value })}\r\n                        label=\"Състояние\"\r\n                      >\r\n                        {conditions.map((condition) => (\r\n                          <MenuItem key={condition} value={condition}>\r\n                            {condition}\r\n                          </MenuItem>\r\n                        ))}\r\n                      </Select>\r\n                      {error && !formData.condition && (\r\n                        <FormHelperText>{error}</FormHelperText>\r\n                      )}\r\n                    </FormControl>\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      label=\"Град\"\r\n                      value={formData.location?.address}\r\n                      onChange={(e) => setFormData({ ...formData, location: { ...formData.location, address: e.target.value } })}\r\n                      fullWidth\r\n                      required\r\n                      sx={{ mb: 2 }}\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      label=\"Регион\"\r\n                      value={formData.location?.region}\r\n                      onChange={(e) => setFormData({ ...formData, location: { ...formData.location, region: e.target.value } })}\r\n                      fullWidth\r\n                      required\r\n                      sx={{ mb: 2 }}\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12} sm={6}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Име\"\r\n                      value={formData.firstName}\r\n                      onChange={(e) => setFormData({ ...formData, firstName: e.target.value })}\r\n                      required\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12} sm={6}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Фамилия\"\r\n                      value={formData.lastName}\r\n                      onChange={(e) => setFormData({ ...formData, lastName: e.target.value })}\r\n                      required\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Имейл адрес\"\r\n                      value={formData.userEmail}\r\n                      onChange={(e) => setFormData({ ...formData, userEmail: e.target.value })}\r\n                      required\r\n                      type=\"email\"\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Телефонен номер\"\r\n                      value={formData.userPhone}\r\n                      onChange={(e) => setFormData({ ...formData, userPhone: e.target.value })}\r\n                      placeholder=\"+359 888 123 456\"\r\n                      helperText=\"По избор - за по-лесна комуникация с купувачите\"\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <Box sx={{ display: 'flex', gap: 2, justifyContent: 'flex-end' }}>\r\n                      <Button\r\n                        variant=\"outlined\"\r\n                        onClick={() => navigate('/')}\r\n                      >\r\n                        Отказ\r\n                      </Button>\r\n                      <Button\r\n                        type=\"submit\"\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        disabled={loading || uploadingImages}\r\n                      >\r\n                        {loading || uploadingImages ? (\r\n                          <CircularProgress size={24} />\r\n                        ) : (\r\n                          'Запази промените'\r\n                        )}\r\n                      </Button>\r\n                    </Box>\r\n                  </Grid>\r\n                </Grid>\r\n              </form>\r\n            </Paper>\r\n          </AnimatedPage>\r\n        </Container>\r\n      </Box>\r\n\r\n      <Dialog\r\n        open={deleteDialogOpen}\r\n        onClose={() => setDeleteDialogOpen(false)}\r\n      >\r\n        <AnimatedPage animation=\"fade\">\r\n          <DialogTitle>Потвърди изтриване</DialogTitle>\r\n          <DialogContent>\r\n            Сигурни ли сте, че искате да изтриете тази обява? Това действие не може да бъде отменено.\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={() => setDeleteDialogOpen(false)}>Отказ</Button>\r\n            <Button onClick={handleDelete} color=\"error\" variant=\"contained\" disabled={loading}>\r\n              {loading ? <CircularProgress size={24} /> : 'Изтрий'}\r\n            </Button>\r\n          </DialogActions>\r\n        </AnimatedPage>\r\n      </Dialog>\r\n    </AnimatedPage>\r\n  );\r\n};\r\n\r\nexport default EditListing; ","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nmodule.exports = trimmedEndIndex;\n","var trimmedEndIndex = require('./_trimmedEndIndex');\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nmodule.exports = baseTrim;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var baseTrim = require('./_baseTrim'),\n    isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","/**\n * @module constants\n * @summary Useful constants\n * @description\n * Collection of useful date constants.\n *\n * The constants could be imported from `date-fns/constants`:\n *\n * ```ts\n * import { maxTime, minTime } from \"./constants/date-fns/constants\";\n *\n * function isAllowedTime(time) {\n *   return time <= maxTime && time >= minTime;\n * }\n * ```\n */\n\n/**\n * @constant\n * @name daysInWeek\n * @summary Days in 1 week.\n */\nexport const daysInWeek = 7;\n\n/**\n * @constant\n * @name daysInYear\n * @summary Days in 1 year.\n *\n * @description\n * How many days in a year.\n *\n * One years equals 365.2425 days according to the formula:\n *\n * > Leap year occurs every 4 years, except for years that are divisible by 100 and not divisible by 400.\n * > 1 mean year = (365+1/4-1/100+1/400) days = 365.2425 days\n */\nexport const daysInYear = 365.2425;\n\n/**\n * @constant\n * @name maxTime\n * @summary Maximum allowed time.\n *\n * @example\n * import { maxTime } from \"./constants/date-fns/constants\";\n *\n * const isValid = 8640000000000001 <= maxTime;\n * //=> false\n *\n * new Date(8640000000000001);\n * //=> Invalid Date\n */\nexport const maxTime = Math.pow(10, 8) * 24 * 60 * 60 * 1000;\n\n/**\n * @constant\n * @name minTime\n * @summary Minimum allowed time.\n *\n * @example\n * import { minTime } from \"./constants/date-fns/constants\";\n *\n * const isValid = -8640000000000001 >= minTime;\n * //=> false\n *\n * new Date(-8640000000000001)\n * //=> Invalid Date\n */\nexport const minTime = -maxTime;\n\n/**\n * @constant\n * @name millisecondsInWeek\n * @summary Milliseconds in 1 week.\n */\nexport const millisecondsInWeek = 604800000;\n\n/**\n * @constant\n * @name millisecondsInDay\n * @summary Milliseconds in 1 day.\n */\nexport const millisecondsInDay = 86400000;\n\n/**\n * @constant\n * @name millisecondsInMinute\n * @summary Milliseconds in 1 minute\n */\nexport const millisecondsInMinute = 60000;\n\n/**\n * @constant\n * @name millisecondsInHour\n * @summary Milliseconds in 1 hour\n */\nexport const millisecondsInHour = 3600000;\n\n/**\n * @constant\n * @name millisecondsInSecond\n * @summary Milliseconds in 1 second\n */\nexport const millisecondsInSecond = 1000;\n\n/**\n * @constant\n * @name minutesInYear\n * @summary Minutes in 1 year.\n */\nexport const minutesInYear = 525600;\n\n/**\n * @constant\n * @name minutesInMonth\n * @summary Minutes in 1 month.\n */\nexport const minutesInMonth = 43200;\n\n/**\n * @constant\n * @name minutesInDay\n * @summary Minutes in 1 day.\n */\nexport const minutesInDay = 1440;\n\n/**\n * @constant\n * @name minutesInHour\n * @summary Minutes in 1 hour.\n */\nexport const minutesInHour = 60;\n\n/**\n * @constant\n * @name monthsInQuarter\n * @summary Months in 1 quarter.\n */\nexport const monthsInQuarter = 3;\n\n/**\n * @constant\n * @name monthsInYear\n * @summary Months in 1 year.\n */\nexport const monthsInYear = 12;\n\n/**\n * @constant\n * @name quartersInYear\n * @summary Quarters in 1 year\n */\nexport const quartersInYear = 4;\n\n/**\n * @constant\n * @name secondsInHour\n * @summary Seconds in 1 hour.\n */\nexport const secondsInHour = 3600;\n\n/**\n * @constant\n * @name secondsInMinute\n * @summary Seconds in 1 minute.\n */\nexport const secondsInMinute = 60;\n\n/**\n * @constant\n * @name secondsInDay\n * @summary Seconds in 1 day.\n */\nexport const secondsInDay = secondsInHour * 24;\n\n/**\n * @constant\n * @name secondsInWeek\n * @summary Seconds in 1 week.\n */\nexport const secondsInWeek = secondsInDay * 7;\n\n/**\n * @constant\n * @name secondsInYear\n * @summary Seconds in 1 year.\n */\nexport const secondsInYear = secondsInDay * daysInYear;\n\n/**\n * @constant\n * @name secondsInMonth\n * @summary Seconds in 1 month\n */\nexport const secondsInMonth = secondsInYear / 12;\n\n/**\n * @constant\n * @name secondsInQuarter\n * @summary Seconds in 1 quarter.\n */\nexport const secondsInQuarter = secondsInMonth * 3;\n\n/**\n * @constant\n * @name constructFromSymbol\n * @summary Symbol enabling Date extensions to inherit properties from the reference date.\n *\n * The symbol is used to enable the `constructFrom` function to construct a date\n * using a reference date and a value. It allows to transfer extra properties\n * from the reference date to the new date. It's useful for extensions like\n * [`TZDate`](https://github.com/date-fns/tz) that accept a time zone as\n * a constructor argument.\n */\nexport const constructFromSymbol = Symbol.for(\"constructDateFrom\");\n","import { constructFromSymbol } from \"./constants.js\";\n\n/**\n * @name constructFrom\n * @category Generic Helpers\n * @summary Constructs a date using the reference date and the value\n *\n * @description\n * The function constructs a new date using the constructor from the reference\n * date and the given value. It helps to build generic functions that accept\n * date extensions.\n *\n * It defaults to `Date` if the passed reference date is a number or a string.\n *\n * Starting from v3.7.0, it allows to construct a date using `[Symbol.for(\"constructDateFrom\")]`\n * enabling to transfer extra properties from the reference date to the new date.\n * It's useful for extensions like [`TZDate`](https://github.com/date-fns/tz)\n * that accept a time zone as a constructor argument.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n *\n * @param date - The reference date to take constructor from\n * @param value - The value to create the date\n *\n * @returns Date initialized using the given date and value\n *\n * @example\n * import { constructFrom } from \"./constructFrom/date-fns\";\n *\n * // A function that clones a date preserving the original type\n * function cloneDate<DateType extends Date>(date: DateType): DateType {\n *   return constructFrom(\n *     date, // Use constructor from the given date\n *     date.getTime() // Use the date value to create a new date\n *   );\n * }\n */\nexport function constructFrom(date, value) {\n  if (typeof date === \"function\") return date(value);\n\n  if (date && typeof date === \"object\" && constructFromSymbol in date)\n    return date[constructFromSymbol](value);\n\n  if (date instanceof Date) return new date.constructor(value);\n\n  return new Date(value);\n}\n\n// Fallback for modularized imports:\nexport default constructFrom;\n","import { constructFrom } from \"./constructFrom.js\";\n\n/**\n * @name toDate\n * @category Common Helpers\n * @summary Convert the given argument to an instance of Date.\n *\n * @description\n * Convert the given argument to an instance of Date.\n *\n * If the argument is an instance of Date, the function returns its clone.\n *\n * If the argument is a number, it is treated as a timestamp.\n *\n * If the argument is none of the above, the function returns Invalid Date.\n *\n * Starting from v3.7.0, it clones a date using `[Symbol.for(\"constructDateFrom\")]`\n * enabling to transfer extra properties from the reference date to the new date.\n * It's useful for extensions like [`TZDate`](https://github.com/date-fns/tz)\n * that accept a time zone as a constructor argument.\n *\n * **Note**: *all* Date arguments passed to any *date-fns* function is processed by `toDate`.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param argument - The value to convert\n *\n * @returns The parsed date in the local time zone\n *\n * @example\n * // Clone the date:\n * const result = toDate(new Date(2014, 1, 11, 11, 30, 30))\n * //=> Tue Feb 11 2014 11:30:30\n *\n * @example\n * // Convert the timestamp to date:\n * const result = toDate(1392098430000)\n * //=> Tue Feb 11 2014 11:30:30\n */\nexport function toDate(argument, context) {\n  // [TODO] Get rid of `toDate` or `constructFrom`?\n  return constructFrom(context || argument, argument);\n}\n\n// Fallback for modularized imports:\nexport default toDate;\n","import { constructFrom } from \"./constructFrom.js\";\nimport { toDate } from \"./toDate.js\";\n\n/**\n * The {@link addDays} function options.\n */\n\n/**\n * @name addDays\n * @category Day Helpers\n * @summary Add the specified number of days to the given date.\n *\n * @description\n * Add the specified number of days to the given date.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The date to be changed\n * @param amount - The amount of days to be added.\n * @param options - An object with options\n *\n * @returns The new date with the days added\n *\n * @example\n * // Add 10 days to 1 September 2014:\n * const result = addDays(new Date(2014, 8, 1), 10)\n * //=> Thu Sep 11 2014 00:00:00\n */\nexport function addDays(date, amount, options) {\n  const _date = toDate(date, options?.in);\n  if (isNaN(amount)) return constructFrom(options?.in || date, NaN);\n\n  // If 0 days, no-op to avoid changing times in the hour before end of DST\n  if (!amount) return _date;\n\n  _date.setDate(_date.getDate() + amount);\n  return _date;\n}\n\n// Fallback for modularized imports:\nexport default addDays;\n","let defaultOptions = {};\n\nexport function getDefaultOptions() {\n  return defaultOptions;\n}\n\nexport function setDefaultOptions(newOptions) {\n  defaultOptions = newOptions;\n}\n","import { getDefaultOptions } from \"./_lib/defaultOptions.js\";\nimport { toDate } from \"./toDate.js\";\n\n/**\n * The {@link startOfWeek} function options.\n */\n\n/**\n * @name startOfWeek\n * @category Week Helpers\n * @summary Return the start of a week for the given date.\n *\n * @description\n * Return the start of a week for the given date.\n * The result will be in the local timezone.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The original date\n * @param options - An object with options\n *\n * @returns The start of a week\n *\n * @example\n * // The start of a week for 2 September 2014 11:55:00:\n * const result = startOfWeek(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Sun Aug 31 2014 00:00:00\n *\n * @example\n * // If the week starts on Monday, the start of the week for 2 September 2014 11:55:00:\n * const result = startOfWeek(new Date(2014, 8, 2, 11, 55, 0), { weekStartsOn: 1 })\n * //=> Mon Sep 01 2014 00:00:00\n */\nexport function startOfWeek(date, options) {\n  const defaultOptions = getDefaultOptions();\n  const weekStartsOn =\n    options?.weekStartsOn ??\n    options?.locale?.options?.weekStartsOn ??\n    defaultOptions.weekStartsOn ??\n    defaultOptions.locale?.options?.weekStartsOn ??\n    0;\n\n  const _date = toDate(date, options?.in);\n  const day = _date.getDay();\n  const diff = (day < weekStartsOn ? 7 : 0) + day - weekStartsOn;\n\n  _date.setDate(_date.getDate() - diff);\n  _date.setHours(0, 0, 0, 0);\n  return _date;\n}\n\n// Fallback for modularized imports:\nexport default startOfWeek;\n","import { startOfWeek } from \"./startOfWeek.js\";\n\n/**\n * The {@link startOfISOWeek} function options.\n */\n\n/**\n * @name startOfISOWeek\n * @category ISO Week Helpers\n * @summary Return the start of an ISO week for the given date.\n *\n * @description\n * Return the start of an ISO week for the given date.\n * The result will be in the local timezone.\n *\n * ISO week-numbering year: http://en.wikipedia.org/wiki/ISO_week_date\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The original date\n * @param options - An object with options\n *\n * @returns The start of an ISO week\n *\n * @example\n * // The start of an ISO week for 2 September 2014 11:55:00:\n * const result = startOfISOWeek(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Mon Sep 01 2014 00:00:00\n */\nexport function startOfISOWeek(date, options) {\n  return startOfWeek(date, { ...options, weekStartsOn: 1 });\n}\n\n// Fallback for modularized imports:\nexport default startOfISOWeek;\n","import { constructFrom } from \"./constructFrom.js\";\nimport { startOfISOWeek } from \"./startOfISOWeek.js\";\nimport { toDate } from \"./toDate.js\";\n\n/**\n * The {@link getISOWeekYear} function options.\n */\n\n/**\n * @name getISOWeekYear\n * @category ISO Week-Numbering Year Helpers\n * @summary Get the ISO week-numbering year of the given date.\n *\n * @description\n * Get the ISO week-numbering year of the given date,\n * which always starts 3 days before the year's first Thursday.\n *\n * ISO week-numbering year: http://en.wikipedia.org/wiki/ISO_week_date\n *\n * @param date - The given date\n *\n * @returns The ISO week-numbering year\n *\n * @example\n * // Which ISO-week numbering year is 2 January 2005?\n * const result = getISOWeekYear(new Date(2005, 0, 2))\n * //=> 2004\n */\nexport function getISOWeekYear(date, options) {\n  const _date = toDate(date, options?.in);\n  const year = _date.getFullYear();\n\n  const fourthOfJanuaryOfNextYear = constructFrom(_date, 0);\n  fourthOfJanuaryOfNextYear.setFullYear(year + 1, 0, 4);\n  fourthOfJanuaryOfNextYear.setHours(0, 0, 0, 0);\n  const startOfNextYear = startOfISOWeek(fourthOfJanuaryOfNextYear);\n\n  const fourthOfJanuaryOfThisYear = constructFrom(_date, 0);\n  fourthOfJanuaryOfThisYear.setFullYear(year, 0, 4);\n  fourthOfJanuaryOfThisYear.setHours(0, 0, 0, 0);\n  const startOfThisYear = startOfISOWeek(fourthOfJanuaryOfThisYear);\n\n  if (_date.getTime() >= startOfNextYear.getTime()) {\n    return year + 1;\n  } else if (_date.getTime() >= startOfThisYear.getTime()) {\n    return year;\n  } else {\n    return year - 1;\n  }\n}\n\n// Fallback for modularized imports:\nexport default getISOWeekYear;\n","import { toDate } from \"../toDate.js\";\n\n/**\n * Google Chrome as of 67.0.3396.87 introduced timezones with offset that includes seconds.\n * They usually appear for dates that denote time before the timezones were introduced\n * (e.g. for 'Europe/Prague' timezone the offset is GMT+00:57:44 before 1 October 1891\n * and GMT+01:00:00 after that date)\n *\n * Date#getTimezoneOffset returns the offset in minutes and would return 57 for the example above,\n * which would lead to incorrect calculations.\n *\n * This function returns the timezone offset in milliseconds that takes seconds in account.\n */\nexport function getTimezoneOffsetInMilliseconds(date) {\n  const _date = toDate(date);\n  const utcDate = new Date(\n    Date.UTC(\n      _date.getFullYear(),\n      _date.getMonth(),\n      _date.getDate(),\n      _date.getHours(),\n      _date.getMinutes(),\n      _date.getSeconds(),\n      _date.getMilliseconds(),\n    ),\n  );\n  utcDate.setUTCFullYear(_date.getFullYear());\n  return +date - +utcDate;\n}\n","import { constructFrom } from \"../constructFrom.js\";\n\nexport function normalizeDates(context, ...dates) {\n  const normalize = constructFrom.bind(\n    null,\n    context || dates.find((date) => typeof date === \"object\"),\n  );\n  return dates.map(normalize);\n}\n","import { toDate } from \"./toDate.js\";\n\n/**\n * The {@link startOfDay} function options.\n */\n\n/**\n * @name startOfDay\n * @category Day Helpers\n * @summary Return the start of a day for the given date.\n *\n * @description\n * Return the start of a day for the given date.\n * The result will be in the local timezone.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The original date\n * @param options - The options\n *\n * @returns The start of a day\n *\n * @example\n * // The start of a day for 2 September 2014 11:55:00:\n * const result = startOfDay(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 02 2014 00:00:00\n */\nexport function startOfDay(date, options) {\n  const _date = toDate(date, options?.in);\n  _date.setHours(0, 0, 0, 0);\n  return _date;\n}\n\n// Fallback for modularized imports:\nexport default startOfDay;\n","import { getTimezoneOffsetInMilliseconds } from \"./_lib/getTimezoneOffsetInMilliseconds.js\";\nimport { normalizeDates } from \"./_lib/normalizeDates.js\";\nimport { millisecondsInDay } from \"./constants.js\";\nimport { startOfDay } from \"./startOfDay.js\";\n\n/**\n * The {@link differenceInCalendarDays} function options.\n */\n\n/**\n * @name differenceInCalendarDays\n * @category Day Helpers\n * @summary Get the number of calendar days between the given dates.\n *\n * @description\n * Get the number of calendar days between the given dates. This means that the times are removed\n * from the dates and then the difference in days is calculated.\n *\n * @param laterDate - The later date\n * @param earlierDate - The earlier date\n * @param options - The options object\n *\n * @returns The number of calendar days\n *\n * @example\n * // How many calendar days are between\n * // 2 July 2011 23:00:00 and 2 July 2012 00:00:00?\n * const result = differenceInCalendarDays(\n *   new Date(2012, 6, 2, 0, 0),\n *   new Date(2011, 6, 2, 23, 0)\n * )\n * //=> 366\n * // How many calendar days are between\n * // 2 July 2011 23:59:00 and 3 July 2011 00:01:00?\n * const result = differenceInCalendarDays(\n *   new Date(2011, 6, 3, 0, 1),\n *   new Date(2011, 6, 2, 23, 59)\n * )\n * //=> 1\n */\nexport function differenceInCalendarDays(laterDate, earlierDate, options) {\n  const [laterDate_, earlierDate_] = normalizeDates(\n    options?.in,\n    laterDate,\n    earlierDate,\n  );\n\n  const laterStartOfDay = startOfDay(laterDate_);\n  const earlierStartOfDay = startOfDay(earlierDate_);\n\n  const laterTimestamp =\n    +laterStartOfDay - getTimezoneOffsetInMilliseconds(laterStartOfDay);\n  const earlierTimestamp =\n    +earlierStartOfDay - getTimezoneOffsetInMilliseconds(earlierStartOfDay);\n\n  // Round the number of days to the nearest integer because the number of\n  // milliseconds in a day is not constant (e.g. it's different in the week of\n  // the daylight saving time clock shift).\n  return Math.round((laterTimestamp - earlierTimestamp) / millisecondsInDay);\n}\n\n// Fallback for modularized imports:\nexport default differenceInCalendarDays;\n","import { constructFrom } from \"./constructFrom.js\";\nimport { getISOWeekYear } from \"./getISOWeekYear.js\";\nimport { startOfISOWeek } from \"./startOfISOWeek.js\";\n\n/**\n * The {@link startOfISOWeekYear} function options.\n */\n\n/**\n * @name startOfISOWeekYear\n * @category ISO Week-Numbering Year Helpers\n * @summary Return the start of an ISO week-numbering year for the given date.\n *\n * @description\n * Return the start of an ISO week-numbering year,\n * which always starts 3 days before the year's first Thursday.\n * The result will be in the local timezone.\n *\n * ISO week-numbering year: http://en.wikipedia.org/wiki/ISO_week_date\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The original date\n * @param options - An object with options\n *\n * @returns The start of an ISO week-numbering year\n *\n * @example\n * // The start of an ISO week-numbering year for 2 July 2005:\n * const result = startOfISOWeekYear(new Date(2005, 6, 2))\n * //=> Mon Jan 03 2005 00:00:00\n */\nexport function startOfISOWeekYear(date, options) {\n  const year = getISOWeekYear(date, options);\n  const fourthOfJanuary = constructFrom(options?.in || date, 0);\n  fourthOfJanuary.setFullYear(year, 0, 4);\n  fourthOfJanuary.setHours(0, 0, 0, 0);\n  return startOfISOWeek(fourthOfJanuary);\n}\n\n// Fallback for modularized imports:\nexport default startOfISOWeekYear;\n","import { toDate } from \"./toDate.js\";\n\n/**\n * @name compareAsc\n * @category Common Helpers\n * @summary Compare the two dates and return -1, 0 or 1.\n *\n * @description\n * Compare the two dates and return 1 if the first date is after the second,\n * -1 if the first date is before the second or 0 if dates are equal.\n *\n * @param dateLeft - The first date to compare\n * @param dateRight - The second date to compare\n *\n * @returns The result of the comparison\n *\n * @example\n * // Compare 11 February 1987 and 10 July 1989:\n * const result = compareAsc(new Date(1987, 1, 11), new Date(1989, 6, 10))\n * //=> -1\n *\n * @example\n * // Sort the array of dates:\n * const result = [\n *   new Date(1995, 6, 2),\n *   new Date(1987, 1, 11),\n *   new Date(1989, 6, 10)\n * ].sort(compareAsc)\n * //=> [\n * //   Wed Feb 11 1987 00:00:00,\n * //   Mon Jul 10 1989 00:00:00,\n * //   Sun Jul 02 1995 00:00:00\n * // ]\n */\nexport function compareAsc(dateLeft, dateRight) {\n  const diff = +toDate(dateLeft) - +toDate(dateRight);\n\n  if (diff < 0) return -1;\n  else if (diff > 0) return 1;\n\n  // Return 0 if diff is 0; return NaN if diff is NaN\n  return diff;\n}\n\n// Fallback for modularized imports:\nexport default compareAsc;\n","import { constructFrom } from \"./constructFrom.js\";\n\n/**\n * @name constructNow\n * @category Generic Helpers\n * @summary Constructs a new current date using the passed value constructor.\n * @pure false\n *\n * @description\n * The function constructs a new current date using the constructor from\n * the reference date. It helps to build generic functions that accept date\n * extensions and use the current date.\n *\n * It defaults to `Date` if the passed reference date is a number or a string.\n *\n * @param date - The reference date to take constructor from\n *\n * @returns Current date initialized using the given date constructor\n *\n * @example\n * import { constructNow, isSameDay } from 'date-fns'\n *\n * function isToday<DateType extends Date>(\n *   date: DateArg<DateType>,\n * ): boolean {\n *   // If we were to use `new Date()` directly, the function would  behave\n *   // differently in different timezones and return false for the same date.\n *   return isSameDay(date, constructNow(date));\n * }\n */\nexport function constructNow(date) {\n  return constructFrom(date, Date.now());\n}\n\n// Fallback for modularized imports:\nexport default constructNow;\n","import { normalizeDates } from \"./_lib/normalizeDates.js\";\nimport { startOfDay } from \"./startOfDay.js\";\n\n/**\n * The {@link isSameDay} function options.\n */\n\n/**\n * @name isSameDay\n * @category Day Helpers\n * @summary Are the given dates in the same day (and year and month)?\n *\n * @description\n * Are the given dates in the same day (and year and month)?\n *\n * @param laterDate - The first date to check\n * @param earlierDate - The second date to check\n * @param options - An object with options\n *\n * @returns The dates are in the same day (and year and month)\n *\n * @example\n * // Are 4 September 06:00:00 and 4 September 18:00:00 in the same day?\n * const result = isSameDay(new Date(2014, 8, 4, 6, 0), new Date(2014, 8, 4, 18, 0))\n * //=> true\n *\n * @example\n * // Are 4 September and 4 October in the same day?\n * const result = isSameDay(new Date(2014, 8, 4), new Date(2014, 9, 4))\n * //=> false\n *\n * @example\n * // Are 4 September, 2014 and 4 September, 2015 in the same day?\n * const result = isSameDay(new Date(2014, 8, 4), new Date(2015, 8, 4))\n * //=> false\n */\nexport function isSameDay(laterDate, earlierDate, options) {\n  const [dateLeft_, dateRight_] = normalizeDates(\n    options?.in,\n    laterDate,\n    earlierDate,\n  );\n  return +startOfDay(dateLeft_) === +startOfDay(dateRight_);\n}\n\n// Fallback for modularized imports:\nexport default isSameDay;\n","/**\n * @name isDate\n * @category Common Helpers\n * @summary Is the given value a date?\n *\n * @description\n * Returns true if the given value is an instance of Date. The function works for dates transferred across iframes.\n *\n * @param value - The value to check\n *\n * @returns True if the given value is a date\n *\n * @example\n * // For a valid date:\n * const result = isDate(new Date())\n * //=> true\n *\n * @example\n * // For an invalid date:\n * const result = isDate(new Date(NaN))\n * //=> true\n *\n * @example\n * // For some value:\n * const result = isDate('2014-02-31')\n * //=> false\n *\n * @example\n * // For an object:\n * const result = isDate({})\n * //=> false\n */\nexport function isDate(value) {\n  return (\n    value instanceof Date ||\n    (typeof value === \"object\" &&\n      Object.prototype.toString.call(value) === \"[object Date]\")\n  );\n}\n\n// Fallback for modularized imports:\nexport default isDate;\n","import { isDate } from \"./isDate.js\";\nimport { toDate } from \"./toDate.js\";\n\n/**\n * @name isValid\n * @category Common Helpers\n * @summary Is the given date valid?\n *\n * @description\n * Returns false if argument is Invalid Date and true otherwise.\n * Argument is converted to Date using `toDate`. See [toDate](https://date-fns.org/docs/toDate)\n * Invalid Date is a Date, whose time value is NaN.\n *\n * Time value of Date: http://es5.github.io/#x15.9.1.1\n *\n * @param date - The date to check\n *\n * @returns The date is valid\n *\n * @example\n * // For the valid date:\n * const result = isValid(new Date(2014, 1, 31))\n * //=> true\n *\n * @example\n * // For the value, convertible into a date:\n * const result = isValid(1393804800000)\n * //=> true\n *\n * @example\n * // For the invalid date:\n * const result = isValid(new Date(''))\n * //=> false\n */\nexport function isValid(date) {\n  return !((!isDate(date) && typeof date !== \"number\") || isNaN(+toDate(date)));\n}\n\n// Fallback for modularized imports:\nexport default isValid;\n","import { normalizeDates } from \"./_lib/normalizeDates.js\";\n\n/**\n * The {@link differenceInCalendarMonths} function options.\n */\n\n/**\n * @name differenceInCalendarMonths\n * @category Month Helpers\n * @summary Get the number of calendar months between the given dates.\n *\n * @description\n * Get the number of calendar months between the given dates.\n *\n * @param laterDate - The later date\n * @param earlierDate - The earlier date\n * @param options - An object with options\n *\n * @returns The number of calendar months\n *\n * @example\n * // How many calendar months are between 31 January 2014 and 1 September 2014?\n * const result = differenceInCalendarMonths(\n *   new Date(2014, 8, 1),\n *   new Date(2014, 0, 31)\n * )\n * //=> 8\n */\nexport function differenceInCalendarMonths(laterDate, earlierDate, options) {\n  const [laterDate_, earlierDate_] = normalizeDates(\n    options?.in,\n    laterDate,\n    earlierDate,\n  );\n\n  const yearsDiff = laterDate_.getFullYear() - earlierDate_.getFullYear();\n  const monthsDiff = laterDate_.getMonth() - earlierDate_.getMonth();\n\n  return yearsDiff * 12 + monthsDiff;\n}\n\n// Fallback for modularized imports:\nexport default differenceInCalendarMonths;\n","export function getRoundingMethod(method) {\n  return (number) => {\n    const round = method ? Math[method] : Math.trunc;\n    const result = round(number);\n    // Prevent negative zero\n    return result === 0 ? 0 : result;\n  };\n}\n","import { toDate } from \"./toDate.js\";\n\n/**\n * @name differenceInMilliseconds\n * @category Millisecond Helpers\n * @summary Get the number of milliseconds between the given dates.\n *\n * @description\n * Get the number of milliseconds between the given dates.\n *\n * @param laterDate - The later date\n * @param earlierDate - The earlier date\n *\n * @returns The number of milliseconds\n *\n * @example\n * // How many milliseconds are between\n * // 2 July 2014 12:30:20.600 and 2 July 2014 12:30:21.700?\n * const result = differenceInMilliseconds(\n *   new Date(2014, 6, 2, 12, 30, 21, 700),\n *   new Date(2014, 6, 2, 12, 30, 20, 600)\n * )\n * //=> 1100\n */\nexport function differenceInMilliseconds(laterDate, earlierDate) {\n  return +toDate(laterDate) - +toDate(earlierDate);\n}\n\n// Fallback for modularized imports:\nexport default differenceInMilliseconds;\n","import { toDate } from \"./toDate.js\";\n\n/**\n * The {@link endOfDay} function options.\n */\n\n/**\n * @name endOfDay\n * @category Day Helpers\n * @summary Return the end of a day for the given date.\n *\n * @description\n * Return the end of a day for the given date.\n * The result will be in the local timezone.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The original date\n * @param options - An object with options\n *\n * @returns The end of a day\n *\n * @example\n * // The end of a day for 2 September 2014 11:55:00:\n * const result = endOfDay(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 02 2014 23:59:59.999\n */\nexport function endOfDay(date, options) {\n  const _date = toDate(date, options?.in);\n  _date.setHours(23, 59, 59, 999);\n  return _date;\n}\n\n// Fallback for modularized imports:\nexport default endOfDay;\n","import { toDate } from \"./toDate.js\";\n\n/**\n * The {@link endOfMonth} function options.\n */\n\n/**\n * @name endOfMonth\n * @category Month Helpers\n * @summary Return the end of a month for the given date.\n *\n * @description\n * Return the end of a month for the given date.\n * The result will be in the local timezone.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The original date\n * @param options - An object with options\n *\n * @returns The end of a month\n *\n * @example\n * // The end of a month for 2 September 2014 11:55:00:\n * const result = endOfMonth(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 30 2014 23:59:59.999\n */\nexport function endOfMonth(date, options) {\n  const _date = toDate(date, options?.in);\n  const month = _date.getMonth();\n  _date.setFullYear(_date.getFullYear(), month + 1, 0);\n  _date.setHours(23, 59, 59, 999);\n  return _date;\n}\n\n// Fallback for modularized imports:\nexport default endOfMonth;\n","import { endOfDay } from \"./endOfDay.js\";\nimport { endOfMonth } from \"./endOfMonth.js\";\nimport { toDate } from \"./toDate.js\";\n\n/**\n * @name isLastDayOfMonth\n * @category Month Helpers\n * @summary Is the given date the last day of a month?\n *\n * @description\n * Is the given date the last day of a month?\n *\n * @param date - The date to check\n * @param options - An object with options\n *\n * @returns The date is the last day of a month\n *\n * @example\n * // Is 28 February 2014 the last day of a month?\n * const result = isLastDayOfMonth(new Date(2014, 1, 28))\n * //=> true\n */\nexport function isLastDayOfMonth(date, options) {\n  const _date = toDate(date, options?.in);\n  return +endOfDay(_date, options) === +endOfMonth(_date, options);\n}\n\n// Fallback for modularized imports:\nexport default isLastDayOfMonth;\n","import { normalizeDates } from \"./_lib/normalizeDates.js\";\nimport { compareAsc } from \"./compareAsc.js\";\nimport { differenceInCalendarMonths } from \"./differenceInCalendarMonths.js\";\nimport { isLastDayOfMonth } from \"./isLastDayOfMonth.js\";\n\n/**\n * The {@link differenceInMonths} function options.\n */\n\n/**\n * @name differenceInMonths\n * @category Month Helpers\n * @summary Get the number of full months between the given dates.\n *\n * @param laterDate - The later date\n * @param earlierDate - The earlier date\n * @param options - An object with options\n *\n * @returns The number of full months\n *\n * @example\n * // How many full months are between 31 January 2014 and 1 September 2014?\n * const result = differenceInMonths(new Date(2014, 8, 1), new Date(2014, 0, 31))\n * //=> 7\n */\nexport function differenceInMonths(laterDate, earlierDate, options) {\n  const [laterDate_, workingLaterDate, earlierDate_] = normalizeDates(\n    options?.in,\n    laterDate,\n    laterDate,\n    earlierDate,\n  );\n\n  const sign = compareAsc(workingLaterDate, earlierDate_);\n  const difference = Math.abs(\n    differenceInCalendarMonths(workingLaterDate, earlierDate_),\n  );\n\n  if (difference < 1) return 0;\n\n  if (workingLaterDate.getMonth() === 1 && workingLaterDate.getDate() > 27)\n    workingLaterDate.setDate(30);\n\n  workingLaterDate.setMonth(workingLaterDate.getMonth() - sign * difference);\n\n  let isLastMonthNotFull = compareAsc(workingLaterDate, earlierDate_) === -sign;\n\n  if (\n    isLastDayOfMonth(laterDate_) &&\n    difference === 1 &&\n    compareAsc(laterDate_, earlierDate_) === 1\n  ) {\n    isLastMonthNotFull = false;\n  }\n\n  const result = sign * (difference - +isLastMonthNotFull);\n  return result === 0 ? 0 : result;\n}\n\n// Fallback for modularized imports:\nexport default differenceInMonths;\n","import { getRoundingMethod } from \"./_lib/getRoundingMethod.js\";\nimport { differenceInMilliseconds } from \"./differenceInMilliseconds.js\";\n\n/**\n * The {@link differenceInSeconds} function options.\n */\n\n/**\n * @name differenceInSeconds\n * @category Second Helpers\n * @summary Get the number of seconds between the given dates.\n *\n * @description\n * Get the number of seconds between the given dates.\n *\n * @param laterDate - The later date\n * @param earlierDate - The earlier date\n * @param options - An object with options.\n *\n * @returns The number of seconds\n *\n * @example\n * // How many seconds are between\n * // 2 July 2014 12:30:07.999 and 2 July 2014 12:30:20.000?\n * const result = differenceInSeconds(\n *   new Date(2014, 6, 2, 12, 30, 20, 0),\n *   new Date(2014, 6, 2, 12, 30, 7, 999)\n * )\n * //=> 12\n */\nexport function differenceInSeconds(laterDate, earlierDate, options) {\n  const diff = differenceInMilliseconds(laterDate, earlierDate) / 1000;\n  return getRoundingMethod(options?.roundingMethod)(diff);\n}\n\n// Fallback for modularized imports:\nexport default differenceInSeconds;\n","import { toDate } from \"./toDate.js\";\n\n/**\n * The {@link startOfYear} function options.\n */\n\n/**\n * @name startOfYear\n * @category Year Helpers\n * @summary Return the start of a year for the given date.\n *\n * @description\n * Return the start of a year for the given date.\n * The result will be in the local timezone.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The original date\n * @param options - The options\n *\n * @returns The start of a year\n *\n * @example\n * // The start of a year for 2 September 2014 11:55:00:\n * const result = startOfYear(new Date(2014, 8, 2, 11, 55, 00))\n * //=> Wed Jan 01 2014 00:00:00\n */\nexport function startOfYear(date, options) {\n  const date_ = toDate(date, options?.in);\n  date_.setFullYear(date_.getFullYear(), 0, 1);\n  date_.setHours(0, 0, 0, 0);\n  return date_;\n}\n\n// Fallback for modularized imports:\nexport default startOfYear;\n","const formatDistanceLocale = {\n  lessThanXSeconds: {\n    one: \"less than a second\",\n    other: \"less than {{count}} seconds\",\n  },\n\n  xSeconds: {\n    one: \"1 second\",\n    other: \"{{count}} seconds\",\n  },\n\n  halfAMinute: \"half a minute\",\n\n  lessThanXMinutes: {\n    one: \"less than a minute\",\n    other: \"less than {{count}} minutes\",\n  },\n\n  xMinutes: {\n    one: \"1 minute\",\n    other: \"{{count}} minutes\",\n  },\n\n  aboutXHours: {\n    one: \"about 1 hour\",\n    other: \"about {{count}} hours\",\n  },\n\n  xHours: {\n    one: \"1 hour\",\n    other: \"{{count}} hours\",\n  },\n\n  xDays: {\n    one: \"1 day\",\n    other: \"{{count}} days\",\n  },\n\n  aboutXWeeks: {\n    one: \"about 1 week\",\n    other: \"about {{count}} weeks\",\n  },\n\n  xWeeks: {\n    one: \"1 week\",\n    other: \"{{count}} weeks\",\n  },\n\n  aboutXMonths: {\n    one: \"about 1 month\",\n    other: \"about {{count}} months\",\n  },\n\n  xMonths: {\n    one: \"1 month\",\n    other: \"{{count}} months\",\n  },\n\n  aboutXYears: {\n    one: \"about 1 year\",\n    other: \"about {{count}} years\",\n  },\n\n  xYears: {\n    one: \"1 year\",\n    other: \"{{count}} years\",\n  },\n\n  overXYears: {\n    one: \"over 1 year\",\n    other: \"over {{count}} years\",\n  },\n\n  almostXYears: {\n    one: \"almost 1 year\",\n    other: \"almost {{count}} years\",\n  },\n};\n\nexport const formatDistance = (token, count, options) => {\n  let result;\n\n  const tokenValue = formatDistanceLocale[token];\n  if (typeof tokenValue === \"string\") {\n    result = tokenValue;\n  } else if (count === 1) {\n    result = tokenValue.one;\n  } else {\n    result = tokenValue.other.replace(\"{{count}}\", count.toString());\n  }\n\n  if (options?.addSuffix) {\n    if (options.comparison && options.comparison > 0) {\n      return \"in \" + result;\n    } else {\n      return result + \" ago\";\n    }\n  }\n\n  return result;\n};\n","export function buildFormatLongFn(args) {\n  return (options = {}) => {\n    // TODO: Remove String()\n    const width = options.width ? String(options.width) : args.defaultWidth;\n    const format = args.formats[width] || args.formats[args.defaultWidth];\n    return format;\n  };\n}\n","import { buildFormatLongFn } from \"../../_lib/buildFormatLongFn.js\";\n\nconst dateFormats = {\n  full: \"EEEE, MMMM do, y\",\n  long: \"MMMM do, y\",\n  medium: \"MMM d, y\",\n  short: \"MM/dd/yyyy\",\n};\n\nconst timeFormats = {\n  full: \"h:mm:ss a zzzz\",\n  long: \"h:mm:ss a z\",\n  medium: \"h:mm:ss a\",\n  short: \"h:mm a\",\n};\n\nconst dateTimeFormats = {\n  full: \"{{date}} 'at' {{time}}\",\n  long: \"{{date}} 'at' {{time}}\",\n  medium: \"{{date}}, {{time}}\",\n  short: \"{{date}}, {{time}}\",\n};\n\nexport const formatLong = {\n  date: buildFormatLongFn({\n    formats: dateFormats,\n    defaultWidth: \"full\",\n  }),\n\n  time: buildFormatLongFn({\n    formats: timeFormats,\n    defaultWidth: \"full\",\n  }),\n\n  dateTime: buildFormatLongFn({\n    formats: dateTimeFormats,\n    defaultWidth: \"full\",\n  }),\n};\n","const formatRelativeLocale = {\n  lastWeek: \"'last' eeee 'at' p\",\n  yesterday: \"'yesterday at' p\",\n  today: \"'today at' p\",\n  tomorrow: \"'tomorrow at' p\",\n  nextWeek: \"eeee 'at' p\",\n  other: \"P\",\n};\n\nexport const formatRelative = (token, _date, _baseDate, _options) =>\n  formatRelativeLocale[token];\n","/**\n * The localize function argument callback which allows to convert raw value to\n * the actual type.\n *\n * @param value - The value to convert\n *\n * @returns The converted value\n */\n\n/**\n * The map of localized values for each width.\n */\n\n/**\n * The index type of the locale unit value. It types conversion of units of\n * values that don't start at 0 (i.e. quarters).\n */\n\n/**\n * Converts the unit value to the tuple of values.\n */\n\n/**\n * The tuple of localized era values. The first element represents BC,\n * the second element represents AD.\n */\n\n/**\n * The tuple of localized quarter values. The first element represents Q1.\n */\n\n/**\n * The tuple of localized day values. The first element represents Sunday.\n */\n\n/**\n * The tuple of localized month values. The first element represents January.\n */\n\nexport function buildLocalizeFn(args) {\n  return (value, options) => {\n    const context = options?.context ? String(options.context) : \"standalone\";\n\n    let valuesArray;\n    if (context === \"formatting\" && args.formattingValues) {\n      const defaultWidth = args.defaultFormattingWidth || args.defaultWidth;\n      const width = options?.width ? String(options.width) : defaultWidth;\n\n      valuesArray =\n        args.formattingValues[width] || args.formattingValues[defaultWidth];\n    } else {\n      const defaultWidth = args.defaultWidth;\n      const width = options?.width ? String(options.width) : args.defaultWidth;\n\n      valuesArray = args.values[width] || args.values[defaultWidth];\n    }\n    const index = args.argumentCallback ? args.argumentCallback(value) : value;\n\n    // @ts-expect-error - For some reason TypeScript just don't want to match it, no matter how hard we try. I challenge you to try to remove it!\n    return valuesArray[index];\n  };\n}\n","import { buildLocalizeFn } from \"../../_lib/buildLocalizeFn.js\";\n\nconst eraValues = {\n  narrow: [\"B\", \"A\"],\n  abbreviated: [\"BC\", \"AD\"],\n  wide: [\"Before Christ\", \"Anno Domini\"],\n};\n\nconst quarterValues = {\n  narrow: [\"1\", \"2\", \"3\", \"4\"],\n  abbreviated: [\"Q1\", \"Q2\", \"Q3\", \"Q4\"],\n  wide: [\"1st quarter\", \"2nd quarter\", \"3rd quarter\", \"4th quarter\"],\n};\n\n// Note: in English, the names of days of the week and months are capitalized.\n// If you are making a new locale based on this one, check if the same is true for the language you're working on.\n// Generally, formatted dates should look like they are in the middle of a sentence,\n// e.g. in Spanish language the weekdays and months should be in the lowercase.\nconst monthValues = {\n  narrow: [\"J\", \"F\", \"M\", \"A\", \"M\", \"J\", \"J\", \"A\", \"S\", \"O\", \"N\", \"D\"],\n  abbreviated: [\n    \"Jan\",\n    \"Feb\",\n    \"Mar\",\n    \"Apr\",\n    \"May\",\n    \"Jun\",\n    \"Jul\",\n    \"Aug\",\n    \"Sep\",\n    \"Oct\",\n    \"Nov\",\n    \"Dec\",\n  ],\n\n  wide: [\n    \"January\",\n    \"February\",\n    \"March\",\n    \"April\",\n    \"May\",\n    \"June\",\n    \"July\",\n    \"August\",\n    \"September\",\n    \"October\",\n    \"November\",\n    \"December\",\n  ],\n};\n\nconst dayValues = {\n  narrow: [\"S\", \"M\", \"T\", \"W\", \"T\", \"F\", \"S\"],\n  short: [\"Su\", \"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\"],\n  abbreviated: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n  wide: [\n    \"Sunday\",\n    \"Monday\",\n    \"Tuesday\",\n    \"Wednesday\",\n    \"Thursday\",\n    \"Friday\",\n    \"Saturday\",\n  ],\n};\n\nconst dayPeriodValues = {\n  narrow: {\n    am: \"a\",\n    pm: \"p\",\n    midnight: \"mi\",\n    noon: \"n\",\n    morning: \"morning\",\n    afternoon: \"afternoon\",\n    evening: \"evening\",\n    night: \"night\",\n  },\n  abbreviated: {\n    am: \"AM\",\n    pm: \"PM\",\n    midnight: \"midnight\",\n    noon: \"noon\",\n    morning: \"morning\",\n    afternoon: \"afternoon\",\n    evening: \"evening\",\n    night: \"night\",\n  },\n  wide: {\n    am: \"a.m.\",\n    pm: \"p.m.\",\n    midnight: \"midnight\",\n    noon: \"noon\",\n    morning: \"morning\",\n    afternoon: \"afternoon\",\n    evening: \"evening\",\n    night: \"night\",\n  },\n};\n\nconst formattingDayPeriodValues = {\n  narrow: {\n    am: \"a\",\n    pm: \"p\",\n    midnight: \"mi\",\n    noon: \"n\",\n    morning: \"in the morning\",\n    afternoon: \"in the afternoon\",\n    evening: \"in the evening\",\n    night: \"at night\",\n  },\n  abbreviated: {\n    am: \"AM\",\n    pm: \"PM\",\n    midnight: \"midnight\",\n    noon: \"noon\",\n    morning: \"in the morning\",\n    afternoon: \"in the afternoon\",\n    evening: \"in the evening\",\n    night: \"at night\",\n  },\n  wide: {\n    am: \"a.m.\",\n    pm: \"p.m.\",\n    midnight: \"midnight\",\n    noon: \"noon\",\n    morning: \"in the morning\",\n    afternoon: \"in the afternoon\",\n    evening: \"in the evening\",\n    night: \"at night\",\n  },\n};\n\nconst ordinalNumber = (dirtyNumber, _options) => {\n  const number = Number(dirtyNumber);\n\n  // If ordinal numbers depend on context, for example,\n  // if they are different for different grammatical genders,\n  // use `options.unit`.\n  //\n  // `unit` can be 'year', 'quarter', 'month', 'week', 'date', 'dayOfYear',\n  // 'day', 'hour', 'minute', 'second'.\n\n  const rem100 = number % 100;\n  if (rem100 > 20 || rem100 < 10) {\n    switch (rem100 % 10) {\n      case 1:\n        return number + \"st\";\n      case 2:\n        return number + \"nd\";\n      case 3:\n        return number + \"rd\";\n    }\n  }\n  return number + \"th\";\n};\n\nexport const localize = {\n  ordinalNumber,\n\n  era: buildLocalizeFn({\n    values: eraValues,\n    defaultWidth: \"wide\",\n  }),\n\n  quarter: buildLocalizeFn({\n    values: quarterValues,\n    defaultWidth: \"wide\",\n    argumentCallback: (quarter) => quarter - 1,\n  }),\n\n  month: buildLocalizeFn({\n    values: monthValues,\n    defaultWidth: \"wide\",\n  }),\n\n  day: buildLocalizeFn({\n    values: dayValues,\n    defaultWidth: \"wide\",\n  }),\n\n  dayPeriod: buildLocalizeFn({\n    values: dayPeriodValues,\n    defaultWidth: \"wide\",\n    formattingValues: formattingDayPeriodValues,\n    defaultFormattingWidth: \"wide\",\n  }),\n};\n","export function buildMatchFn(args) {\n  return (string, options = {}) => {\n    const width = options.width;\n\n    const matchPattern =\n      (width && args.matchPatterns[width]) ||\n      args.matchPatterns[args.defaultMatchWidth];\n    const matchResult = string.match(matchPattern);\n\n    if (!matchResult) {\n      return null;\n    }\n    const matchedString = matchResult[0];\n\n    const parsePatterns =\n      (width && args.parsePatterns[width]) ||\n      args.parsePatterns[args.defaultParseWidth];\n\n    const key = Array.isArray(parsePatterns)\n      ? findIndex(parsePatterns, (pattern) => pattern.test(matchedString))\n      : // [TODO] -- I challenge you to fix the type\n        findKey(parsePatterns, (pattern) => pattern.test(matchedString));\n\n    let value;\n\n    value = args.valueCallback ? args.valueCallback(key) : key;\n    value = options.valueCallback\n      ? // [TODO] -- I challenge you to fix the type\n        options.valueCallback(value)\n      : value;\n\n    const rest = string.slice(matchedString.length);\n\n    return { value, rest };\n  };\n}\n\nfunction findKey(object, predicate) {\n  for (const key in object) {\n    if (\n      Object.prototype.hasOwnProperty.call(object, key) &&\n      predicate(object[key])\n    ) {\n      return key;\n    }\n  }\n  return undefined;\n}\n\nfunction findIndex(array, predicate) {\n  for (let key = 0; key < array.length; key++) {\n    if (predicate(array[key])) {\n      return key;\n    }\n  }\n  return undefined;\n}\n","export function buildMatchPatternFn(args) {\n  return (string, options = {}) => {\n    const matchResult = string.match(args.matchPattern);\n    if (!matchResult) return null;\n    const matchedString = matchResult[0];\n\n    const parseResult = string.match(args.parsePattern);\n    if (!parseResult) return null;\n    let value = args.valueCallback\n      ? args.valueCallback(parseResult[0])\n      : parseResult[0];\n\n    // [TODO] I challenge you to fix the type\n    value = options.valueCallback ? options.valueCallback(value) : value;\n\n    const rest = string.slice(matchedString.length);\n\n    return { value, rest };\n  };\n}\n","import { buildMatchFn } from \"../../_lib/buildMatchFn.js\";\nimport { buildMatchPatternFn } from \"../../_lib/buildMatchPatternFn.js\";\n\nconst matchOrdinalNumberPattern = /^(\\d+)(th|st|nd|rd)?/i;\nconst parseOrdinalNumberPattern = /\\d+/i;\n\nconst matchEraPatterns = {\n  narrow: /^(b|a)/i,\n  abbreviated: /^(b\\.?\\s?c\\.?|b\\.?\\s?c\\.?\\s?e\\.?|a\\.?\\s?d\\.?|c\\.?\\s?e\\.?)/i,\n  wide: /^(before christ|before common era|anno domini|common era)/i,\n};\nconst parseEraPatterns = {\n  any: [/^b/i, /^(a|c)/i],\n};\n\nconst matchQuarterPatterns = {\n  narrow: /^[1234]/i,\n  abbreviated: /^q[1234]/i,\n  wide: /^[1234](th|st|nd|rd)? quarter/i,\n};\nconst parseQuarterPatterns = {\n  any: [/1/i, /2/i, /3/i, /4/i],\n};\n\nconst matchMonthPatterns = {\n  narrow: /^[jfmasond]/i,\n  abbreviated: /^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,\n  wide: /^(january|february|march|april|may|june|july|august|september|october|november|december)/i,\n};\nconst parseMonthPatterns = {\n  narrow: [\n    /^j/i,\n    /^f/i,\n    /^m/i,\n    /^a/i,\n    /^m/i,\n    /^j/i,\n    /^j/i,\n    /^a/i,\n    /^s/i,\n    /^o/i,\n    /^n/i,\n    /^d/i,\n  ],\n\n  any: [\n    /^ja/i,\n    /^f/i,\n    /^mar/i,\n    /^ap/i,\n    /^may/i,\n    /^jun/i,\n    /^jul/i,\n    /^au/i,\n    /^s/i,\n    /^o/i,\n    /^n/i,\n    /^d/i,\n  ],\n};\n\nconst matchDayPatterns = {\n  narrow: /^[smtwf]/i,\n  short: /^(su|mo|tu|we|th|fr|sa)/i,\n  abbreviated: /^(sun|mon|tue|wed|thu|fri|sat)/i,\n  wide: /^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i,\n};\nconst parseDayPatterns = {\n  narrow: [/^s/i, /^m/i, /^t/i, /^w/i, /^t/i, /^f/i, /^s/i],\n  any: [/^su/i, /^m/i, /^tu/i, /^w/i, /^th/i, /^f/i, /^sa/i],\n};\n\nconst matchDayPeriodPatterns = {\n  narrow: /^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,\n  any: /^([ap]\\.?\\s?m\\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i,\n};\nconst parseDayPeriodPatterns = {\n  any: {\n    am: /^a/i,\n    pm: /^p/i,\n    midnight: /^mi/i,\n    noon: /^no/i,\n    morning: /morning/i,\n    afternoon: /afternoon/i,\n    evening: /evening/i,\n    night: /night/i,\n  },\n};\n\nexport const match = {\n  ordinalNumber: buildMatchPatternFn({\n    matchPattern: matchOrdinalNumberPattern,\n    parsePattern: parseOrdinalNumberPattern,\n    valueCallback: (value) => parseInt(value, 10),\n  }),\n\n  era: buildMatchFn({\n    matchPatterns: matchEraPatterns,\n    defaultMatchWidth: \"wide\",\n    parsePatterns: parseEraPatterns,\n    defaultParseWidth: \"any\",\n  }),\n\n  quarter: buildMatchFn({\n    matchPatterns: matchQuarterPatterns,\n    defaultMatchWidth: \"wide\",\n    parsePatterns: parseQuarterPatterns,\n    defaultParseWidth: \"any\",\n    valueCallback: (index) => index + 1,\n  }),\n\n  month: buildMatchFn({\n    matchPatterns: matchMonthPatterns,\n    defaultMatchWidth: \"wide\",\n    parsePatterns: parseMonthPatterns,\n    defaultParseWidth: \"any\",\n  }),\n\n  day: buildMatchFn({\n    matchPatterns: matchDayPatterns,\n    defaultMatchWidth: \"wide\",\n    parsePatterns: parseDayPatterns,\n    defaultParseWidth: \"any\",\n  }),\n\n  dayPeriod: buildMatchFn({\n    matchPatterns: matchDayPeriodPatterns,\n    defaultMatchWidth: \"any\",\n    parsePatterns: parseDayPeriodPatterns,\n    defaultParseWidth: \"any\",\n  }),\n};\n","import { formatDistance } from \"./en-US/_lib/formatDistance.js\";\nimport { formatLong } from \"./en-US/_lib/formatLong.js\";\nimport { formatRelative } from \"./en-US/_lib/formatRelative.js\";\nimport { localize } from \"./en-US/_lib/localize.js\";\nimport { match } from \"./en-US/_lib/match.js\";\n\n/**\n * @category Locales\n * @summary English locale (United States).\n * @language English\n * @iso-639-2 eng\n * @author Sasha Koss [@kossnocorp](https://github.com/kossnocorp)\n * @author Lesha Koss [@leshakoss](https://github.com/leshakoss)\n */\nexport const enUS = {\n  code: \"en-US\",\n  formatDistance: formatDistance,\n  formatLong: formatLong,\n  formatRelative: formatRelative,\n  localize: localize,\n  match: match,\n  options: {\n    weekStartsOn: 0 /* Sunday */,\n    firstWeekContainsDate: 1,\n  },\n};\n\n// Fallback for modularized imports:\nexport default enUS;\n","import { differenceInCalendarDays } from \"./differenceInCalendarDays.js\";\nimport { startOfYear } from \"./startOfYear.js\";\nimport { toDate } from \"./toDate.js\";\n\n/**\n * The {@link getDayOfYear} function options.\n */\n\n/**\n * @name getDayOfYear\n * @category Day Helpers\n * @summary Get the day of the year of the given date.\n *\n * @description\n * Get the day of the year of the given date.\n *\n * @param date - The given date\n * @param options - The options\n *\n * @returns The day of year\n *\n * @example\n * // Which day of the year is 2 July 2014?\n * const result = getDayOfYear(new Date(2014, 6, 2))\n * //=> 183\n */\nexport function getDayOfYear(date, options) {\n  const _date = toDate(date, options?.in);\n  const diff = differenceInCalendarDays(_date, startOfYear(_date));\n  const dayOfYear = diff + 1;\n  return dayOfYear;\n}\n\n// Fallback for modularized imports:\nexport default getDayOfYear;\n","import { millisecondsInWeek } from \"./constants.js\";\nimport { startOfISOWeek } from \"./startOfISOWeek.js\";\nimport { startOfISOWeekYear } from \"./startOfISOWeekYear.js\";\nimport { toDate } from \"./toDate.js\";\n\n/**\n * The {@link getISOWeek} function options.\n */\n\n/**\n * @name getISOWeek\n * @category ISO Week Helpers\n * @summary Get the ISO week of the given date.\n *\n * @description\n * Get the ISO week of the given date.\n *\n * ISO week-numbering year: http://en.wikipedia.org/wiki/ISO_week_date\n *\n * @param date - The given date\n * @param options - The options\n *\n * @returns The ISO week\n *\n * @example\n * // Which week of the ISO-week numbering year is 2 January 2005?\n * const result = getISOWeek(new Date(2005, 0, 2))\n * //=> 53\n */\nexport function getISOWeek(date, options) {\n  const _date = toDate(date, options?.in);\n  const diff = +startOfISOWeek(_date) - +startOfISOWeekYear(_date);\n\n  // Round the number of weeks to the nearest integer because the number of\n  // milliseconds in a week is not constant (e.g. it's different in the week of\n  // the daylight saving time clock shift).\n  return Math.round(diff / millisecondsInWeek) + 1;\n}\n\n// Fallback for modularized imports:\nexport default getISOWeek;\n","import { getDefaultOptions } from \"./_lib/defaultOptions.js\";\nimport { constructFrom } from \"./constructFrom.js\";\nimport { startOfWeek } from \"./startOfWeek.js\";\nimport { toDate } from \"./toDate.js\";\n\n/**\n * The {@link getWeekYear} function options.\n */\n\n/**\n * @name getWeekYear\n * @category Week-Numbering Year Helpers\n * @summary Get the local week-numbering year of the given date.\n *\n * @description\n * Get the local week-numbering year of the given date.\n * The exact calculation depends on the values of\n * `options.weekStartsOn` (which is the index of the first day of the week)\n * and `options.firstWeekContainsDate` (which is the day of January, which is always in\n * the first week of the week-numbering year)\n *\n * Week numbering: https://en.wikipedia.org/wiki/Week#The_ISO_week_date_system\n *\n * @param date - The given date\n * @param options - An object with options.\n *\n * @returns The local week-numbering year\n *\n * @example\n * // Which week numbering year is 26 December 2004 with the default settings?\n * const result = getWeekYear(new Date(2004, 11, 26))\n * //=> 2005\n *\n * @example\n * // Which week numbering year is 26 December 2004 if week starts on Saturday?\n * const result = getWeekYear(new Date(2004, 11, 26), { weekStartsOn: 6 })\n * //=> 2004\n *\n * @example\n * // Which week numbering year is 26 December 2004 if the first week contains 4 January?\n * const result = getWeekYear(new Date(2004, 11, 26), { firstWeekContainsDate: 4 })\n * //=> 2004\n */\nexport function getWeekYear(date, options) {\n  const _date = toDate(date, options?.in);\n  const year = _date.getFullYear();\n\n  const defaultOptions = getDefaultOptions();\n  const firstWeekContainsDate =\n    options?.firstWeekContainsDate ??\n    options?.locale?.options?.firstWeekContainsDate ??\n    defaultOptions.firstWeekContainsDate ??\n    defaultOptions.locale?.options?.firstWeekContainsDate ??\n    1;\n\n  const firstWeekOfNextYear = constructFrom(options?.in || date, 0);\n  firstWeekOfNextYear.setFullYear(year + 1, 0, firstWeekContainsDate);\n  firstWeekOfNextYear.setHours(0, 0, 0, 0);\n  const startOfNextYear = startOfWeek(firstWeekOfNextYear, options);\n\n  const firstWeekOfThisYear = constructFrom(options?.in || date, 0);\n  firstWeekOfThisYear.setFullYear(year, 0, firstWeekContainsDate);\n  firstWeekOfThisYear.setHours(0, 0, 0, 0);\n  const startOfThisYear = startOfWeek(firstWeekOfThisYear, options);\n\n  if (+_date >= +startOfNextYear) {\n    return year + 1;\n  } else if (+_date >= +startOfThisYear) {\n    return year;\n  } else {\n    return year - 1;\n  }\n}\n\n// Fallback for modularized imports:\nexport default getWeekYear;\n","import { getDefaultOptions } from \"./_lib/defaultOptions.js\";\nimport { constructFrom } from \"./constructFrom.js\";\nimport { getWeekYear } from \"./getWeekYear.js\";\nimport { startOfWeek } from \"./startOfWeek.js\";\n\n/**\n * The {@link startOfWeekYear} function options.\n */\n\n/**\n * @name startOfWeekYear\n * @category Week-Numbering Year Helpers\n * @summary Return the start of a local week-numbering year for the given date.\n *\n * @description\n * Return the start of a local week-numbering year.\n * The exact calculation depends on the values of\n * `options.weekStartsOn` (which is the index of the first day of the week)\n * and `options.firstWeekContainsDate` (which is the day of January, which is always in\n * the first week of the week-numbering year)\n *\n * Week numbering: https://en.wikipedia.org/wiki/Week#The_ISO_week_date_system\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type.\n *\n * @param date - The original date\n * @param options - An object with options\n *\n * @returns The start of a week-numbering year\n *\n * @example\n * // The start of an a week-numbering year for 2 July 2005 with default settings:\n * const result = startOfWeekYear(new Date(2005, 6, 2))\n * //=> Sun Dec 26 2004 00:00:00\n *\n * @example\n * // The start of a week-numbering year for 2 July 2005\n * // if Monday is the first day of week\n * // and 4 January is always in the first week of the year:\n * const result = startOfWeekYear(new Date(2005, 6, 2), {\n *   weekStartsOn: 1,\n *   firstWeekContainsDate: 4\n * })\n * //=> Mon Jan 03 2005 00:00:00\n */\nexport function startOfWeekYear(date, options) {\n  const defaultOptions = getDefaultOptions();\n  const firstWeekContainsDate =\n    options?.firstWeekContainsDate ??\n    options?.locale?.options?.firstWeekContainsDate ??\n    defaultOptions.firstWeekContainsDate ??\n    defaultOptions.locale?.options?.firstWeekContainsDate ??\n    1;\n\n  const year = getWeekYear(date, options);\n  const firstWeek = constructFrom(options?.in || date, 0);\n  firstWeek.setFullYear(year, 0, firstWeekContainsDate);\n  firstWeek.setHours(0, 0, 0, 0);\n  const _date = startOfWeek(firstWeek, options);\n  return _date;\n}\n\n// Fallback for modularized imports:\nexport default startOfWeekYear;\n","import { millisecondsInWeek } from \"./constants.js\";\nimport { startOfWeek } from \"./startOfWeek.js\";\nimport { startOfWeekYear } from \"./startOfWeekYear.js\";\nimport { toDate } from \"./toDate.js\";\n\n/**\n * The {@link getWeek} function options.\n */\n\n/**\n * @name getWeek\n * @category Week Helpers\n * @summary Get the local week index of the given date.\n *\n * @description\n * Get the local week index of the given date.\n * The exact calculation depends on the values of\n * `options.weekStartsOn` (which is the index of the first day of the week)\n * and `options.firstWeekContainsDate` (which is the day of January, which is always in\n * the first week of the week-numbering year)\n *\n * Week numbering: https://en.wikipedia.org/wiki/Week#The_ISO_week_date_system\n *\n * @param date - The given date\n * @param options - An object with options\n *\n * @returns The week\n *\n * @example\n * // Which week of the local week numbering year is 2 January 2005 with default options?\n * const result = getWeek(new Date(2005, 0, 2))\n * //=> 2\n *\n * @example\n * // Which week of the local week numbering year is 2 January 2005,\n * // if Monday is the first day of the week,\n * // and the first week of the year always contains 4 January?\n * const result = getWeek(new Date(2005, 0, 2), {\n *   weekStartsOn: 1,\n *   firstWeekContainsDate: 4\n * })\n * //=> 53\n */\nexport function getWeek(date, options) {\n  const _date = toDate(date, options?.in);\n  const diff = +startOfWeek(_date, options) - +startOfWeekYear(_date, options);\n\n  // Round the number of weeks to the nearest integer because the number of\n  // milliseconds in a week is not constant (e.g. it's different in the week of\n  // the daylight saving time clock shift).\n  return Math.round(diff / millisecondsInWeek) + 1;\n}\n\n// Fallback for modularized imports:\nexport default getWeek;\n","export function addLeadingZeros(number, targetLength) {\n  const sign = number < 0 ? \"-\" : \"\";\n  const output = Math.abs(number).toString().padStart(targetLength, \"0\");\n  return sign + output;\n}\n","import { addLeadingZeros } from \"../addLeadingZeros.js\";\n\n/*\n * |     | Unit                           |     | Unit                           |\n * |-----|--------------------------------|-----|--------------------------------|\n * |  a  | AM, PM                         |  A* |                                |\n * |  d  | Day of month                   |  D  |                                |\n * |  h  | Hour [1-12]                    |  H  | Hour [0-23]                    |\n * |  m  | Minute                         |  M  | Month                          |\n * |  s  | Second                         |  S  | Fraction of second             |\n * |  y  | Year (abs)                     |  Y  |                                |\n *\n * Letters marked by * are not implemented but reserved by Unicode standard.\n */\n\nexport const lightFormatters = {\n  // Year\n  y(date, token) {\n    // From http://www.unicode.org/reports/tr35/tr35-31/tr35-dates.html#Date_Format_tokens\n    // | Year     |     y | yy |   yyy |  yyyy | yyyyy |\n    // |----------|-------|----|-------|-------|-------|\n    // | AD 1     |     1 | 01 |   001 |  0001 | 00001 |\n    // | AD 12    |    12 | 12 |   012 |  0012 | 00012 |\n    // | AD 123   |   123 | 23 |   123 |  0123 | 00123 |\n    // | AD 1234  |  1234 | 34 |  1234 |  1234 | 01234 |\n    // | AD 12345 | 12345 | 45 | 12345 | 12345 | 12345 |\n\n    const signedYear = date.getFullYear();\n    // Returns 1 for 1 BC (which is year 0 in JavaScript)\n    const year = signedYear > 0 ? signedYear : 1 - signedYear;\n    return addLeadingZeros(token === \"yy\" ? year % 100 : year, token.length);\n  },\n\n  // Month\n  M(date, token) {\n    const month = date.getMonth();\n    return token === \"M\" ? String(month + 1) : addLeadingZeros(month + 1, 2);\n  },\n\n  // Day of the month\n  d(date, token) {\n    return addLeadingZeros(date.getDate(), token.length);\n  },\n\n  // AM or PM\n  a(date, token) {\n    const dayPeriodEnumValue = date.getHours() / 12 >= 1 ? \"pm\" : \"am\";\n\n    switch (token) {\n      case \"a\":\n      case \"aa\":\n        return dayPeriodEnumValue.toUpperCase();\n      case \"aaa\":\n        return dayPeriodEnumValue;\n      case \"aaaaa\":\n        return dayPeriodEnumValue[0];\n      case \"aaaa\":\n      default:\n        return dayPeriodEnumValue === \"am\" ? \"a.m.\" : \"p.m.\";\n    }\n  },\n\n  // Hour [1-12]\n  h(date, token) {\n    return addLeadingZeros(date.getHours() % 12 || 12, token.length);\n  },\n\n  // Hour [0-23]\n  H(date, token) {\n    return addLeadingZeros(date.getHours(), token.length);\n  },\n\n  // Minute\n  m(date, token) {\n    return addLeadingZeros(date.getMinutes(), token.length);\n  },\n\n  // Second\n  s(date, token) {\n    return addLeadingZeros(date.getSeconds(), token.length);\n  },\n\n  // Fraction of second\n  S(date, token) {\n    const numberOfDigits = token.length;\n    const milliseconds = date.getMilliseconds();\n    const fractionalSeconds = Math.trunc(\n      milliseconds * Math.pow(10, numberOfDigits - 3),\n    );\n    return addLeadingZeros(fractionalSeconds, token.length);\n  },\n};\n","import { getDayOfYear } from \"../../getDayOfYear.js\";\nimport { getISOWeek } from \"../../getISOWeek.js\";\nimport { getISOWeekYear } from \"../../getISOWeekYear.js\";\nimport { getWeek } from \"../../getWeek.js\";\nimport { getWeekYear } from \"../../getWeekYear.js\";\n\nimport { addLeadingZeros } from \"../addLeadingZeros.js\";\nimport { lightFormatters } from \"./lightFormatters.js\";\n\nconst dayPeriodEnum = {\n  am: \"am\",\n  pm: \"pm\",\n  midnight: \"midnight\",\n  noon: \"noon\",\n  morning: \"morning\",\n  afternoon: \"afternoon\",\n  evening: \"evening\",\n  night: \"night\",\n};\n\n/*\n * |     | Unit                           |     | Unit                           |\n * |-----|--------------------------------|-----|--------------------------------|\n * |  a  | AM, PM                         |  A* | Milliseconds in day            |\n * |  b  | AM, PM, noon, midnight         |  B  | Flexible day period            |\n * |  c  | Stand-alone local day of week  |  C* | Localized hour w/ day period   |\n * |  d  | Day of month                   |  D  | Day of year                    |\n * |  e  | Local day of week              |  E  | Day of week                    |\n * |  f  |                                |  F* | Day of week in month           |\n * |  g* | Modified Julian day            |  G  | Era                            |\n * |  h  | Hour [1-12]                    |  H  | Hour [0-23]                    |\n * |  i! | ISO day of week                |  I! | ISO week of year               |\n * |  j* | Localized hour w/ day period   |  J* | Localized hour w/o day period  |\n * |  k  | Hour [1-24]                    |  K  | Hour [0-11]                    |\n * |  l* | (deprecated)                   |  L  | Stand-alone month              |\n * |  m  | Minute                         |  M  | Month                          |\n * |  n  |                                |  N  |                                |\n * |  o! | Ordinal number modifier        |  O  | Timezone (GMT)                 |\n * |  p! | Long localized time            |  P! | Long localized date            |\n * |  q  | Stand-alone quarter            |  Q  | Quarter                        |\n * |  r* | Related Gregorian year         |  R! | ISO week-numbering year        |\n * |  s  | Second                         |  S  | Fraction of second             |\n * |  t! | Seconds timestamp              |  T! | Milliseconds timestamp         |\n * |  u  | Extended year                  |  U* | Cyclic year                    |\n * |  v* | Timezone (generic non-locat.)  |  V* | Timezone (location)            |\n * |  w  | Local week of year             |  W* | Week of month                  |\n * |  x  | Timezone (ISO-8601 w/o Z)      |  X  | Timezone (ISO-8601)            |\n * |  y  | Year (abs)                     |  Y  | Local week-numbering year      |\n * |  z  | Timezone (specific non-locat.) |  Z* | Timezone (aliases)             |\n *\n * Letters marked by * are not implemented but reserved by Unicode standard.\n *\n * Letters marked by ! are non-standard, but implemented by date-fns:\n * - `o` modifies the previous token to turn it into an ordinal (see `format` docs)\n * - `i` is ISO day of week. For `i` and `ii` is returns numeric ISO week days,\n *   i.e. 7 for Sunday, 1 for Monday, etc.\n * - `I` is ISO week of year, as opposed to `w` which is local week of year.\n * - `R` is ISO week-numbering year, as opposed to `Y` which is local week-numbering year.\n *   `R` is supposed to be used in conjunction with `I` and `i`\n *   for universal ISO week-numbering date, whereas\n *   `Y` is supposed to be used in conjunction with `w` and `e`\n *   for week-numbering date specific to the locale.\n * - `P` is long localized date format\n * - `p` is long localized time format\n */\n\nexport const formatters = {\n  // Era\n  G: function (date, token, localize) {\n    const era = date.getFullYear() > 0 ? 1 : 0;\n    switch (token) {\n      // AD, BC\n      case \"G\":\n      case \"GG\":\n      case \"GGG\":\n        return localize.era(era, { width: \"abbreviated\" });\n      // A, B\n      case \"GGGGG\":\n        return localize.era(era, { width: \"narrow\" });\n      // Anno Domini, Before Christ\n      case \"GGGG\":\n      default:\n        return localize.era(era, { width: \"wide\" });\n    }\n  },\n\n  // Year\n  y: function (date, token, localize) {\n    // Ordinal number\n    if (token === \"yo\") {\n      const signedYear = date.getFullYear();\n      // Returns 1 for 1 BC (which is year 0 in JavaScript)\n      const year = signedYear > 0 ? signedYear : 1 - signedYear;\n      return localize.ordinalNumber(year, { unit: \"year\" });\n    }\n\n    return lightFormatters.y(date, token);\n  },\n\n  // Local week-numbering year\n  Y: function (date, token, localize, options) {\n    const signedWeekYear = getWeekYear(date, options);\n    // Returns 1 for 1 BC (which is year 0 in JavaScript)\n    const weekYear = signedWeekYear > 0 ? signedWeekYear : 1 - signedWeekYear;\n\n    // Two digit year\n    if (token === \"YY\") {\n      const twoDigitYear = weekYear % 100;\n      return addLeadingZeros(twoDigitYear, 2);\n    }\n\n    // Ordinal number\n    if (token === \"Yo\") {\n      return localize.ordinalNumber(weekYear, { unit: \"year\" });\n    }\n\n    // Padding\n    return addLeadingZeros(weekYear, token.length);\n  },\n\n  // ISO week-numbering year\n  R: function (date, token) {\n    const isoWeekYear = getISOWeekYear(date);\n\n    // Padding\n    return addLeadingZeros(isoWeekYear, token.length);\n  },\n\n  // Extended year. This is a single number designating the year of this calendar system.\n  // The main difference between `y` and `u` localizers are B.C. years:\n  // | Year | `y` | `u` |\n  // |------|-----|-----|\n  // | AC 1 |   1 |   1 |\n  // | BC 1 |   1 |   0 |\n  // | BC 2 |   2 |  -1 |\n  // Also `yy` always returns the last two digits of a year,\n  // while `uu` pads single digit years to 2 characters and returns other years unchanged.\n  u: function (date, token) {\n    const year = date.getFullYear();\n    return addLeadingZeros(year, token.length);\n  },\n\n  // Quarter\n  Q: function (date, token, localize) {\n    const quarter = Math.ceil((date.getMonth() + 1) / 3);\n    switch (token) {\n      // 1, 2, 3, 4\n      case \"Q\":\n        return String(quarter);\n      // 01, 02, 03, 04\n      case \"QQ\":\n        return addLeadingZeros(quarter, 2);\n      // 1st, 2nd, 3rd, 4th\n      case \"Qo\":\n        return localize.ordinalNumber(quarter, { unit: \"quarter\" });\n      // Q1, Q2, Q3, Q4\n      case \"QQQ\":\n        return localize.quarter(quarter, {\n          width: \"abbreviated\",\n          context: \"formatting\",\n        });\n      // 1, 2, 3, 4 (narrow quarter; could be not numerical)\n      case \"QQQQQ\":\n        return localize.quarter(quarter, {\n          width: \"narrow\",\n          context: \"formatting\",\n        });\n      // 1st quarter, 2nd quarter, ...\n      case \"QQQQ\":\n      default:\n        return localize.quarter(quarter, {\n          width: \"wide\",\n          context: \"formatting\",\n        });\n    }\n  },\n\n  // Stand-alone quarter\n  q: function (date, token, localize) {\n    const quarter = Math.ceil((date.getMonth() + 1) / 3);\n    switch (token) {\n      // 1, 2, 3, 4\n      case \"q\":\n        return String(quarter);\n      // 01, 02, 03, 04\n      case \"qq\":\n        return addLeadingZeros(quarter, 2);\n      // 1st, 2nd, 3rd, 4th\n      case \"qo\":\n        return localize.ordinalNumber(quarter, { unit: \"quarter\" });\n      // Q1, Q2, Q3, Q4\n      case \"qqq\":\n        return localize.quarter(quarter, {\n          width: \"abbreviated\",\n          context: \"standalone\",\n        });\n      // 1, 2, 3, 4 (narrow quarter; could be not numerical)\n      case \"qqqqq\":\n        return localize.quarter(quarter, {\n          width: \"narrow\",\n          context: \"standalone\",\n        });\n      // 1st quarter, 2nd quarter, ...\n      case \"qqqq\":\n      default:\n        return localize.quarter(quarter, {\n          width: \"wide\",\n          context: \"standalone\",\n        });\n    }\n  },\n\n  // Month\n  M: function (date, token, localize) {\n    const month = date.getMonth();\n    switch (token) {\n      case \"M\":\n      case \"MM\":\n        return lightFormatters.M(date, token);\n      // 1st, 2nd, ..., 12th\n      case \"Mo\":\n        return localize.ordinalNumber(month + 1, { unit: \"month\" });\n      // Jan, Feb, ..., Dec\n      case \"MMM\":\n        return localize.month(month, {\n          width: \"abbreviated\",\n          context: \"formatting\",\n        });\n      // J, F, ..., D\n      case \"MMMMM\":\n        return localize.month(month, {\n          width: \"narrow\",\n          context: \"formatting\",\n        });\n      // January, February, ..., December\n      case \"MMMM\":\n      default:\n        return localize.month(month, { width: \"wide\", context: \"formatting\" });\n    }\n  },\n\n  // Stand-alone month\n  L: function (date, token, localize) {\n    const month = date.getMonth();\n    switch (token) {\n      // 1, 2, ..., 12\n      case \"L\":\n        return String(month + 1);\n      // 01, 02, ..., 12\n      case \"LL\":\n        return addLeadingZeros(month + 1, 2);\n      // 1st, 2nd, ..., 12th\n      case \"Lo\":\n        return localize.ordinalNumber(month + 1, { unit: \"month\" });\n      // Jan, Feb, ..., Dec\n      case \"LLL\":\n        return localize.month(month, {\n          width: \"abbreviated\",\n          context: \"standalone\",\n        });\n      // J, F, ..., D\n      case \"LLLLL\":\n        return localize.month(month, {\n          width: \"narrow\",\n          context: \"standalone\",\n        });\n      // January, February, ..., December\n      case \"LLLL\":\n      default:\n        return localize.month(month, { width: \"wide\", context: \"standalone\" });\n    }\n  },\n\n  // Local week of year\n  w: function (date, token, localize, options) {\n    const week = getWeek(date, options);\n\n    if (token === \"wo\") {\n      return localize.ordinalNumber(week, { unit: \"week\" });\n    }\n\n    return addLeadingZeros(week, token.length);\n  },\n\n  // ISO week of year\n  I: function (date, token, localize) {\n    const isoWeek = getISOWeek(date);\n\n    if (token === \"Io\") {\n      return localize.ordinalNumber(isoWeek, { unit: \"week\" });\n    }\n\n    return addLeadingZeros(isoWeek, token.length);\n  },\n\n  // Day of the month\n  d: function (date, token, localize) {\n    if (token === \"do\") {\n      return localize.ordinalNumber(date.getDate(), { unit: \"date\" });\n    }\n\n    return lightFormatters.d(date, token);\n  },\n\n  // Day of year\n  D: function (date, token, localize) {\n    const dayOfYear = getDayOfYear(date);\n\n    if (token === \"Do\") {\n      return localize.ordinalNumber(dayOfYear, { unit: \"dayOfYear\" });\n    }\n\n    return addLeadingZeros(dayOfYear, token.length);\n  },\n\n  // Day of week\n  E: function (date, token, localize) {\n    const dayOfWeek = date.getDay();\n    switch (token) {\n      // Tue\n      case \"E\":\n      case \"EE\":\n      case \"EEE\":\n        return localize.day(dayOfWeek, {\n          width: \"abbreviated\",\n          context: \"formatting\",\n        });\n      // T\n      case \"EEEEE\":\n        return localize.day(dayOfWeek, {\n          width: \"narrow\",\n          context: \"formatting\",\n        });\n      // Tu\n      case \"EEEEEE\":\n        return localize.day(dayOfWeek, {\n          width: \"short\",\n          context: \"formatting\",\n        });\n      // Tuesday\n      case \"EEEE\":\n      default:\n        return localize.day(dayOfWeek, {\n          width: \"wide\",\n          context: \"formatting\",\n        });\n    }\n  },\n\n  // Local day of week\n  e: function (date, token, localize, options) {\n    const dayOfWeek = date.getDay();\n    const localDayOfWeek = (dayOfWeek - options.weekStartsOn + 8) % 7 || 7;\n    switch (token) {\n      // Numerical value (Nth day of week with current locale or weekStartsOn)\n      case \"e\":\n        return String(localDayOfWeek);\n      // Padded numerical value\n      case \"ee\":\n        return addLeadingZeros(localDayOfWeek, 2);\n      // 1st, 2nd, ..., 7th\n      case \"eo\":\n        return localize.ordinalNumber(localDayOfWeek, { unit: \"day\" });\n      case \"eee\":\n        return localize.day(dayOfWeek, {\n          width: \"abbreviated\",\n          context: \"formatting\",\n        });\n      // T\n      case \"eeeee\":\n        return localize.day(dayOfWeek, {\n          width: \"narrow\",\n          context: \"formatting\",\n        });\n      // Tu\n      case \"eeeeee\":\n        return localize.day(dayOfWeek, {\n          width: \"short\",\n          context: \"formatting\",\n        });\n      // Tuesday\n      case \"eeee\":\n      default:\n        return localize.day(dayOfWeek, {\n          width: \"wide\",\n          context: \"formatting\",\n        });\n    }\n  },\n\n  // Stand-alone local day of week\n  c: function (date, token, localize, options) {\n    const dayOfWeek = date.getDay();\n    const localDayOfWeek = (dayOfWeek - options.weekStartsOn + 8) % 7 || 7;\n    switch (token) {\n      // Numerical value (same as in `e`)\n      case \"c\":\n        return String(localDayOfWeek);\n      // Padded numerical value\n      case \"cc\":\n        return addLeadingZeros(localDayOfWeek, token.length);\n      // 1st, 2nd, ..., 7th\n      case \"co\":\n        return localize.ordinalNumber(localDayOfWeek, { unit: \"day\" });\n      case \"ccc\":\n        return localize.day(dayOfWeek, {\n          width: \"abbreviated\",\n          context: \"standalone\",\n        });\n      // T\n      case \"ccccc\":\n        return localize.day(dayOfWeek, {\n          width: \"narrow\",\n          context: \"standalone\",\n        });\n      // Tu\n      case \"cccccc\":\n        return localize.day(dayOfWeek, {\n          width: \"short\",\n          context: \"standalone\",\n        });\n      // Tuesday\n      case \"cccc\":\n      default:\n        return localize.day(dayOfWeek, {\n          width: \"wide\",\n          context: \"standalone\",\n        });\n    }\n  },\n\n  // ISO day of week\n  i: function (date, token, localize) {\n    const dayOfWeek = date.getDay();\n    const isoDayOfWeek = dayOfWeek === 0 ? 7 : dayOfWeek;\n    switch (token) {\n      // 2\n      case \"i\":\n        return String(isoDayOfWeek);\n      // 02\n      case \"ii\":\n        return addLeadingZeros(isoDayOfWeek, token.length);\n      // 2nd\n      case \"io\":\n        return localize.ordinalNumber(isoDayOfWeek, { unit: \"day\" });\n      // Tue\n      case \"iii\":\n        return localize.day(dayOfWeek, {\n          width: \"abbreviated\",\n          context: \"formatting\",\n        });\n      // T\n      case \"iiiii\":\n        return localize.day(dayOfWeek, {\n          width: \"narrow\",\n          context: \"formatting\",\n        });\n      // Tu\n      case \"iiiiii\":\n        return localize.day(dayOfWeek, {\n          width: \"short\",\n          context: \"formatting\",\n        });\n      // Tuesday\n      case \"iiii\":\n      default:\n        return localize.day(dayOfWeek, {\n          width: \"wide\",\n          context: \"formatting\",\n        });\n    }\n  },\n\n  // AM or PM\n  a: function (date, token, localize) {\n    const hours = date.getHours();\n    const dayPeriodEnumValue = hours / 12 >= 1 ? \"pm\" : \"am\";\n\n    switch (token) {\n      case \"a\":\n      case \"aa\":\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: \"abbreviated\",\n          context: \"formatting\",\n        });\n      case \"aaa\":\n        return localize\n          .dayPeriod(dayPeriodEnumValue, {\n            width: \"abbreviated\",\n            context: \"formatting\",\n          })\n          .toLowerCase();\n      case \"aaaaa\":\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: \"narrow\",\n          context: \"formatting\",\n        });\n      case \"aaaa\":\n      default:\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: \"wide\",\n          context: \"formatting\",\n        });\n    }\n  },\n\n  // AM, PM, midnight, noon\n  b: function (date, token, localize) {\n    const hours = date.getHours();\n    let dayPeriodEnumValue;\n    if (hours === 12) {\n      dayPeriodEnumValue = dayPeriodEnum.noon;\n    } else if (hours === 0) {\n      dayPeriodEnumValue = dayPeriodEnum.midnight;\n    } else {\n      dayPeriodEnumValue = hours / 12 >= 1 ? \"pm\" : \"am\";\n    }\n\n    switch (token) {\n      case \"b\":\n      case \"bb\":\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: \"abbreviated\",\n          context: \"formatting\",\n        });\n      case \"bbb\":\n        return localize\n          .dayPeriod(dayPeriodEnumValue, {\n            width: \"abbreviated\",\n            context: \"formatting\",\n          })\n          .toLowerCase();\n      case \"bbbbb\":\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: \"narrow\",\n          context: \"formatting\",\n        });\n      case \"bbbb\":\n      default:\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: \"wide\",\n          context: \"formatting\",\n        });\n    }\n  },\n\n  // in the morning, in the afternoon, in the evening, at night\n  B: function (date, token, localize) {\n    const hours = date.getHours();\n    let dayPeriodEnumValue;\n    if (hours >= 17) {\n      dayPeriodEnumValue = dayPeriodEnum.evening;\n    } else if (hours >= 12) {\n      dayPeriodEnumValue = dayPeriodEnum.afternoon;\n    } else if (hours >= 4) {\n      dayPeriodEnumValue = dayPeriodEnum.morning;\n    } else {\n      dayPeriodEnumValue = dayPeriodEnum.night;\n    }\n\n    switch (token) {\n      case \"B\":\n      case \"BB\":\n      case \"BBB\":\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: \"abbreviated\",\n          context: \"formatting\",\n        });\n      case \"BBBBB\":\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: \"narrow\",\n          context: \"formatting\",\n        });\n      case \"BBBB\":\n      default:\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: \"wide\",\n          context: \"formatting\",\n        });\n    }\n  },\n\n  // Hour [1-12]\n  h: function (date, token, localize) {\n    if (token === \"ho\") {\n      let hours = date.getHours() % 12;\n      if (hours === 0) hours = 12;\n      return localize.ordinalNumber(hours, { unit: \"hour\" });\n    }\n\n    return lightFormatters.h(date, token);\n  },\n\n  // Hour [0-23]\n  H: function (date, token, localize) {\n    if (token === \"Ho\") {\n      return localize.ordinalNumber(date.getHours(), { unit: \"hour\" });\n    }\n\n    return lightFormatters.H(date, token);\n  },\n\n  // Hour [0-11]\n  K: function (date, token, localize) {\n    const hours = date.getHours() % 12;\n\n    if (token === \"Ko\") {\n      return localize.ordinalNumber(hours, { unit: \"hour\" });\n    }\n\n    return addLeadingZeros(hours, token.length);\n  },\n\n  // Hour [1-24]\n  k: function (date, token, localize) {\n    let hours = date.getHours();\n    if (hours === 0) hours = 24;\n\n    if (token === \"ko\") {\n      return localize.ordinalNumber(hours, { unit: \"hour\" });\n    }\n\n    return addLeadingZeros(hours, token.length);\n  },\n\n  // Minute\n  m: function (date, token, localize) {\n    if (token === \"mo\") {\n      return localize.ordinalNumber(date.getMinutes(), { unit: \"minute\" });\n    }\n\n    return lightFormatters.m(date, token);\n  },\n\n  // Second\n  s: function (date, token, localize) {\n    if (token === \"so\") {\n      return localize.ordinalNumber(date.getSeconds(), { unit: \"second\" });\n    }\n\n    return lightFormatters.s(date, token);\n  },\n\n  // Fraction of second\n  S: function (date, token) {\n    return lightFormatters.S(date, token);\n  },\n\n  // Timezone (ISO-8601. If offset is 0, output is always `'Z'`)\n  X: function (date, token, _localize) {\n    const timezoneOffset = date.getTimezoneOffset();\n\n    if (timezoneOffset === 0) {\n      return \"Z\";\n    }\n\n    switch (token) {\n      // Hours and optional minutes\n      case \"X\":\n        return formatTimezoneWithOptionalMinutes(timezoneOffset);\n\n      // Hours, minutes and optional seconds without `:` delimiter\n      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets\n      // so this token always has the same output as `XX`\n      case \"XXXX\":\n      case \"XX\": // Hours and minutes without `:` delimiter\n        return formatTimezone(timezoneOffset);\n\n      // Hours, minutes and optional seconds with `:` delimiter\n      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets\n      // so this token always has the same output as `XXX`\n      case \"XXXXX\":\n      case \"XXX\": // Hours and minutes with `:` delimiter\n      default:\n        return formatTimezone(timezoneOffset, \":\");\n    }\n  },\n\n  // Timezone (ISO-8601. If offset is 0, output is `'+00:00'` or equivalent)\n  x: function (date, token, _localize) {\n    const timezoneOffset = date.getTimezoneOffset();\n\n    switch (token) {\n      // Hours and optional minutes\n      case \"x\":\n        return formatTimezoneWithOptionalMinutes(timezoneOffset);\n\n      // Hours, minutes and optional seconds without `:` delimiter\n      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets\n      // so this token always has the same output as `xx`\n      case \"xxxx\":\n      case \"xx\": // Hours and minutes without `:` delimiter\n        return formatTimezone(timezoneOffset);\n\n      // Hours, minutes and optional seconds with `:` delimiter\n      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets\n      // so this token always has the same output as `xxx`\n      case \"xxxxx\":\n      case \"xxx\": // Hours and minutes with `:` delimiter\n      default:\n        return formatTimezone(timezoneOffset, \":\");\n    }\n  },\n\n  // Timezone (GMT)\n  O: function (date, token, _localize) {\n    const timezoneOffset = date.getTimezoneOffset();\n\n    switch (token) {\n      // Short\n      case \"O\":\n      case \"OO\":\n      case \"OOO\":\n        return \"GMT\" + formatTimezoneShort(timezoneOffset, \":\");\n      // Long\n      case \"OOOO\":\n      default:\n        return \"GMT\" + formatTimezone(timezoneOffset, \":\");\n    }\n  },\n\n  // Timezone (specific non-location)\n  z: function (date, token, _localize) {\n    const timezoneOffset = date.getTimezoneOffset();\n\n    switch (token) {\n      // Short\n      case \"z\":\n      case \"zz\":\n      case \"zzz\":\n        return \"GMT\" + formatTimezoneShort(timezoneOffset, \":\");\n      // Long\n      case \"zzzz\":\n      default:\n        return \"GMT\" + formatTimezone(timezoneOffset, \":\");\n    }\n  },\n\n  // Seconds timestamp\n  t: function (date, token, _localize) {\n    const timestamp = Math.trunc(+date / 1000);\n    return addLeadingZeros(timestamp, token.length);\n  },\n\n  // Milliseconds timestamp\n  T: function (date, token, _localize) {\n    return addLeadingZeros(+date, token.length);\n  },\n};\n\nfunction formatTimezoneShort(offset, delimiter = \"\") {\n  const sign = offset > 0 ? \"-\" : \"+\";\n  const absOffset = Math.abs(offset);\n  const hours = Math.trunc(absOffset / 60);\n  const minutes = absOffset % 60;\n  if (minutes === 0) {\n    return sign + String(hours);\n  }\n  return sign + String(hours) + delimiter + addLeadingZeros(minutes, 2);\n}\n\nfunction formatTimezoneWithOptionalMinutes(offset, delimiter) {\n  if (offset % 60 === 0) {\n    const sign = offset > 0 ? \"-\" : \"+\";\n    return sign + addLeadingZeros(Math.abs(offset) / 60, 2);\n  }\n  return formatTimezone(offset, delimiter);\n}\n\nfunction formatTimezone(offset, delimiter = \"\") {\n  const sign = offset > 0 ? \"-\" : \"+\";\n  const absOffset = Math.abs(offset);\n  const hours = addLeadingZeros(Math.trunc(absOffset / 60), 2);\n  const minutes = addLeadingZeros(absOffset % 60, 2);\n  return sign + hours + delimiter + minutes;\n}\n","const dateLongFormatter = (pattern, formatLong) => {\n  switch (pattern) {\n    case \"P\":\n      return formatLong.date({ width: \"short\" });\n    case \"PP\":\n      return formatLong.date({ width: \"medium\" });\n    case \"PPP\":\n      return formatLong.date({ width: \"long\" });\n    case \"PPPP\":\n    default:\n      return formatLong.date({ width: \"full\" });\n  }\n};\n\nconst timeLongFormatter = (pattern, formatLong) => {\n  switch (pattern) {\n    case \"p\":\n      return formatLong.time({ width: \"short\" });\n    case \"pp\":\n      return formatLong.time({ width: \"medium\" });\n    case \"ppp\":\n      return formatLong.time({ width: \"long\" });\n    case \"pppp\":\n    default:\n      return formatLong.time({ width: \"full\" });\n  }\n};\n\nconst dateTimeLongFormatter = (pattern, formatLong) => {\n  const matchResult = pattern.match(/(P+)(p+)?/) || [];\n  const datePattern = matchResult[1];\n  const timePattern = matchResult[2];\n\n  if (!timePattern) {\n    return dateLongFormatter(pattern, formatLong);\n  }\n\n  let dateTimeFormat;\n\n  switch (datePattern) {\n    case \"P\":\n      dateTimeFormat = formatLong.dateTime({ width: \"short\" });\n      break;\n    case \"PP\":\n      dateTimeFormat = formatLong.dateTime({ width: \"medium\" });\n      break;\n    case \"PPP\":\n      dateTimeFormat = formatLong.dateTime({ width: \"long\" });\n      break;\n    case \"PPPP\":\n    default:\n      dateTimeFormat = formatLong.dateTime({ width: \"full\" });\n      break;\n  }\n\n  return dateTimeFormat\n    .replace(\"{{date}}\", dateLongFormatter(datePattern, formatLong))\n    .replace(\"{{time}}\", timeLongFormatter(timePattern, formatLong));\n};\n\nexport const longFormatters = {\n  p: timeLongFormatter,\n  P: dateTimeLongFormatter,\n};\n","const dayOfYearTokenRE = /^D+$/;\nconst weekYearTokenRE = /^Y+$/;\n\nconst throwTokens = [\"D\", \"DD\", \"YY\", \"YYYY\"];\n\nexport function isProtectedDayOfYearToken(token) {\n  return dayOfYearTokenRE.test(token);\n}\n\nexport function isProtectedWeekYearToken(token) {\n  return weekYearTokenRE.test(token);\n}\n\nexport function warnOrThrowProtectedError(token, format, input) {\n  const _message = message(token, format, input);\n  console.warn(_message);\n  if (throwTokens.includes(token)) throw new RangeError(_message);\n}\n\nfunction message(token, format, input) {\n  const subject = token[0] === \"Y\" ? \"years\" : \"days of the month\";\n  return `Use \\`${token.toLowerCase()}\\` instead of \\`${token}\\` (in \\`${format}\\`) for formatting ${subject} to the input \\`${input}\\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`;\n}\n","import { defaultLocale } from \"./_lib/defaultLocale.js\";\nimport { getDefaultOptions } from \"./_lib/defaultOptions.js\";\nimport { formatters } from \"./_lib/format/formatters.js\";\nimport { longFormatters } from \"./_lib/format/longFormatters.js\";\nimport {\n  isProtectedDayOfYearToken,\n  isProtectedWeekYearToken,\n  warnOrThrowProtectedError,\n} from \"./_lib/protectedTokens.js\";\nimport { isValid } from \"./isValid.js\";\nimport { toDate } from \"./toDate.js\";\n\n// Rexports of internal for libraries to use.\n// See: https://github.com/date-fns/date-fns/issues/3638#issuecomment-1877082874\nexport { formatters, longFormatters };\n\n// This RegExp consists of three parts separated by `|`:\n// - [yYQqMLwIdDecihHKkms]o matches any available ordinal number token\n//   (one of the certain letters followed by `o`)\n// - (\\w)\\1* matches any sequences of the same letter\n// - '' matches two quote characters in a row\n// - '(''|[^'])+('|$) matches anything surrounded by two quote characters ('),\n//   except a single quote symbol, which ends the sequence.\n//   Two quote characters do not end the sequence.\n//   If there is no matching single quote\n//   then the sequence will continue until the end of the string.\n// - . matches any single character unmatched by previous parts of the RegExps\nconst formattingTokensRegExp =\n  /[yYQqMLwIdDecihHKkms]o|(\\w)\\1*|''|'(''|[^'])+('|$)|./g;\n\n// This RegExp catches symbols escaped by quotes, and also\n// sequences of symbols P, p, and the combinations like `PPPPPPPppppp`\nconst longFormattingTokensRegExp = /P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;\n\nconst escapedStringRegExp = /^'([^]*?)'?$/;\nconst doubleQuoteRegExp = /''/g;\nconst unescapedLatinCharacterRegExp = /[a-zA-Z]/;\n\nexport { format as formatDate };\n\n/**\n * The {@link format} function options.\n */\n\n/**\n * @name format\n * @alias formatDate\n * @category Common Helpers\n * @summary Format the date.\n *\n * @description\n * Return the formatted date string in the given format. The result may vary by locale.\n *\n * > ⚠️ Please note that the `format` tokens differ from Moment.js and other libraries.\n * > See: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md\n *\n * The characters wrapped between two single quotes characters (') are escaped.\n * Two single quotes in a row, whether inside or outside a quoted sequence, represent a 'real' single quote.\n * (see the last example)\n *\n * Format of the string is based on Unicode Technical Standard #35:\n * https://www.unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table\n * with a few additions (see note 7 below the table).\n *\n * Accepted patterns:\n * | Unit                            | Pattern | Result examples                   | Notes |\n * |---------------------------------|---------|-----------------------------------|-------|\n * | Era                             | G..GGG  | AD, BC                            |       |\n * |                                 | GGGG    | Anno Domini, Before Christ        | 2     |\n * |                                 | GGGGG   | A, B                              |       |\n * | Calendar year                   | y       | 44, 1, 1900, 2017                 | 5     |\n * |                                 | yo      | 44th, 1st, 0th, 17th              | 5,7   |\n * |                                 | yy      | 44, 01, 00, 17                    | 5     |\n * |                                 | yyy     | 044, 001, 1900, 2017              | 5     |\n * |                                 | yyyy    | 0044, 0001, 1900, 2017            | 5     |\n * |                                 | yyyyy   | ...                               | 3,5   |\n * | Local week-numbering year       | Y       | 44, 1, 1900, 2017                 | 5     |\n * |                                 | Yo      | 44th, 1st, 1900th, 2017th         | 5,7   |\n * |                                 | YY      | 44, 01, 00, 17                    | 5,8   |\n * |                                 | YYY     | 044, 001, 1900, 2017              | 5     |\n * |                                 | YYYY    | 0044, 0001, 1900, 2017            | 5,8   |\n * |                                 | YYYYY   | ...                               | 3,5   |\n * | ISO week-numbering year         | R       | -43, 0, 1, 1900, 2017             | 5,7   |\n * |                                 | RR      | -43, 00, 01, 1900, 2017           | 5,7   |\n * |                                 | RRR     | -043, 000, 001, 1900, 2017        | 5,7   |\n * |                                 | RRRR    | -0043, 0000, 0001, 1900, 2017     | 5,7   |\n * |                                 | RRRRR   | ...                               | 3,5,7 |\n * | Extended year                   | u       | -43, 0, 1, 1900, 2017             | 5     |\n * |                                 | uu      | -43, 01, 1900, 2017               | 5     |\n * |                                 | uuu     | -043, 001, 1900, 2017             | 5     |\n * |                                 | uuuu    | -0043, 0001, 1900, 2017           | 5     |\n * |                                 | uuuuu   | ...                               | 3,5   |\n * | Quarter (formatting)            | Q       | 1, 2, 3, 4                        |       |\n * |                                 | Qo      | 1st, 2nd, 3rd, 4th                | 7     |\n * |                                 | QQ      | 01, 02, 03, 04                    |       |\n * |                                 | QQQ     | Q1, Q2, Q3, Q4                    |       |\n * |                                 | QQQQ    | 1st quarter, 2nd quarter, ...     | 2     |\n * |                                 | QQQQQ   | 1, 2, 3, 4                        | 4     |\n * | Quarter (stand-alone)           | q       | 1, 2, 3, 4                        |       |\n * |                                 | qo      | 1st, 2nd, 3rd, 4th                | 7     |\n * |                                 | qq      | 01, 02, 03, 04                    |       |\n * |                                 | qqq     | Q1, Q2, Q3, Q4                    |       |\n * |                                 | qqqq    | 1st quarter, 2nd quarter, ...     | 2     |\n * |                                 | qqqqq   | 1, 2, 3, 4                        | 4     |\n * | Month (formatting)              | M       | 1, 2, ..., 12                     |       |\n * |                                 | Mo      | 1st, 2nd, ..., 12th               | 7     |\n * |                                 | MM      | 01, 02, ..., 12                   |       |\n * |                                 | MMM     | Jan, Feb, ..., Dec                |       |\n * |                                 | MMMM    | January, February, ..., December  | 2     |\n * |                                 | MMMMM   | J, F, ..., D                      |       |\n * | Month (stand-alone)             | L       | 1, 2, ..., 12                     |       |\n * |                                 | Lo      | 1st, 2nd, ..., 12th               | 7     |\n * |                                 | LL      | 01, 02, ..., 12                   |       |\n * |                                 | LLL     | Jan, Feb, ..., Dec                |       |\n * |                                 | LLLL    | January, February, ..., December  | 2     |\n * |                                 | LLLLL   | J, F, ..., D                      |       |\n * | Local week of year              | w       | 1, 2, ..., 53                     |       |\n * |                                 | wo      | 1st, 2nd, ..., 53th               | 7     |\n * |                                 | ww      | 01, 02, ..., 53                   |       |\n * | ISO week of year                | I       | 1, 2, ..., 53                     | 7     |\n * |                                 | Io      | 1st, 2nd, ..., 53th               | 7     |\n * |                                 | II      | 01, 02, ..., 53                   | 7     |\n * | Day of month                    | d       | 1, 2, ..., 31                     |       |\n * |                                 | do      | 1st, 2nd, ..., 31st               | 7     |\n * |                                 | dd      | 01, 02, ..., 31                   |       |\n * | Day of year                     | D       | 1, 2, ..., 365, 366               | 9     |\n * |                                 | Do      | 1st, 2nd, ..., 365th, 366th       | 7     |\n * |                                 | DD      | 01, 02, ..., 365, 366             | 9     |\n * |                                 | DDD     | 001, 002, ..., 365, 366           |       |\n * |                                 | DDDD    | ...                               | 3     |\n * | Day of week (formatting)        | E..EEE  | Mon, Tue, Wed, ..., Sun           |       |\n * |                                 | EEEE    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 | EEEEE   | M, T, W, T, F, S, S               |       |\n * |                                 | EEEEEE  | Mo, Tu, We, Th, Fr, Sa, Su        |       |\n * | ISO day of week (formatting)    | i       | 1, 2, 3, ..., 7                   | 7     |\n * |                                 | io      | 1st, 2nd, ..., 7th                | 7     |\n * |                                 | ii      | 01, 02, ..., 07                   | 7     |\n * |                                 | iii     | Mon, Tue, Wed, ..., Sun           | 7     |\n * |                                 | iiii    | Monday, Tuesday, ..., Sunday      | 2,7   |\n * |                                 | iiiii   | M, T, W, T, F, S, S               | 7     |\n * |                                 | iiiiii  | Mo, Tu, We, Th, Fr, Sa, Su        | 7     |\n * | Local day of week (formatting)  | e       | 2, 3, 4, ..., 1                   |       |\n * |                                 | eo      | 2nd, 3rd, ..., 1st                | 7     |\n * |                                 | ee      | 02, 03, ..., 01                   |       |\n * |                                 | eee     | Mon, Tue, Wed, ..., Sun           |       |\n * |                                 | eeee    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 | eeeee   | M, T, W, T, F, S, S               |       |\n * |                                 | eeeeee  | Mo, Tu, We, Th, Fr, Sa, Su        |       |\n * | Local day of week (stand-alone) | c       | 2, 3, 4, ..., 1                   |       |\n * |                                 | co      | 2nd, 3rd, ..., 1st                | 7     |\n * |                                 | cc      | 02, 03, ..., 01                   |       |\n * |                                 | ccc     | Mon, Tue, Wed, ..., Sun           |       |\n * |                                 | cccc    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 | ccccc   | M, T, W, T, F, S, S               |       |\n * |                                 | cccccc  | Mo, Tu, We, Th, Fr, Sa, Su        |       |\n * | AM, PM                          | a..aa   | AM, PM                            |       |\n * |                                 | aaa     | am, pm                            |       |\n * |                                 | aaaa    | a.m., p.m.                        | 2     |\n * |                                 | aaaaa   | a, p                              |       |\n * | AM, PM, noon, midnight          | b..bb   | AM, PM, noon, midnight            |       |\n * |                                 | bbb     | am, pm, noon, midnight            |       |\n * |                                 | bbbb    | a.m., p.m., noon, midnight        | 2     |\n * |                                 | bbbbb   | a, p, n, mi                       |       |\n * | Flexible day period             | B..BBB  | at night, in the morning, ...     |       |\n * |                                 | BBBB    | at night, in the morning, ...     | 2     |\n * |                                 | BBBBB   | at night, in the morning, ...     |       |\n * | Hour [1-12]                     | h       | 1, 2, ..., 11, 12                 |       |\n * |                                 | ho      | 1st, 2nd, ..., 11th, 12th         | 7     |\n * |                                 | hh      | 01, 02, ..., 11, 12               |       |\n * | Hour [0-23]                     | H       | 0, 1, 2, ..., 23                  |       |\n * |                                 | Ho      | 0th, 1st, 2nd, ..., 23rd          | 7     |\n * |                                 | HH      | 00, 01, 02, ..., 23               |       |\n * | Hour [0-11]                     | K       | 1, 2, ..., 11, 0                  |       |\n * |                                 | Ko      | 1st, 2nd, ..., 11th, 0th          | 7     |\n * |                                 | KK      | 01, 02, ..., 11, 00               |       |\n * | Hour [1-24]                     | k       | 24, 1, 2, ..., 23                 |       |\n * |                                 | ko      | 24th, 1st, 2nd, ..., 23rd         | 7     |\n * |                                 | kk      | 24, 01, 02, ..., 23               |       |\n * | Minute                          | m       | 0, 1, ..., 59                     |       |\n * |                                 | mo      | 0th, 1st, ..., 59th               | 7     |\n * |                                 | mm      | 00, 01, ..., 59                   |       |\n * | Second                          | s       | 0, 1, ..., 59                     |       |\n * |                                 | so      | 0th, 1st, ..., 59th               | 7     |\n * |                                 | ss      | 00, 01, ..., 59                   |       |\n * | Fraction of second              | S       | 0, 1, ..., 9                      |       |\n * |                                 | SS      | 00, 01, ..., 99                   |       |\n * |                                 | SSS     | 000, 001, ..., 999                |       |\n * |                                 | SSSS    | ...                               | 3     |\n * | Timezone (ISO-8601 w/ Z)        | X       | -08, +0530, Z                     |       |\n * |                                 | XX      | -0800, +0530, Z                   |       |\n * |                                 | XXX     | -08:00, +05:30, Z                 |       |\n * |                                 | XXXX    | -0800, +0530, Z, +123456          | 2     |\n * |                                 | XXXXX   | -08:00, +05:30, Z, +12:34:56      |       |\n * | Timezone (ISO-8601 w/o Z)       | x       | -08, +0530, +00                   |       |\n * |                                 | xx      | -0800, +0530, +0000               |       |\n * |                                 | xxx     | -08:00, +05:30, +00:00            | 2     |\n * |                                 | xxxx    | -0800, +0530, +0000, +123456      |       |\n * |                                 | xxxxx   | -08:00, +05:30, +00:00, +12:34:56 |       |\n * | Timezone (GMT)                  | O...OOO | GMT-8, GMT+5:30, GMT+0            |       |\n * |                                 | OOOO    | GMT-08:00, GMT+05:30, GMT+00:00   | 2     |\n * | Timezone (specific non-locat.)  | z...zzz | GMT-8, GMT+5:30, GMT+0            | 6     |\n * |                                 | zzzz    | GMT-08:00, GMT+05:30, GMT+00:00   | 2,6   |\n * | Seconds timestamp               | t       | 512969520                         | 7     |\n * |                                 | tt      | ...                               | 3,7   |\n * | Milliseconds timestamp          | T       | 512969520900                      | 7     |\n * |                                 | TT      | ...                               | 3,7   |\n * | Long localized date             | P       | 04/29/1453                        | 7     |\n * |                                 | PP      | Apr 29, 1453                      | 7     |\n * |                                 | PPP     | April 29th, 1453                  | 7     |\n * |                                 | PPPP    | Friday, April 29th, 1453          | 2,7   |\n * | Long localized time             | p       | 12:00 AM                          | 7     |\n * |                                 | pp      | 12:00:00 AM                       | 7     |\n * |                                 | ppp     | 12:00:00 AM GMT+2                 | 7     |\n * |                                 | pppp    | 12:00:00 AM GMT+02:00             | 2,7   |\n * | Combination of date and time    | Pp      | 04/29/1453, 12:00 AM              | 7     |\n * |                                 | PPpp    | Apr 29, 1453, 12:00:00 AM         | 7     |\n * |                                 | PPPppp  | April 29th, 1453 at ...           | 7     |\n * |                                 | PPPPpppp| Friday, April 29th, 1453 at ...   | 2,7   |\n * Notes:\n * 1. \"Formatting\" units (e.g. formatting quarter) in the default en-US locale\n *    are the same as \"stand-alone\" units, but are different in some languages.\n *    \"Formatting\" units are declined according to the rules of the language\n *    in the context of a date. \"Stand-alone\" units are always nominative singular:\n *\n *    `format(new Date(2017, 10, 6), 'do LLLL', {locale: cs}) //=> '6. listopad'`\n *\n *    `format(new Date(2017, 10, 6), 'do MMMM', {locale: cs}) //=> '6. listopadu'`\n *\n * 2. Any sequence of the identical letters is a pattern, unless it is escaped by\n *    the single quote characters (see below).\n *    If the sequence is longer than listed in table (e.g. `EEEEEEEEEEE`)\n *    the output will be the same as default pattern for this unit, usually\n *    the longest one (in case of ISO weekdays, `EEEE`). Default patterns for units\n *    are marked with \"2\" in the last column of the table.\n *\n *    `format(new Date(2017, 10, 6), 'MMM') //=> 'Nov'`\n *\n *    `format(new Date(2017, 10, 6), 'MMMM') //=> 'November'`\n *\n *    `format(new Date(2017, 10, 6), 'MMMMM') //=> 'N'`\n *\n *    `format(new Date(2017, 10, 6), 'MMMMMM') //=> 'November'`\n *\n *    `format(new Date(2017, 10, 6), 'MMMMMMM') //=> 'November'`\n *\n * 3. Some patterns could be unlimited length (such as `yyyyyyyy`).\n *    The output will be padded with zeros to match the length of the pattern.\n *\n *    `format(new Date(2017, 10, 6), 'yyyyyyyy') //=> '00002017'`\n *\n * 4. `QQQQQ` and `qqqqq` could be not strictly numerical in some locales.\n *    These tokens represent the shortest form of the quarter.\n *\n * 5. The main difference between `y` and `u` patterns are B.C. years:\n *\n *    | Year | `y` | `u` |\n *    |------|-----|-----|\n *    | AC 1 |   1 |   1 |\n *    | BC 1 |   1 |   0 |\n *    | BC 2 |   2 |  -1 |\n *\n *    Also `yy` always returns the last two digits of a year,\n *    while `uu` pads single digit years to 2 characters and returns other years unchanged:\n *\n *    | Year | `yy` | `uu` |\n *    |------|------|------|\n *    | 1    |   01 |   01 |\n *    | 14   |   14 |   14 |\n *    | 376  |   76 |  376 |\n *    | 1453 |   53 | 1453 |\n *\n *    The same difference is true for local and ISO week-numbering years (`Y` and `R`),\n *    except local week-numbering years are dependent on `options.weekStartsOn`\n *    and `options.firstWeekContainsDate` (compare [getISOWeekYear](https://date-fns.org/docs/getISOWeekYear)\n *    and [getWeekYear](https://date-fns.org/docs/getWeekYear)).\n *\n * 6. Specific non-location timezones are currently unavailable in `date-fns`,\n *    so right now these tokens fall back to GMT timezones.\n *\n * 7. These patterns are not in the Unicode Technical Standard #35:\n *    - `i`: ISO day of week\n *    - `I`: ISO week of year\n *    - `R`: ISO week-numbering year\n *    - `t`: seconds timestamp\n *    - `T`: milliseconds timestamp\n *    - `o`: ordinal number modifier\n *    - `P`: long localized date\n *    - `p`: long localized time\n *\n * 8. `YY` and `YYYY` tokens represent week-numbering years but they are often confused with years.\n *    You should enable `options.useAdditionalWeekYearTokens` to use them. See: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md\n *\n * 9. `D` and `DD` tokens represent days of the year but they are often confused with days of the month.\n *    You should enable `options.useAdditionalDayOfYearTokens` to use them. See: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md\n *\n * @param date - The original date\n * @param format - The string of tokens\n * @param options - An object with options\n *\n * @returns The formatted date string\n *\n * @throws `date` must not be Invalid Date\n * @throws `options.locale` must contain `localize` property\n * @throws `options.locale` must contain `formatLong` property\n * @throws use `yyyy` instead of `YYYY` for formatting years using [format provided] to the input [input provided]; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md\n * @throws use `yy` instead of `YY` for formatting years using [format provided] to the input [input provided]; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md\n * @throws use `d` instead of `D` for formatting days of the month using [format provided] to the input [input provided]; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md\n * @throws use `dd` instead of `DD` for formatting days of the month using [format provided] to the input [input provided]; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md\n * @throws format string contains an unescaped latin alphabet character\n *\n * @example\n * // Represent 11 February 2014 in middle-endian format:\n * const result = format(new Date(2014, 1, 11), 'MM/dd/yyyy')\n * //=> '02/11/2014'\n *\n * @example\n * // Represent 2 July 2014 in Esperanto:\n * import { eoLocale } from 'date-fns/locale/eo'\n * const result = format(new Date(2014, 6, 2), \"do 'de' MMMM yyyy\", {\n *   locale: eoLocale\n * })\n * //=> '2-a de julio 2014'\n *\n * @example\n * // Escape string by single quote characters:\n * const result = format(new Date(2014, 6, 2, 15), \"h 'o''clock'\")\n * //=> \"3 o'clock\"\n */\nexport function format(date, formatStr, options) {\n  const defaultOptions = getDefaultOptions();\n  const locale = options?.locale ?? defaultOptions.locale ?? defaultLocale;\n\n  const firstWeekContainsDate =\n    options?.firstWeekContainsDate ??\n    options?.locale?.options?.firstWeekContainsDate ??\n    defaultOptions.firstWeekContainsDate ??\n    defaultOptions.locale?.options?.firstWeekContainsDate ??\n    1;\n\n  const weekStartsOn =\n    options?.weekStartsOn ??\n    options?.locale?.options?.weekStartsOn ??\n    defaultOptions.weekStartsOn ??\n    defaultOptions.locale?.options?.weekStartsOn ??\n    0;\n\n  const originalDate = toDate(date, options?.in);\n\n  if (!isValid(originalDate)) {\n    throw new RangeError(\"Invalid time value\");\n  }\n\n  let parts = formatStr\n    .match(longFormattingTokensRegExp)\n    .map((substring) => {\n      const firstCharacter = substring[0];\n      if (firstCharacter === \"p\" || firstCharacter === \"P\") {\n        const longFormatter = longFormatters[firstCharacter];\n        return longFormatter(substring, locale.formatLong);\n      }\n      return substring;\n    })\n    .join(\"\")\n    .match(formattingTokensRegExp)\n    .map((substring) => {\n      // Replace two single quote characters with one single quote character\n      if (substring === \"''\") {\n        return { isToken: false, value: \"'\" };\n      }\n\n      const firstCharacter = substring[0];\n      if (firstCharacter === \"'\") {\n        return { isToken: false, value: cleanEscapedString(substring) };\n      }\n\n      if (formatters[firstCharacter]) {\n        return { isToken: true, value: substring };\n      }\n\n      if (firstCharacter.match(unescapedLatinCharacterRegExp)) {\n        throw new RangeError(\n          \"Format string contains an unescaped latin alphabet character `\" +\n            firstCharacter +\n            \"`\",\n        );\n      }\n\n      return { isToken: false, value: substring };\n    });\n\n  // invoke localize preprocessor (only for french locales at the moment)\n  if (locale.localize.preprocessor) {\n    parts = locale.localize.preprocessor(originalDate, parts);\n  }\n\n  const formatterOptions = {\n    firstWeekContainsDate,\n    weekStartsOn,\n    locale,\n  };\n\n  return parts\n    .map((part) => {\n      if (!part.isToken) return part.value;\n\n      const token = part.value;\n\n      if (\n        (!options?.useAdditionalWeekYearTokens &&\n          isProtectedWeekYearToken(token)) ||\n        (!options?.useAdditionalDayOfYearTokens &&\n          isProtectedDayOfYearToken(token))\n      ) {\n        warnOrThrowProtectedError(token, formatStr, String(date));\n      }\n\n      const formatter = formatters[token[0]];\n      return formatter(originalDate, token, locale.localize, formatterOptions);\n    })\n    .join(\"\");\n}\n\nfunction cleanEscapedString(input) {\n  const matched = input.match(escapedStringRegExp);\n\n  if (!matched) {\n    return input;\n  }\n\n  return matched[1].replace(doubleQuoteRegExp, \"'\");\n}\n\n// Fallback for modularized imports:\nexport default format;\n","import { defaultLocale } from \"./_lib/defaultLocale.js\";\nimport { getDefaultOptions } from \"./_lib/defaultOptions.js\";\nimport { getTimezoneOffsetInMilliseconds } from \"./_lib/getTimezoneOffsetInMilliseconds.js\";\nimport { normalizeDates } from \"./_lib/normalizeDates.js\";\nimport { compareAsc } from \"./compareAsc.js\";\nimport { minutesInDay, minutesInMonth } from \"./constants.js\";\nimport { differenceInMonths } from \"./differenceInMonths.js\";\nimport { differenceInSeconds } from \"./differenceInSeconds.js\";\n\n/**\n * The {@link formatDistance} function options.\n */\n\n/**\n * @name formatDistance\n * @category Common Helpers\n * @summary Return the distance between the given dates in words.\n *\n * @description\n * Return the distance between the given dates in words.\n *\n * | Distance between dates                                            | Result              |\n * |-------------------------------------------------------------------|---------------------|\n * | 0 ... 30 secs                                                     | less than a minute  |\n * | 30 secs ... 1 min 30 secs                                         | 1 minute            |\n * | 1 min 30 secs ... 44 mins 30 secs                                 | [2..44] minutes     |\n * | 44 mins ... 30 secs ... 89 mins 30 secs                           | about 1 hour        |\n * | 89 mins 30 secs ... 23 hrs 59 mins 30 secs                        | about [2..24] hours |\n * | 23 hrs 59 mins 30 secs ... 41 hrs 59 mins 30 secs                 | 1 day               |\n * | 41 hrs 59 mins 30 secs ... 29 days 23 hrs 59 mins 30 secs         | [2..30] days        |\n * | 29 days 23 hrs 59 mins 30 secs ... 44 days 23 hrs 59 mins 30 secs | about 1 month       |\n * | 44 days 23 hrs 59 mins 30 secs ... 59 days 23 hrs 59 mins 30 secs | about 2 months      |\n * | 59 days 23 hrs 59 mins 30 secs ... 1 yr                           | [2..12] months      |\n * | 1 yr ... 1 yr 3 months                                            | about 1 year        |\n * | 1 yr 3 months ... 1 yr 9 month s                                  | over 1 year         |\n * | 1 yr 9 months ... 2 yrs                                           | almost 2 years      |\n * | N yrs ... N yrs 3 months                                          | about N years       |\n * | N yrs 3 months ... N yrs 9 months                                 | over N years        |\n * | N yrs 9 months ... N+1 yrs                                        | almost N+1 years    |\n *\n * With `options.includeSeconds == true`:\n * | Distance between dates | Result               |\n * |------------------------|----------------------|\n * | 0 secs ... 5 secs      | less than 5 seconds  |\n * | 5 secs ... 10 secs     | less than 10 seconds |\n * | 10 secs ... 20 secs    | less than 20 seconds |\n * | 20 secs ... 40 secs    | half a minute        |\n * | 40 secs ... 60 secs    | less than a minute   |\n * | 60 secs ... 90 secs    | 1 minute             |\n *\n * @param laterDate - The date\n * @param earlierDate - The date to compare with\n * @param options - An object with options\n *\n * @returns The distance in words\n *\n * @throws `date` must not be Invalid Date\n * @throws `baseDate` must not be Invalid Date\n * @throws `options.locale` must contain `formatDistance` property\n *\n * @example\n * // What is the distance between 2 July 2014 and 1 January 2015?\n * const result = formatDistance(new Date(2014, 6, 2), new Date(2015, 0, 1))\n * //=> '6 months'\n *\n * @example\n * // What is the distance between 1 January 2015 00:00:15\n * // and 1 January 2015 00:00:00, including seconds?\n * const result = formatDistance(\n *   new Date(2015, 0, 1, 0, 0, 15),\n *   new Date(2015, 0, 1, 0, 0, 0),\n *   { includeSeconds: true }\n * )\n * //=> 'less than 20 seconds'\n *\n * @example\n * // What is the distance from 1 January 2016\n * // to 1 January 2015, with a suffix?\n * const result = formatDistance(new Date(2015, 0, 1), new Date(2016, 0, 1), {\n *   addSuffix: true\n * })\n * //=> 'about 1 year ago'\n *\n * @example\n * // What is the distance between 1 August 2016 and 1 January 2015 in Esperanto?\n * import { eoLocale } from 'date-fns/locale/eo'\n * const result = formatDistance(new Date(2016, 7, 1), new Date(2015, 0, 1), {\n *   locale: eoLocale\n * })\n * //=> 'pli ol 1 jaro'\n */\nexport function formatDistance(laterDate, earlierDate, options) {\n  const defaultOptions = getDefaultOptions();\n  const locale = options?.locale ?? defaultOptions.locale ?? defaultLocale;\n  const minutesInAlmostTwoDays = 2520;\n\n  const comparison = compareAsc(laterDate, earlierDate);\n\n  if (isNaN(comparison)) throw new RangeError(\"Invalid time value\");\n\n  const localizeOptions = Object.assign({}, options, {\n    addSuffix: options?.addSuffix,\n    comparison: comparison,\n  });\n\n  const [laterDate_, earlierDate_] = normalizeDates(\n    options?.in,\n    ...(comparison > 0 ? [earlierDate, laterDate] : [laterDate, earlierDate]),\n  );\n\n  const seconds = differenceInSeconds(earlierDate_, laterDate_);\n  const offsetInSeconds =\n    (getTimezoneOffsetInMilliseconds(earlierDate_) -\n      getTimezoneOffsetInMilliseconds(laterDate_)) /\n    1000;\n  const minutes = Math.round((seconds - offsetInSeconds) / 60);\n  let months;\n\n  // 0 up to 2 mins\n  if (minutes < 2) {\n    if (options?.includeSeconds) {\n      if (seconds < 5) {\n        return locale.formatDistance(\"lessThanXSeconds\", 5, localizeOptions);\n      } else if (seconds < 10) {\n        return locale.formatDistance(\"lessThanXSeconds\", 10, localizeOptions);\n      } else if (seconds < 20) {\n        return locale.formatDistance(\"lessThanXSeconds\", 20, localizeOptions);\n      } else if (seconds < 40) {\n        return locale.formatDistance(\"halfAMinute\", 0, localizeOptions);\n      } else if (seconds < 60) {\n        return locale.formatDistance(\"lessThanXMinutes\", 1, localizeOptions);\n      } else {\n        return locale.formatDistance(\"xMinutes\", 1, localizeOptions);\n      }\n    } else {\n      if (minutes === 0) {\n        return locale.formatDistance(\"lessThanXMinutes\", 1, localizeOptions);\n      } else {\n        return locale.formatDistance(\"xMinutes\", minutes, localizeOptions);\n      }\n    }\n\n    // 2 mins up to 0.75 hrs\n  } else if (minutes < 45) {\n    return locale.formatDistance(\"xMinutes\", minutes, localizeOptions);\n\n    // 0.75 hrs up to 1.5 hrs\n  } else if (minutes < 90) {\n    return locale.formatDistance(\"aboutXHours\", 1, localizeOptions);\n\n    // 1.5 hrs up to 24 hrs\n  } else if (minutes < minutesInDay) {\n    const hours = Math.round(minutes / 60);\n    return locale.formatDistance(\"aboutXHours\", hours, localizeOptions);\n\n    // 1 day up to 1.75 days\n  } else if (minutes < minutesInAlmostTwoDays) {\n    return locale.formatDistance(\"xDays\", 1, localizeOptions);\n\n    // 1.75 days up to 30 days\n  } else if (minutes < minutesInMonth) {\n    const days = Math.round(minutes / minutesInDay);\n    return locale.formatDistance(\"xDays\", days, localizeOptions);\n\n    // 1 month up to 2 months\n  } else if (minutes < minutesInMonth * 2) {\n    months = Math.round(minutes / minutesInMonth);\n    return locale.formatDistance(\"aboutXMonths\", months, localizeOptions);\n  }\n\n  months = differenceInMonths(earlierDate_, laterDate_);\n\n  // 2 months up to 12 months\n  if (months < 12) {\n    const nearestMonth = Math.round(minutes / minutesInMonth);\n    return locale.formatDistance(\"xMonths\", nearestMonth, localizeOptions);\n\n    // 1 year up to max Date\n  } else {\n    const monthsSinceStartOfYear = months % 12;\n    const years = Math.trunc(months / 12);\n\n    // N years up to 1 years 3 months\n    if (monthsSinceStartOfYear < 3) {\n      return locale.formatDistance(\"aboutXYears\", years, localizeOptions);\n\n      // N years 3 months up to N years 9 months\n    } else if (monthsSinceStartOfYear < 9) {\n      return locale.formatDistance(\"overXYears\", years, localizeOptions);\n\n      // N years 9 months up to N year 12 months\n    } else {\n      return locale.formatDistance(\"almostXYears\", years + 1, localizeOptions);\n    }\n  }\n}\n\n// Fallback for modularized imports:\nexport default formatDistance;\n","import { constructNow } from \"./constructNow.js\";\n\nimport { formatDistance } from \"./formatDistance.js\";\n\n/**\n * The {@link formatDistanceToNow} function options.\n */\n\n/**\n * @name formatDistanceToNow\n * @category Common Helpers\n * @summary Return the distance between the given date and now in words.\n * @pure false\n *\n * @description\n * Return the distance between the given date and now in words.\n *\n * | Distance to now                                                   | Result              |\n * |-------------------------------------------------------------------|---------------------|\n * | 0 ... 30 secs                                                     | less than a minute  |\n * | 30 secs ... 1 min 30 secs                                         | 1 minute            |\n * | 1 min 30 secs ... 44 mins 30 secs                                 | [2..44] minutes     |\n * | 44 mins ... 30 secs ... 89 mins 30 secs                           | about 1 hour        |\n * | 89 mins 30 secs ... 23 hrs 59 mins 30 secs                        | about [2..24] hours |\n * | 23 hrs 59 mins 30 secs ... 41 hrs 59 mins 30 secs                 | 1 day               |\n * | 41 hrs 59 mins 30 secs ... 29 days 23 hrs 59 mins 30 secs         | [2..30] days        |\n * | 29 days 23 hrs 59 mins 30 secs ... 44 days 23 hrs 59 mins 30 secs | about 1 month       |\n * | 44 days 23 hrs 59 mins 30 secs ... 59 days 23 hrs 59 mins 30 secs | about 2 months      |\n * | 59 days 23 hrs 59 mins 30 secs ... 1 yr                           | [2..12] months      |\n * | 1 yr ... 1 yr 3 months                                            | about 1 year        |\n * | 1 yr 3 months ... 1 yr 9 month s                                  | over 1 year         |\n * | 1 yr 9 months ... 2 yrs                                           | almost 2 years      |\n * | N yrs ... N yrs 3 months                                          | about N years       |\n * | N yrs 3 months ... N yrs 9 months                                 | over N years        |\n * | N yrs 9 months ... N+1 yrs                                        | almost N+1 years    |\n *\n * With `options.includeSeconds == true`:\n * | Distance to now     | Result               |\n * |---------------------|----------------------|\n * | 0 secs ... 5 secs   | less than 5 seconds  |\n * | 5 secs ... 10 secs  | less than 10 seconds |\n * | 10 secs ... 20 secs | less than 20 seconds |\n * | 20 secs ... 40 secs | half a minute        |\n * | 40 secs ... 60 secs | less than a minute   |\n * | 60 secs ... 90 secs | 1 minute             |\n *\n * @param date - The given date\n * @param options - The object with options\n *\n * @returns The distance in words\n *\n * @throws `date` must not be Invalid Date\n * @throws `options.locale` must contain `formatDistance` property\n *\n * @example\n * // If today is 1 January 2015, what is the distance to 2 July 2014?\n * const result = formatDistanceToNow(\n *   new Date(2014, 6, 2)\n * )\n * //=> '6 months'\n *\n * @example\n * // If now is 1 January 2015 00:00:00,\n * // what is the distance to 1 January 2015 00:00:15, including seconds?\n * const result = formatDistanceToNow(\n *   new Date(2015, 0, 1, 0, 0, 15),\n *   {includeSeconds: true}\n * )\n * //=> 'less than 20 seconds'\n *\n * @example\n * // If today is 1 January 2015,\n * // what is the distance to 1 January 2016, with a suffix?\n * const result = formatDistanceToNow(\n *   new Date(2016, 0, 1),\n *   {addSuffix: true}\n * )\n * //=> 'in about 1 year'\n *\n * @example\n * // If today is 1 January 2015,\n * // what is the distance to 1 August 2016 in Esperanto?\n * const eoLocale = require('date-fns/locale/eo')\n * const result = formatDistanceToNow(\n *   new Date(2016, 7, 1),\n *   {locale: eoLocale}\n * )\n * //=> 'pli ol 1 jaro'\n */\nexport function formatDistanceToNow(date, options) {\n  return formatDistance(date, constructNow(date), options);\n}\n\n// Fallback for modularized imports:\nexport default formatDistanceToNow;\n","import { normalizeDates } from \"./_lib/normalizeDates.js\";\nimport { startOfWeek } from \"./startOfWeek.js\";\n\n/**\n * The {@link isSameWeek} function options.\n */\n\n/**\n * @name isSameWeek\n * @category Week Helpers\n * @summary Are the given dates in the same week (and month and year)?\n *\n * @description\n * Are the given dates in the same week (and month and year)?\n *\n * @param laterDate - The first date to check\n * @param earlierDate - The second date to check\n * @param options - An object with options\n *\n * @returns The dates are in the same week (and month and year)\n *\n * @example\n * // Are 31 August 2014 and 4 September 2014 in the same week?\n * const result = isSameWeek(new Date(2014, 7, 31), new Date(2014, 8, 4))\n * //=> true\n *\n * @example\n * // If week starts with Monday,\n * // are 31 August 2014 and 4 September 2014 in the same week?\n * const result = isSameWeek(new Date(2014, 7, 31), new Date(2014, 8, 4), {\n *   weekStartsOn: 1\n * })\n * //=> false\n *\n * @example\n * // Are 1 January 2014 and 1 January 2015 in the same week?\n * const result = isSameWeek(new Date(2014, 0, 1), new Date(2015, 0, 1))\n * //=> false\n */\nexport function isSameWeek(laterDate, earlierDate, options) {\n  const [laterDate_, earlierDate_] = normalizeDates(\n    options?.in,\n    laterDate,\n    earlierDate,\n  );\n  return (\n    +startOfWeek(laterDate_, options) === +startOfWeek(earlierDate_, options)\n  );\n}\n\n// Fallback for modularized imports:\nexport default isSameWeek;\n","import { constructFrom } from \"./constructFrom.js\";\nimport { constructNow } from \"./constructNow.js\";\nimport { isSameDay } from \"./isSameDay.js\";\n\n/**\n * The {@link isToday} function options.\n */\n\n/**\n * @name isToday\n * @category Day Helpers\n * @summary Is the given date today?\n * @pure false\n *\n * @description\n * Is the given date today?\n *\n * @param date - The date to check\n * @param options - An object with options\n *\n * @returns The date is today\n *\n * @example\n * // If today is 6 October 2014, is 6 October 14:00:00 today?\n * const result = isToday(new Date(2014, 9, 6, 14, 0))\n * //=> true\n */\nexport function isToday(date, options) {\n  return isSameDay(\n    constructFrom(options?.in || date, date),\n    constructNow(options?.in || date),\n  );\n}\n\n// Fallback for modularized imports:\nexport default isToday;\n","import { addDays } from \"./addDays.js\";\n\n/**\n * The {@link subDays} function options.\n */\n\n/**\n * @name subDays\n * @category Day Helpers\n * @summary Subtract the specified number of days from the given date.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The date to be changed\n * @param amount - The amount of days to be subtracted.\n * @param options - An object with options\n *\n * @returns The new date with the days subtracted\n *\n * @example\n * // Subtract 10 days from 1 September 2014:\n * const result = subDays(new Date(2014, 8, 1), 10)\n * //=> Fri Aug 22 2014 00:00:00\n */\nexport function subDays(date, amount, options) {\n  return addDays(date, -amount, options);\n}\n\n// Fallback for modularized imports:\nexport default subDays;\n","import { constructFrom } from \"./constructFrom.js\";\nimport { constructNow } from \"./constructNow.js\";\nimport { isSameDay } from \"./isSameDay.js\";\nimport { subDays } from \"./subDays.js\";\n\n/**\n * The {@link isYesterday} function options.\n */\n\n/**\n * @name isYesterday\n * @category Day Helpers\n * @summary Is the given date yesterday?\n * @pure false\n *\n * @description\n * Is the given date yesterday?\n *\n * @param date - The date to check\n * @param options - An object with options\n *\n * @returns The date is yesterday\n *\n * @example\n * // If today is 6 October 2014, is 5 October 14:00:00 yesterday?\n * const result = isYesterday(new Date(2014, 9, 5, 14, 0))\n * //=> true\n */\nexport function isYesterday(date, options) {\n  return isSameDay(\n    constructFrom(options?.in || date, date),\n    subDays(constructNow(options?.in || date), 1),\n  );\n}\n\n// Fallback for modularized imports:\nexport default isYesterday;\n","import { useState, useEffect, useCallback } from 'react';\r\nimport { useSearchParams } from 'react-router-dom';\r\nimport {\r\n  Container,\r\n  Box,\r\n  Typography,\r\n  Grid,\r\n  CircularProgress,\r\n  Alert,\r\n  Card,\r\n  CardContent,\r\n  CardMedia,\r\n  CardActions,\r\n  Chip,\r\n  IconButton,\r\n  Select,\r\n  MenuItem,\r\n  FormControl,\r\n  InputLabel,\r\n  useTheme,\r\n  Snackbar\r\n} from '@mui/material';\r\nimport {\r\n  LocationOn as LocationIcon,\r\n  Category as CategoryIcon,\r\n  AccessTime as TimeIcon,\r\n  Favorite as FavoriteIcon,\r\n  FavoriteBorder as FavoriteBorderIcon\r\n} from '@mui/icons-material';\r\nimport { collection, query, onSnapshot } from 'firebase/firestore';\r\nimport { db } from '../config/firebase';\r\nimport SearchBar from '../components/SearchBar';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useFavorites } from '../hooks/useFavorites';\r\nimport debounce from 'lodash/debounce';\r\nimport { formatDistanceToNow } from 'date-fns';\r\nimport AnimatedPage from '../components/AnimatedPage';\r\nimport { SelectChangeEvent } from '@mui/material';\r\n\r\ninterface Listing {\r\n  id: string;\r\n  title: string;\r\n  description: string;\r\n  category: string;\r\n  condition: string;\r\n  images: string[];\r\n  userEmail: string;\r\n  userName: string;\r\n  createdAt: any;\r\n  location: {\r\n    latitude: number;\r\n    longitude: number;\r\n    address: string;\r\n  };\r\n}\r\n\r\nconst Search = () => {\r\n  const [searchParams, setSearchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  const theme = useTheme();\r\n  \r\n  const [searchQuery, setSearchQuery] = useState(searchParams.get('q') || '');\r\n  const [listings, setListings] = useState<Listing[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [categoryFilter, setCategoryFilter] = useState(searchParams.get('category') || 'all');\r\n  const { toggleFavorite, isFavorite } = useFavorites();\r\n  const [snackbarOpen, setSnackbarOpen] = useState(false);\r\n  const [snackbarMessage, setSnackbarMessage] = useState('');\r\n\r\n  const defaultCategories = [\r\n    'all',\r\n    'Дрехи',\r\n    'Електроника',\r\n    'Книги',\r\n    'Мебели',\r\n    'Спортни стоки',\r\n    'Други'\r\n  ];\r\n\r\n  // Category mapping\r\n  const categoryMap: { [key: string]: string } = {\r\n    'all': 'all',\r\n    'clothing': 'Дрехи',\r\n    'electronics': 'Електроника',\r\n    'books': 'Книги',\r\n    'furniture': 'Мебели',\r\n    'sports': 'Спортни стоки',\r\n    'other': 'Други',\r\n    // Reverse mapping\r\n    'Дрехи': 'Дрехи',\r\n    'Електроника': 'Електроника',\r\n    'Книги': 'Книги',\r\n    'Мебели': 'Мебели',\r\n    'Спортни стоки': 'Спортни стоки',\r\n    'Други': 'Други'\r\n  } as const;\r\n\r\n  // Get unique categories from listings\r\n  const categories = [...new Set([...defaultCategories, ...listings.map(listing => listing.category)])];\r\n\r\n  // Update category filter when URL changes\r\n  useEffect(() => {\r\n    const category = searchParams.get('category');\r\n    if (category) {\r\n      // Map English category to Bulgarian\r\n      setCategoryFilter(categoryMap[category.toLowerCase()] || 'all');\r\n    }\r\n  }, [searchParams]);\r\n\r\n  const handleCategoryChange = (event: SelectChangeEvent<string>) => {\r\n    const newCategory = event.target.value;\r\n    setCategoryFilter(newCategory);\r\n    \r\n    // Update URL parameters while preserving the search query if it exists\r\n    const query = searchParams.get('q');\r\n    const newParams: { q?: string; category?: string } = {};\r\n    if (query) {\r\n      newParams.q = query;\r\n    }\r\n    if (newCategory !== 'all') {\r\n      newParams.category = newCategory;\r\n    }\r\n    setSearchParams(newParams);\r\n  };\r\n\r\n  const searchListings = useCallback((searchText: string) => {\r\n    setLoading(true);\r\n    setError('');\r\n\r\n    try {\r\n      const listingsRef = collection(db, 'listings');\r\n      const q = query(listingsRef);\r\n\r\n      // Create real-time subscription\r\n      const unsubscribe = onSnapshot(q, \r\n        (querySnapshot) => {\r\n          const allListings = querySnapshot.docs.map(doc => {\r\n            const data = doc.data();\r\n            return {\r\n              id: doc.id,\r\n              title: data.title || '',\r\n              description: data.description || '',\r\n              category: data.category || '',\r\n              condition: data.condition || '',\r\n              images: data.images || [],\r\n              userEmail: data.userEmail || '',\r\n              userName: data.userName || '',\r\n              createdAt: data.createdAt?.toDate() || new Date(),\r\n              location: data.location || { latitude: 0, longitude: 0, address: '' }\r\n            } as Listing;\r\n          });\r\n\r\n          let results = allListings;\r\n\r\n          // Apply search filter if there's a search query\r\n          if (searchText.trim()) {\r\n            const searchTerms = searchText\r\n              .toLowerCase()\r\n              .trim()\r\n              .split(/\\s+/)\r\n              .filter(term => term.length >= 2);\r\n\r\n            results = allListings.filter(listing => {\r\n              const titleLower = listing.title.toLowerCase();\r\n              const descriptionLower = listing.description.toLowerCase();\r\n              const categoryLower = listing.category.toLowerCase();\r\n              \r\n              return searchTerms.some(term => \r\n                titleLower.includes(term) || \r\n                descriptionLower.includes(term) || \r\n                categoryLower.includes(term)\r\n              );\r\n            });\r\n          }\r\n\r\n          // Apply category filter only if it's not 'all'\r\n          if (categoryFilter && categoryFilter !== 'all') {\r\n            results = results.filter(listing => {\r\n              const listingCategory = listing.category.toLowerCase();\r\n              const filterCategory = categoryFilter.toLowerCase();\r\n              return listingCategory === filterCategory || \r\n                     listingCategory === categoryMap[filterCategory]?.toLowerCase();\r\n            });\r\n          }\r\n\r\n          // Score and sort results\r\n          let sortedResults = results.map(listing => {\r\n            const score = searchText.trim() ? searchText.toLowerCase().split(/\\s+/).reduce((acc, term) => {\r\n              const titleMatch = listing.title.toLowerCase().includes(term) ? 3 : 0;\r\n              const descMatch = listing.description.toLowerCase().includes(term) ? 1 : 0;\r\n              const categoryMatch = listing.category.toLowerCase().includes(term) ? 2 : 0;\r\n              return acc + titleMatch + descMatch + categoryMatch;\r\n            }, 0) : 0;\r\n            return { ...listing, score };\r\n          });\r\n\r\n          // Apply sorting\r\n          sortedResults.sort((a, b) => b.createdAt - a.createdAt);\r\n\r\n          setListings(sortedResults.map(({ score, ...listing }) => listing));\r\n          setLoading(false);\r\n        },\r\n        (error) => {\r\n          console.error('Error searching listings:', error);\r\n          setError('Грешка при търсене на обяви. Моля, опитайте отново.');\r\n          setLoading(false);\r\n        }\r\n      );\r\n\r\n      return unsubscribe;\r\n    } catch (err) {\r\n      console.error('Error setting up search:', err);\r\n      setError('Грешка при настройка на търсенето. Моля, опитайте отново.');\r\n      setLoading(false);\r\n      return () => {};\r\n    }\r\n  }, [categoryFilter]);\r\n\r\n  const debouncedSearch = useCallback(\r\n    debounce((query: string) => {\r\n      const unsubscribe = searchListings(query);\r\n      return () => {\r\n        unsubscribe();\r\n      };\r\n    }, 300),\r\n    [searchListings]\r\n  );\r\n\r\n  useEffect(() => {\r\n    const query = searchParams.get('q');\r\n    let unsubscribe: () => void;\r\n    \r\n    if (query) {\r\n      setSearchQuery(query);\r\n      unsubscribe = searchListings(query);\r\n    }\r\n    \r\n    return () => {\r\n      debouncedSearch.cancel();\r\n      if (unsubscribe) {\r\n        unsubscribe();\r\n      }\r\n    };\r\n  }, [searchParams, searchListings]);\r\n\r\n  useEffect(() => {\r\n    const categoryParam = searchParams.get('category');\r\n    if (categoryParam) {\r\n      setCategoryFilter(categoryParam);\r\n      // If there's no search query but there's a category, search with empty string to show all items in category\r\n      if (!searchQuery) {\r\n        const unsubscribe = searchListings(' ');\r\n        return () => {\r\n          if (typeof unsubscribe === 'function') {\r\n            unsubscribe();\r\n          }\r\n        };\r\n      }\r\n    }\r\n  }, [searchParams, searchQuery, searchListings]);\r\n\r\n  useEffect(() => {\r\n    if (!searchQuery) return;\r\n    \r\n    const unsubscribe = debouncedSearch(searchQuery);\r\n    return () => {\r\n      if (typeof unsubscribe === 'function') {\r\n        unsubscribe();\r\n      }\r\n    };\r\n  }, [debouncedSearch, searchQuery]);\r\n\r\n  const handleSearch = (newQuery: string) => {\r\n    setSearchQuery(newQuery);\r\n    // Update URL parameters while preserving the category if it exists\r\n    const category = searchParams.get('category');\r\n    const newParams: { q?: string; category?: string } = { q: newQuery };\r\n    if (category) {\r\n      newParams.category = category;\r\n    }\r\n    setSearchParams(newParams);\r\n  };\r\n\r\n  const handleListingClick = (listing: Listing) => {\r\n    navigate(`/listing/${listing.id}`, {\r\n      state: { listing }\r\n    });\r\n  };\r\n\r\n  const handleFavoriteClick = async (e: React.MouseEvent, listing: Listing) => {\r\n    e.stopPropagation();\r\n    try {\r\n      await toggleFavorite(listing.id);\r\n      setSnackbarMessage(isFavorite(listing.id) ? 'Премахнато от любими' : 'Добавено към любими');\r\n      setSnackbarOpen(true);\r\n    } catch (error) {\r\n      console.error('Error toggling favorite:', error);\r\n      setSnackbarMessage('Грешка при добавяне към любими');\r\n      setSnackbarOpen(true);\r\n    }\r\n  };\r\n\r\n  const formatDate = (date: any) => {\r\n    if (!date) return 'неизвестна дата';\r\n    \r\n    try {\r\n      if (typeof date === 'string') {\r\n        return formatDistanceToNow(new Date(date), { addSuffix: true });\r\n      } else if (typeof date === 'object' && 'seconds' in date) {\r\n        return formatDistanceToNow(new Date(date.seconds * 1000), { addSuffix: true });\r\n      }\r\n      return 'неизвестна дата';\r\n    } catch (error) {\r\n      console.error('Error formatting date:', error);\r\n      return 'неизвестна дата';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <AnimatedPage animation=\"fade\">\r\n      <Box sx={{ pt: 8 }}>\r\n        <Container maxWidth=\"lg\">\r\n          <AnimatedPage animation=\"slide\" delay={0.2}>\r\n            <Box sx={{ mb: 4 }}>\r\n              <Typography \r\n                variant=\"h4\" \r\n                component=\"h1\" \r\n                gutterBottom\r\n                sx={{ \r\n                  textAlign: 'center',\r\n                  fontWeight: 'bold',\r\n                  mb: 3,\r\n                  background: 'linear-gradient(45deg, #2196F3 30%, #4CAF50 90%)',\r\n                  WebkitBackgroundClip: 'text',\r\n                  WebkitTextFillColor: 'transparent'\r\n                }}\r\n              >\r\n                Дайте втори живот на вещите си\r\n              </Typography>\r\n              <Typography \r\n                variant=\"subtitle1\" \r\n                gutterBottom \r\n                sx={{ \r\n                  textAlign: 'center',\r\n                  mb: 4,\r\n                  color: 'text.secondary'\r\n                }}\r\n              >\r\n                Разменете, споделете, намерете съкровища\r\n              </Typography>\r\n              <Box sx={{ display: 'flex', gap: 2, flexWrap: 'wrap' }}>\r\n                <Box sx={{ flexGrow: 1 }}>\r\n                  <SearchBar\r\n                    variant=\"search\"\r\n                    placeholder=\"Намерете подходящият за вас продукт...\"\r\n                    value={searchQuery}\r\n                    onChange={handleSearch}\r\n                  />\r\n                </Box>\r\n                <FormControl sx={{ minWidth: 200 }}>\r\n                  <InputLabel>Категория</InputLabel>\r\n                  <Select\r\n                    value={categoryFilter}\r\n                    onChange={handleCategoryChange}\r\n                    label=\"Категория\"\r\n                  >\r\n                    <MenuItem value=\"all\">Всички категории</MenuItem>\r\n                    {categories.filter(cat => cat !== 'all').map((category) => (\r\n                      <MenuItem key={category} value={category}>\r\n                        {category}\r\n                      </MenuItem>\r\n                    ))}\r\n                  </Select>\r\n                </FormControl>\r\n              </Box>\r\n            </Box>\r\n          </AnimatedPage>\r\n\r\n          {loading ? (\r\n            <Box sx={{ display: 'flex', justifyContent: 'center', py: 8 }}>\r\n              <CircularProgress />\r\n            </Box>\r\n          ) : error ? (\r\n            <Alert severity=\"error\" sx={{ mt: 4 }}>\r\n              {error}\r\n            </Alert>\r\n          ) : listings.length === 0 ? (\r\n            <AnimatedPage animation=\"fade\" delay={0.6}>\r\n              <Alert severity=\"info\" sx={{ mt: 4 }}>\r\n                Няма намерени обяви, отговарящи на критериите за търсене.\r\n              </Alert>\r\n            </AnimatedPage>\r\n          ) : (\r\n            <Grid container spacing={4}>\r\n              {listings.map((listing, index) => (\r\n                <Grid item xs={12} sm={6} md={4} key={listing.id}>\r\n                  <AnimatedPage animation=\"scale\" delay={0.4 + index * 0.1}>\r\n                    <Card\r\n                      sx={{\r\n                        height: '100%',\r\n                        display: 'flex',\r\n                        flexDirection: 'column',\r\n                        cursor: 'pointer',\r\n                        transition: 'all 0.2s ease-in-out',\r\n                        '&:hover': {\r\n                          transform: 'translateY(-4px)',\r\n                          boxShadow: theme.shadows[4],\r\n                        },\r\n                      }}\r\n                      onClick={() => handleListingClick(listing)}\r\n                    >\r\n                      <CardMedia\r\n                        component=\"img\"\r\n                        height=\"200\"\r\n                        image={listing.images[0] || '/placeholder-image.jpg'}\r\n                        alt={listing.title}\r\n                        sx={{ objectFit: 'cover' }}\r\n                      />\r\n                      <CardContent sx={{ flexGrow: 1 }}>\r\n                        <Typography variant=\"h6\" gutterBottom>\r\n                          {listing.title}\r\n                        </Typography>\r\n                        <Typography \r\n                          variant=\"body2\" \r\n                          color=\"text.secondary\"\r\n                          sx={{ \r\n                            mb: 2,\r\n                            display: '-webkit-box',\r\n                            WebkitLineClamp: 2,\r\n                            WebkitBoxOrient: 'vertical',\r\n                            overflow: 'hidden'\r\n                          }}\r\n                        >\r\n                          {listing.description}\r\n                        </Typography>\r\n                        <Box sx={{ display: 'flex', gap: 1, mb: 2 }}>\r\n                          <Chip \r\n                            icon={<CategoryIcon />} \r\n                            label={listing.category}\r\n                            size=\"small\"\r\n                          />\r\n                          <Chip \r\n                            label={listing.condition}\r\n                            size=\"small\"\r\n                            color=\"primary\"\r\n                            variant=\"outlined\"\r\n                          />\r\n                        </Box>\r\n                        <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n                          <LocationIcon fontSize=\"small\" color=\"action\" />\r\n                          <Typography variant=\"body2\" color=\"text.secondary\">\r\n                            {listing.location.address}\r\n                          </Typography>\r\n                        </Box>\r\n                        <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, mt: 1 }}>\r\n                          <TimeIcon fontSize=\"small\" color=\"action\" />\r\n                          <Typography variant=\"body2\" color=\"text.secondary\">\r\n                            {formatDate(listing.createdAt)}\r\n                          </Typography>\r\n                        </Box>\r\n                      </CardContent>\r\n                      <CardActions>\r\n                        <IconButton\r\n                          onClick={(e) => handleFavoriteClick(e, listing)}\r\n                          sx={{ ml: 'auto' }}\r\n                        >\r\n                          {isFavorite(listing.id) ? (\r\n                            <FavoriteIcon color=\"error\" />\r\n                          ) : (\r\n                            <FavoriteBorderIcon />\r\n                          )}\r\n                        </IconButton>\r\n                      </CardActions>\r\n                    </Card>\r\n                  </AnimatedPage>\r\n                </Grid>\r\n              ))}\r\n            </Grid>\r\n          )}\r\n        </Container>\r\n      </Box>\r\n\r\n      <Snackbar\r\n        open={snackbarOpen}\r\n        autoHideDuration={3000}\r\n        onClose={() => setSnackbarOpen(false)}\r\n        message={snackbarMessage}\r\n      />\r\n    </AnimatedPage>\r\n  );\r\n};\r\n\r\nexport default Search; ","import React from 'react';\r\nimport {\r\n  Box,\r\n  Container,\r\n  Typography,\r\n  Grid,\r\n  Paper,\r\n} from '@mui/material';\r\nimport {\r\n  Recycling as RecyclingIcon,\r\n  Search as SearchIcon,\r\n  Chat as ChatIcon,\r\n  SwapHoriz as SwapIcon,\r\n} from '@mui/icons-material';\r\nimport Footer from '../components/Footer';\r\nimport AnimatedPage from '../components/AnimatedPage';\r\n\r\nconst HowItWorks: React.FC = () => {\r\n\r\n  const steps = [\r\n    {\r\n      icon: <SearchIcon sx={{ fontSize: 40 }} />,\r\n      title: 'Разгледайте предметите',\r\n      description: 'Търсете сред нашата колекция от използвани предмети, достъпни за размяна.',\r\n    },\r\n    {\r\n      icon: <ChatIcon sx={{ fontSize: 40 }} />,\r\n      title: 'Свържете се',\r\n      description: 'Свържете се със собственика на предмета и обсъдете възможната размяна.',\r\n    },\r\n    {\r\n      icon: <SwapIcon sx={{ fontSize: 40 }} />,\r\n      title: 'Разменете',\r\n      description: 'Срещнете се и разменете предмети с други членове на общността.',\r\n    },\r\n    {\r\n      icon: <RecyclingIcon sx={{ fontSize: 40 }} />,\r\n      title: 'Намалете отпадъците',\r\n      description: 'Помогнете за намаляване на отпадъците, като дадете на предметите втори живот чрез размяна.',\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <AnimatedPage>\r\n      <Box sx={{ py: { xs: 4, md: 8 } }}>\r\n        <Container maxWidth=\"lg\">\r\n          <Typography\r\n            variant=\"h2\"\r\n            component=\"h1\"\r\n            align=\"center\"\r\n            gutterBottom\r\n            sx={{\r\n              mb: 6,\r\n              fontWeight: 700,\r\n              fontSize: { xs: '2rem', sm: '3rem', md: '3.75rem' },\r\n            }}\r\n          >\r\n            Как работи\r\n          </Typography>\r\n\r\n          <Grid container spacing={4}>\r\n            {steps.map((step, index) => (\r\n              <Grid item xs={12} sm={6} md={3} key={index}>\r\n                <Paper\r\n                  elevation={0}\r\n                  sx={{\r\n                    p: 3,\r\n                    height: '100%',\r\n                    textAlign: 'center',\r\n                    backgroundColor: 'transparent',\r\n                    '&:hover': {\r\n                      backgroundColor: 'background.paper',\r\n                      transform: 'translateY(-4px)',\r\n                      transition: 'all 0.2s ease-in-out',\r\n                    },\r\n                  }}\r\n                >\r\n                  <Box\r\n                    sx={{\r\n                      display: 'flex',\r\n                      justifyContent: 'center',\r\n                      alignItems: 'center',\r\n                      mb: 2,\r\n                      color: 'primary.main',\r\n                    }}\r\n                  >\r\n                    {step.icon}\r\n                  </Box>\r\n                  <Typography\r\n                    variant=\"h5\"\r\n                    component=\"h2\"\r\n                    gutterBottom\r\n                    sx={{ fontWeight: 600 }}\r\n                  >\r\n                    {step.title}\r\n                  </Typography>\r\n                  <Typography color=\"text.secondary\">\r\n                    {step.description}\r\n                  </Typography>\r\n                </Paper>\r\n              </Grid>\r\n            ))}\r\n          </Grid>\r\n\r\n          <Box sx={{ mt: 8, textAlign: 'center' }}>\r\n            <Typography\r\n              variant=\"h4\"\r\n              component=\"h2\"\r\n              gutterBottom\r\n              sx={{ fontWeight: 600 }}\r\n            >\r\n              Присъединете се към нашата общност\r\n            </Typography>\r\n            <Typography\r\n              variant=\"body1\"\r\n              color=\"text.secondary\"\r\n              sx={{ maxWidth: 800, mx: 'auto', mb: 4 }}\r\n            >\r\n              Бъдете част от растящата общност от екологично съзнателни хора, които\r\n              правят разлика, като избират да разменят вместо да пазаруват. Всяка\r\n              размяна допринася за намаляване на отпадъците и насърчаване на\r\n              устойчиво потребление.\r\n            </Typography>\r\n          </Box>\r\n        </Container>\r\n      </Box>\r\n      <Footer />\r\n    </AnimatedPage>\r\n  );\r\n};\r\n\r\nexport default HowItWorks; ","const formatDistanceLocale = {\n  lessThanXSeconds: {\n    one: \"по-малко от секунда\",\n    other: \"по-малко от {{count}} секунди\",\n  },\n\n  xSeconds: {\n    one: \"1 секунда\",\n    other: \"{{count}} секунди\",\n  },\n\n  halfAMinute: \"половин минута\",\n\n  lessThanXMinutes: {\n    one: \"по-малко от минута\",\n    other: \"по-малко от {{count}} минути\",\n  },\n\n  xMinutes: {\n    one: \"1 минута\",\n    other: \"{{count}} минути\",\n  },\n\n  aboutXHours: {\n    one: \"около час\",\n    other: \"около {{count}} часа\",\n  },\n\n  xHours: {\n    one: \"1 час\",\n    other: \"{{count}} часа\",\n  },\n\n  xDays: {\n    one: \"1 ден\",\n    other: \"{{count}} дни\",\n  },\n\n  aboutXWeeks: {\n    one: \"около седмица\",\n    other: \"около {{count}} седмици\",\n  },\n\n  xWeeks: {\n    one: \"1 седмица\",\n    other: \"{{count}} седмици\",\n  },\n\n  aboutXMonths: {\n    one: \"около месец\",\n    other: \"около {{count}} месеца\",\n  },\n\n  xMonths: {\n    one: \"1 месец\",\n    other: \"{{count}} месеца\",\n  },\n\n  aboutXYears: {\n    one: \"около година\",\n    other: \"около {{count}} години\",\n  },\n\n  xYears: {\n    one: \"1 година\",\n    other: \"{{count}} години\",\n  },\n\n  overXYears: {\n    one: \"над година\",\n    other: \"над {{count}} години\",\n  },\n\n  almostXYears: {\n    one: \"почти година\",\n    other: \"почти {{count}} години\",\n  },\n};\n\nexport const formatDistance = (token, count, options) => {\n  let result;\n\n  const tokenValue = formatDistanceLocale[token];\n  if (typeof tokenValue === \"string\") {\n    result = tokenValue;\n  } else if (count === 1) {\n    result = tokenValue.one;\n  } else {\n    result = tokenValue.other.replace(\"{{count}}\", String(count));\n  }\n\n  if (options?.addSuffix) {\n    if (options.comparison && options.comparison > 0) {\n      return \"след \" + result;\n    } else {\n      return \"преди \" + result;\n    }\n  }\n\n  return result;\n};\n","import { buildFormatLongFn } from \"../../_lib/buildFormatLongFn.js\";\n\nconst dateFormats = {\n  full: \"EEEE, dd MMMM yyyy\",\n  long: \"dd MMMM yyyy\",\n  medium: \"dd MMM yyyy\",\n  short: \"dd.MM.yyyy\",\n};\n\nconst timeFormats = {\n  full: \"HH:mm:ss zzzz\",\n  long: \"HH:mm:ss z\",\n  medium: \"HH:mm:ss\",\n  short: \"H:mm\",\n};\n\nconst dateTimeFormats = {\n  any: \"{{date}} {{time}}\",\n};\n\nexport const formatLong = {\n  date: buildFormatLongFn({\n    formats: dateFormats,\n    defaultWidth: \"full\",\n  }),\n\n  time: buildFormatLongFn({\n    formats: timeFormats,\n    defaultWidth: \"full\",\n  }),\n\n  dateTime: buildFormatLongFn({\n    formats: dateTimeFormats,\n    defaultWidth: \"any\",\n  }),\n};\n","import { isSameWeek } from \"../../../isSameWeek.js\";\nimport { toDate } from \"../../../toDate.js\";\n\n// Adapted from the `ru` translation\n\nconst weekdays = [\n  \"неделя\",\n  \"понеделник\",\n  \"вторник\",\n  \"сряда\",\n  \"четвъртък\",\n  \"петък\",\n  \"събота\",\n];\n\nfunction lastWeek(day) {\n  const weekday = weekdays[day];\n\n  switch (day) {\n    case 0:\n    case 3:\n    case 6:\n      return \"'миналата \" + weekday + \" в' p\";\n    case 1:\n    case 2:\n    case 4:\n    case 5:\n      return \"'миналия \" + weekday + \" в' p\";\n  }\n}\n\nfunction thisWeek(day) {\n  const weekday = weekdays[day];\n\n  if (day === 2 /* Tue */) {\n    return \"'във \" + weekday + \" в' p\";\n  } else {\n    return \"'в \" + weekday + \" в' p\";\n  }\n}\n\nfunction nextWeek(day) {\n  const weekday = weekdays[day];\n\n  switch (day) {\n    case 0:\n    case 3:\n    case 6:\n      return \"'следващата \" + weekday + \" в' p\";\n    case 1:\n    case 2:\n    case 4:\n    case 5:\n      return \"'следващия \" + weekday + \" в' p\";\n  }\n}\n\nconst lastWeekFormatToken = (dirtyDate, baseDate, options) => {\n  const date = toDate(dirtyDate);\n  const day = date.getDay();\n  if (isSameWeek(date, baseDate, options)) {\n    return thisWeek(day);\n  } else {\n    return lastWeek(day);\n  }\n};\n\nconst nextWeekFormatToken = (dirtyDate, baseDate, options) => {\n  const date = toDate(dirtyDate);\n  const day = date.getDay();\n  if (isSameWeek(date, baseDate, options)) {\n    return thisWeek(day);\n  } else {\n    return nextWeek(day);\n  }\n};\n\nconst formatRelativeLocale = {\n  lastWeek: lastWeekFormatToken,\n  yesterday: \"'вчера в' p\",\n  today: \"'днес в' p\",\n  tomorrow: \"'утре в' p\",\n  nextWeek: nextWeekFormatToken,\n  other: \"P\",\n};\n\nexport const formatRelative = (token, date, baseDate, options) => {\n  const format = formatRelativeLocale[token];\n\n  if (typeof format === \"function\") {\n    return format(date, baseDate, options);\n  }\n\n  return format;\n};\n","import { buildLocalizeFn } from \"../../_lib/buildLocalizeFn.js\";\n\nconst eraValues = {\n  narrow: [\"пр.н.е.\", \"н.е.\"],\n  abbreviated: [\"преди н. е.\", \"н. е.\"],\n  wide: [\"преди новата ера\", \"новата ера\"],\n};\n\nconst quarterValues = {\n  narrow: [\"1\", \"2\", \"3\", \"4\"],\n  abbreviated: [\"1-во тримес.\", \"2-ро тримес.\", \"3-то тримес.\", \"4-то тримес.\"],\n\n  wide: [\n    \"1-во тримесечие\",\n    \"2-ро тримесечие\",\n    \"3-то тримесечие\",\n    \"4-то тримесечие\",\n  ],\n};\n\nconst monthValues = {\n  abbreviated: [\n    \"яну\",\n    \"фев\",\n    \"мар\",\n    \"апр\",\n    \"май\",\n    \"юни\",\n    \"юли\",\n    \"авг\",\n    \"сеп\",\n    \"окт\",\n    \"ное\",\n    \"дек\",\n  ],\n\n  wide: [\n    \"януари\",\n    \"февруари\",\n    \"март\",\n    \"април\",\n    \"май\",\n    \"юни\",\n    \"юли\",\n    \"август\",\n    \"септември\",\n    \"октомври\",\n    \"ноември\",\n    \"декември\",\n  ],\n};\n\nconst dayValues = {\n  narrow: [\"Н\", \"П\", \"В\", \"С\", \"Ч\", \"П\", \"С\"],\n  short: [\"нд\", \"пн\", \"вт\", \"ср\", \"чт\", \"пт\", \"сб\"],\n  abbreviated: [\"нед\", \"пон\", \"вто\", \"сря\", \"чет\", \"пет\", \"съб\"],\n  wide: [\n    \"неделя\",\n    \"понеделник\",\n    \"вторник\",\n    \"сряда\",\n    \"четвъртък\",\n    \"петък\",\n    \"събота\",\n  ],\n};\n\nconst dayPeriodValues = {\n  wide: {\n    am: \"преди обяд\",\n    pm: \"след обяд\",\n    midnight: \"в полунощ\",\n    noon: \"на обяд\",\n    morning: \"сутринта\",\n    afternoon: \"следобед\",\n    evening: \"вечерта\",\n    night: \"през нощта\",\n  },\n};\n\nfunction isFeminine(unit) {\n  return (\n    unit === \"year\" || unit === \"week\" || unit === \"minute\" || unit === \"second\"\n  );\n}\n\nfunction isNeuter(unit) {\n  return unit === \"quarter\";\n}\n\nfunction numberWithSuffix(number, unit, masculine, feminine, neuter) {\n  const suffix = isNeuter(unit)\n    ? neuter\n    : isFeminine(unit)\n      ? feminine\n      : masculine;\n  return number + \"-\" + suffix;\n}\n\nconst ordinalNumber = (dirtyNumber, options) => {\n  const number = Number(dirtyNumber);\n  const unit = options?.unit;\n\n  if (number === 0) {\n    return numberWithSuffix(0, unit, \"ев\", \"ева\", \"ево\");\n  } else if (number % 1000 === 0) {\n    return numberWithSuffix(number, unit, \"ен\", \"на\", \"но\");\n  } else if (number % 100 === 0) {\n    return numberWithSuffix(number, unit, \"тен\", \"тна\", \"тно\");\n  }\n\n  const rem100 = number % 100;\n  if (rem100 > 20 || rem100 < 10) {\n    switch (rem100 % 10) {\n      case 1:\n        return numberWithSuffix(number, unit, \"ви\", \"ва\", \"во\");\n      case 2:\n        return numberWithSuffix(number, unit, \"ри\", \"ра\", \"ро\");\n      case 7:\n      case 8:\n        return numberWithSuffix(number, unit, \"ми\", \"ма\", \"мо\");\n    }\n  }\n\n  return numberWithSuffix(number, unit, \"ти\", \"та\", \"то\");\n};\n\nexport const localize = {\n  ordinalNumber,\n\n  era: buildLocalizeFn({\n    values: eraValues,\n    defaultWidth: \"wide\",\n  }),\n\n  quarter: buildLocalizeFn({\n    values: quarterValues,\n    defaultWidth: \"wide\",\n    argumentCallback: (quarter) => quarter - 1,\n  }),\n\n  month: buildLocalizeFn({\n    values: monthValues,\n    defaultWidth: \"wide\",\n  }),\n\n  day: buildLocalizeFn({\n    values: dayValues,\n    defaultWidth: \"wide\",\n  }),\n\n  dayPeriod: buildLocalizeFn({\n    values: dayPeriodValues,\n    defaultWidth: \"wide\",\n  }),\n};\n","import { buildMatchFn } from \"../../_lib/buildMatchFn.js\";\nimport { buildMatchPatternFn } from \"../../_lib/buildMatchPatternFn.js\";\n\nconst matchOrdinalNumberPattern =\n  /^(\\d+)(-?[врмт][аи]|-?т?(ен|на)|-?(ев|ева))?/i;\nconst parseOrdinalNumberPattern = /\\d+/i;\n\nconst matchEraPatterns = {\n  narrow: /^((пр)?н\\.?\\s?е\\.?)/i,\n  abbreviated: /^((пр)?н\\.?\\s?е\\.?)/i,\n  wide: /^(преди новата ера|новата ера|нова ера)/i,\n};\nconst parseEraPatterns = {\n  any: [/^п/i, /^н/i],\n};\n\nconst matchQuarterPatterns = {\n  narrow: /^[1234]/i,\n  abbreviated: /^[1234](-?[врт]?o?)? тримес.?/i,\n  wide: /^[1234](-?[врт]?о?)? тримесечие/i,\n};\nconst parseQuarterPatterns = {\n  any: [/1/i, /2/i, /3/i, /4/i],\n};\n\nconst matchDayPatterns = {\n  narrow: /^[нпвсч]/i,\n  short: /^(нд|пн|вт|ср|чт|пт|сб)/i,\n  abbreviated: /^(нед|пон|вто|сря|чет|пет|съб)/i,\n  wide: /^(неделя|понеделник|вторник|сряда|четвъртък|петък|събота)/i,\n};\n\nconst parseDayPatterns = {\n  narrow: [/^н/i, /^п/i, /^в/i, /^с/i, /^ч/i, /^п/i, /^с/i],\n  any: [/^н[ед]/i, /^п[он]/i, /^вт/i, /^ср/i, /^ч[ет]/i, /^п[ет]/i, /^с[ъб]/i],\n};\n\nconst matchMonthPatterns = {\n  abbreviated: /^(яну|фев|мар|апр|май|юни|юли|авг|сеп|окт|ное|дек)/i,\n  wide: /^(януари|февруари|март|април|май|юни|юли|август|септември|октомври|ноември|декември)/i,\n};\n\nconst parseMonthPatterns = {\n  any: [\n    /^я/i,\n    /^ф/i,\n    /^мар/i,\n    /^ап/i,\n    /^май/i,\n    /^юн/i,\n    /^юл/i,\n    /^ав/i,\n    /^се/i,\n    /^окт/i,\n    /^но/i,\n    /^де/i,\n  ],\n};\n\nconst matchDayPeriodPatterns = {\n  any: /^(преди о|след о|в по|на о|през|веч|сут|следо)/i,\n};\nconst parseDayPeriodPatterns = {\n  any: {\n    am: /^преди о/i,\n    pm: /^след о/i,\n    midnight: /^в пол/i,\n    noon: /^на об/i,\n    morning: /^сут/i,\n    afternoon: /^следо/i,\n    evening: /^веч/i,\n    night: /^през н/i,\n  },\n};\n\nexport const match = {\n  ordinalNumber: buildMatchPatternFn({\n    matchPattern: matchOrdinalNumberPattern,\n    parsePattern: parseOrdinalNumberPattern,\n    valueCallback: (value) => parseInt(value, 10),\n  }),\n\n  era: buildMatchFn({\n    matchPatterns: matchEraPatterns,\n    defaultMatchWidth: \"wide\",\n    parsePatterns: parseEraPatterns,\n    defaultParseWidth: \"any\",\n  }),\n\n  quarter: buildMatchFn({\n    matchPatterns: matchQuarterPatterns,\n    defaultMatchWidth: \"wide\",\n    parsePatterns: parseQuarterPatterns,\n    defaultParseWidth: \"any\",\n    valueCallback: (index) => index + 1,\n  }),\n\n  month: buildMatchFn({\n    matchPatterns: matchMonthPatterns,\n    defaultMatchWidth: \"wide\",\n    parsePatterns: parseMonthPatterns,\n    defaultParseWidth: \"any\",\n  }),\n\n  day: buildMatchFn({\n    matchPatterns: matchDayPatterns,\n    defaultMatchWidth: \"wide\",\n    parsePatterns: parseDayPatterns,\n    defaultParseWidth: \"any\",\n  }),\n\n  dayPeriod: buildMatchFn({\n    matchPatterns: matchDayPeriodPatterns,\n    defaultMatchWidth: \"any\",\n    parsePatterns: parseDayPeriodPatterns,\n    defaultParseWidth: \"any\",\n  }),\n};\n","import { formatDistance } from \"./bg/_lib/formatDistance.js\";\nimport { formatLong } from \"./bg/_lib/formatLong.js\";\nimport { formatRelative } from \"./bg/_lib/formatRelative.js\";\nimport { localize } from \"./bg/_lib/localize.js\";\nimport { match } from \"./bg/_lib/match.js\";\n\n/**\n * @category Locales\n * @summary Bulgarian locale.\n * @language Bulgarian\n * @iso-639-2 bul\n * @author Nikolay Stoynov [@arvigeus](https://github.com/arvigeus)\n * @author Tsvetan Ovedenski [@fintara](https://github.com/fintara)\n */\nexport const bg = {\n  code: \"bg\",\n  formatDistance: formatDistance,\n  formatLong: formatLong,\n  formatRelative: formatRelative,\n  localize: localize,\n  match: match,\n  options: {\n    weekStartsOn: 1 /* Monday */,\n    firstWeekContainsDate: 1,\n  },\n};\n\n// Fallback for modularized imports:\nexport default bg;\n","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)([/*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8\"\n}, \"0\"), /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z\"\n}, \"1\")], 'AccessTime');","import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n  Box,\r\n  Container,\r\n  Typography,\r\n  Grid,\r\n  Card,\r\n  CardContent,\r\n  CardMedia,\r\n  CardActions,\r\n  Button,\r\n  IconButton,\r\n  CircularProgress,\r\n  Alert,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n} from '@mui/material';\r\nimport {\r\n  Delete as DeleteIcon,\r\n  Add as AddIcon,\r\n} from '@mui/icons-material';\r\nimport { useAuth } from '../hooks/useAuth';\r\nimport { db, storage } from '../config/firebase';\r\nimport { collection, query, where, getDocs, doc, deleteDoc } from 'firebase/firestore';\r\nimport { ref, deleteObject } from 'firebase/storage';\r\nimport AnimatedPage from '../components/AnimatedPage';\r\nimport { useTheme } from '@mui/material/styles';\r\nimport { formatDistanceToNow } from 'date-fns';\r\nimport { bg } from 'date-fns/locale';\r\nimport AccessTimeIcon from '@mui/icons-material/AccessTime';\r\n\r\nconst MyListings: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n  const [listings, setListings] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\r\n  const [listingToDelete, setListingToDelete] = useState<string | null>(null);\r\n  const [isDeleting, setIsDeleting] = useState(false);\r\n  const theme = useTheme();\r\n\r\n  useEffect(() => {\r\n    const fetchListings = async () => {\r\n      if (!user) {\r\n        navigate('/signin');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        setLoading(true);\r\n        const q = query(\r\n          collection(db, 'listings'),\r\n          where('userId', '==', user.uid),\r\n          where('status', '==', 'active')\r\n        );\r\n        const querySnapshot = await getDocs(q);\r\n        const listingsData = querySnapshot.docs.map(doc => ({\r\n          id: doc.id,\r\n          ...doc.data()\r\n        }));\r\n        setListings(listingsData);\r\n        setError(null);\r\n      } catch (err) {\r\n        console.error('Error fetching listings:', err);\r\n        setError('Грешка при зареждане на вашите обяви. Моля, опитайте отново по-късно.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchListings();\r\n  }, [user, navigate]);\r\n\r\n  const handleEdit = (listingId: string) => {\r\n    navigate(`/edit-listing/${listingId}`);\r\n  };\r\n\r\n  const handleDeleteClick = (listingId: string) => {\r\n    setListingToDelete(listingId);\r\n    setDeleteDialogOpen(true);\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    if (!listingToDelete) return;\r\n\r\n    try {\r\n      setIsDeleting(true);\r\n      // Delete the listing document\r\n      const listingRef = doc(db, 'listings', listingToDelete);\r\n      await deleteDoc(listingRef);\r\n\r\n      // Delete associated images from storage if they exist\r\n      const listing = listings.find(l => l.id === listingToDelete);\r\n      if (listing?.images && listing.images.length > 0) {\r\n        for (const imageUrl of listing.images) {\r\n          try {\r\n            // Extract the path from the URL\r\n            const imagePath = imageUrl.split('listings/')[1];\r\n            if (imagePath) {\r\n              const imageRef = ref(storage, `listings/${imagePath}`);\r\n              await deleteObject(imageRef);\r\n            }\r\n          } catch (imageError) {\r\n            console.error('Error deleting image:', imageError);\r\n          }\r\n        }\r\n      }\r\n\r\n      // Update the local state\r\n      setListings(listings.filter(l => l.id !== listingToDelete));\r\n      setError(null);\r\n    } catch (err) {\r\n      console.error('Error deleting listing:', err);\r\n      setError('Грешка при изтриване на обявата. Моля, опитайте отново.');\r\n    } finally {\r\n      setIsDeleting(false);\r\n      setDeleteDialogOpen(false);\r\n      setListingToDelete(null);\r\n    }\r\n  };\r\n\r\n  const formatDate = (date: any) => {\r\n    if (!date) return 'неизвестна дата';\r\n    \r\n    try {\r\n      let dateObj: Date;\r\n      \r\n      if (typeof date === 'string') {\r\n        dateObj = new Date(date);\r\n      } else if (typeof date === 'object' && 'seconds' in date) {\r\n        dateObj = new Date(date.seconds * 1000);\r\n      } else if (date instanceof Date) {\r\n        dateObj = date;\r\n      } else {\r\n        return 'неизвестна дата';\r\n      }\r\n\r\n      if (isNaN(dateObj.getTime())) {\r\n        return 'неизвестна дата';\r\n      }\r\n\r\n      return formatDistanceToNow(dateObj, { addSuffix: true, locale: bg });\r\n    } catch (error) {\r\n      console.error('Error formatting date:', error);\r\n      return 'неизвестна дата';\r\n    }\r\n  };\r\n\r\n  const renderHeader = () => (\r\n    <AnimatedPage animation=\"slide\" delay={0.2}>\r\n      <Box sx={{ mb: 4 }}>\r\n        <Typography variant=\"h4\" component=\"h1\" gutterBottom>\r\n          Моите обяви\r\n        </Typography>\r\n        <Button\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          startIcon={<AddIcon />}\r\n          onClick={() => navigate('/create-listing')}\r\n        >\r\n          Нова обява\r\n        </Button>\r\n      </Box>\r\n    </AnimatedPage>\r\n  );\r\n\r\n  if (loading && !isDeleting) {\r\n    return (\r\n      <AnimatedPage animation=\"fade\">\r\n        <Box sx={{ pt: 8 }}>\r\n          <Container maxWidth=\"lg\">\r\n            {renderHeader()}\r\n            <Box sx={{ display: 'flex', justifyContent: 'center', py: 8 }}>\r\n              <CircularProgress />\r\n            </Box>\r\n          </Container>\r\n        </Box>\r\n      </AnimatedPage>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <AnimatedPage animation=\"fade\">\r\n        <Box sx={{ pt: 8 }}>\r\n          <Container maxWidth=\"lg\">\r\n            {renderHeader()}\r\n            <Alert severity=\"error\" sx={{ mt: 4 }}>\r\n              {error}\r\n            </Alert>\r\n          </Container>\r\n        </Box>\r\n      </AnimatedPage>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <AnimatedPage animation=\"fade\">\r\n      <Box sx={{ pt: 8 }}>\r\n        <Container maxWidth=\"lg\">\r\n          {renderHeader()}\r\n\r\n          {listings.length === 0 ? (\r\n            <AnimatedPage animation=\"fade\" delay={0.6}>\r\n              <Alert severity=\"info\" sx={{ mt: 4 }}>\r\n                Все още нямате публикувани обяви.\r\n              </Alert>\r\n            </AnimatedPage>\r\n          ) : (\r\n            <Grid container spacing={4}>\r\n              {listings.map((listing, index) => (\r\n                <Grid item xs={12} sm={6} md={4} key={listing.id}>\r\n                  <AnimatedPage animation=\"scale\" delay={0.4 + index * 0.1}>\r\n                    <Card\r\n                      sx={{\r\n                        height: '100%',\r\n                        display: 'flex',\r\n                        flexDirection: 'column',\r\n                        cursor: 'pointer',\r\n                        transition: 'all 0.2s ease-in-out',\r\n                        '&:hover': {\r\n                          transform: 'translateY(-4px)',\r\n                          boxShadow: theme.shadows[4],\r\n                        },\r\n                      }}\r\n                      onClick={() => handleEdit(listing.id)}\r\n                    >\r\n                      <CardMedia\r\n                        component=\"img\"\r\n                        height=\"200\"\r\n                        image={listing.images?.[0] || '/placeholder-image.jpg'}\r\n                        alt={listing.title}\r\n                        sx={{ objectFit: 'cover' }}\r\n                      />\r\n                      <CardContent>\r\n                        <Typography gutterBottom variant=\"h6\" component=\"h2\">\r\n                          {listing.title}\r\n                        </Typography>\r\n                        <Typography\r\n                          variant=\"body2\"\r\n                          color=\"text.secondary\"\r\n                          sx={{\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis',\r\n                            display: '-webkit-box',\r\n                            WebkitLineClamp: 2,\r\n                            WebkitBoxOrient: 'vertical',\r\n                          }}\r\n                        >\r\n                          {listing.description}\r\n                        </Typography>\r\n                        <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, mt: 1 }}>\r\n                          <AccessTimeIcon fontSize=\"small\" color=\"action\" />\r\n                          <Typography variant=\"body2\" color=\"text.secondary\">\r\n                            {formatDate(listing.createdAt)}\r\n                          </Typography>\r\n                        </Box>\r\n                        <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, mt: 1 }}>\r\n                          <Typography variant=\"body2\" color=\"text.secondary\">\r\n                            {listing.city}, {listing.region}\r\n                          </Typography>\r\n                        </Box>\r\n                      </CardContent>\r\n                      <CardActions>\r\n                        <IconButton\r\n                          size=\"small\"\r\n                          onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            handleDeleteClick(listing.id);\r\n                          }}\r\n                          title=\"Изтрий обява\"\r\n                          color=\"error\"\r\n                        >\r\n                          <DeleteIcon fontSize=\"small\" />\r\n                        </IconButton>\r\n                      </CardActions>\r\n                    </Card>\r\n                  </AnimatedPage>\r\n                </Grid>\r\n              ))}\r\n            </Grid>\r\n          )}\r\n        </Container>\r\n      </Box>\r\n\r\n      <Dialog\r\n        open={deleteDialogOpen}\r\n        onClose={() => setDeleteDialogOpen(false)}\r\n      >\r\n        <DialogTitle>Потвърждение за изтриване</DialogTitle>\r\n        <DialogContent>\r\n          <Typography>\r\n            Сигурни ли сте, че искате да изтриете тази обява? Това действие не може да бъде отменено.\r\n          </Typography>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button \r\n            onClick={() => setDeleteDialogOpen(false)}\r\n            disabled={isDeleting}\r\n          >\r\n            Отказ\r\n          </Button>\r\n          <Button \r\n            onClick={handleDelete} \r\n            color=\"error\" \r\n            variant=\"contained\"\r\n            disabled={isDeleting}\r\n            startIcon={isDeleting ? <CircularProgress size={20} /> : null}\r\n          >\r\n            {isDeleting ? 'Изтриване...' : 'Изтрий'}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </AnimatedPage>\r\n  );\r\n};\r\n\r\nexport default MyListings; ","import React from 'react';\r\nimport {\r\n  Box,\r\n  Container,\r\n  Typography,\r\n  Grid,\r\n  Paper,\r\n  Avatar,\r\n} from '@mui/material';\r\nimport {\r\n  Recycling as RecyclingIcon,\r\n  People as PeopleIcon,\r\n  Public as PublicIcon,\r\n} from '@mui/icons-material';\r\nimport Footer from '../components/Footer';\r\nimport AnimatedPage from '../components/AnimatedPage';\r\n\r\nconst About: React.FC = () => {\r\n  const values = [\r\n    {\r\n      icon: <RecyclingIcon />,\r\n      title: 'Устойчивост',\r\n      description: 'Вярваме в намаляване на отпадъците и насърчаване на кръговата икономика чрез размяна на предмети.',\r\n    },\r\n    {\r\n      icon: <PeopleIcon />,\r\n      title: 'Общност',\r\n      description: 'Изграждане на общност от екологично съзнателни хора, които споделят общи ценности.',\r\n    },\r\n    {\r\n      icon: <PublicIcon />,\r\n      title: 'Глобален ефект',\r\n      description: 'Постигане на положителен екологичен ефект чрез удължаване на жизнения цикъл на предметите.',\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <AnimatedPage>\r\n      <Box sx={{ py: { xs: 4, md: 8 } }}>\r\n        <Container maxWidth=\"lg\">\r\n          {/* Mission Section */}\r\n          <Box sx={{ textAlign: 'center', mb: 8 }}>\r\n            <Typography\r\n              variant=\"h2\"\r\n              component=\"h1\"\r\n              sx={{\r\n                mb: 3,\r\n                fontWeight: 700,\r\n                fontSize: { xs: '2rem', sm: '3rem', md: '3.75rem' },\r\n              }}\r\n            >\r\n              За Zero-Waste Swap\r\n            </Typography>\r\n            <Typography\r\n              variant=\"h5\"\r\n              color=\"text.secondary\"\r\n              sx={{\r\n                maxWidth: 800,\r\n                mx: 'auto',\r\n                mb: 4,\r\n                fontSize: { xs: '1.1rem', sm: '1.25rem' },\r\n              }}\r\n            >\r\n              Нашата мисия е да създадем по-устойчиво бъдеще, като улесним хората да разменят предмети вместо да купуват нови.\r\n            </Typography>\r\n          </Box>\r\n\r\n          {/* Values Section */}\r\n          <Grid container spacing={4} sx={{ mb: 8 }}>\r\n            {values.map((value, index) => (\r\n              <Grid item xs={12} md={4} key={index}>\r\n                <Paper\r\n                  elevation={0}\r\n                  sx={{\r\n                    p: 4,\r\n                    height: '100%',\r\n                    textAlign: 'center',\r\n                    backgroundColor: 'transparent',\r\n                    '&:hover': {\r\n                      backgroundColor: 'background.paper',\r\n                      transform: 'translateY(-4px)',\r\n                      transition: 'all 0.2s ease-in-out',\r\n                    },\r\n                  }}\r\n                >\r\n                  <Avatar\r\n                    sx={{\r\n                      width: 64,\r\n                      height: 64,\r\n                      bgcolor: 'primary.main',\r\n                      mb: 2,\r\n                      mx: 'auto',\r\n                    }}\r\n                  >\r\n                    {value.icon}\r\n                  </Avatar>\r\n                  <Typography\r\n                    variant=\"h5\"\r\n                    component=\"h2\"\r\n                    gutterBottom\r\n                    sx={{ fontWeight: 600 }}\r\n                  >\r\n                    {value.title}\r\n                  </Typography>\r\n                  <Typography color=\"text.secondary\">\r\n                    {value.description}\r\n                  </Typography>\r\n                </Paper>\r\n              </Grid>\r\n            ))}\r\n          </Grid>\r\n\r\n          {/* Story Section */}\r\n          <Box sx={{ textAlign: 'center' }}>\r\n            <Typography\r\n              variant=\"h4\"\r\n              component=\"h2\"\r\n              gutterBottom\r\n              sx={{ fontWeight: 600 }}\r\n            >\r\n              Нашата история\r\n            </Typography>\r\n            <Typography\r\n              variant=\"body1\"\r\n              color=\"text.secondary\"\r\n              sx={{\r\n                maxWidth: 800,\r\n                mx: 'auto',\r\n                mb: 2,\r\n                fontSize: '1.1rem',\r\n                lineHeight: 1.8,\r\n              }}\r\n            >\r\n              Zero-Waste Swap започна с проста идея: какво ще стане, ако можем да намалим отпадъците,\r\n              като помогнем на хората да разменят предмети, от които вече не се нуждаят, с други, които\r\n              могат да ги използват? Тази платформа е резултат от тази визия, създавайки пространство,\r\n              където устойчивостта се среща с общността.\r\n            </Typography>\r\n            <Typography\r\n              variant=\"body1\"\r\n              color=\"text.secondary\"\r\n              sx={{\r\n                maxWidth: 800,\r\n                mx: 'auto',\r\n                fontSize: '1.1rem',\r\n                lineHeight: 1.8,\r\n              }}\r\n            >\r\n              Днес с гордост улесняваме хиляди размени, помагайки за намаляване на отпадъците\r\n              и изграждане на връзки между екологично съзнателни хора. Всяка размяна\r\n              представлява крачка към по-устойчиво бъдеще.\r\n            </Typography>\r\n          </Box>\r\n        </Container>\r\n      </Box>\r\n      <Footer />\r\n    </AnimatedPage>\r\n  );\r\n};\r\n\r\nexport default About; ","import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n  Container,\r\n  Box,\r\n  Typography,\r\n  TextField,\r\n  Button,\r\n  Paper,\r\n  CircularProgress,\r\n  Grid\r\n} from '@mui/material';\r\nimport { updateProfile } from 'firebase/auth';\r\nimport { useAuth } from '../hooks/useAuth';\r\nimport AnimatedPage from '../components/AnimatedPage';\r\n\r\nconst Settings: React.FC = () => {\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [displayName, setDisplayName] = useState(user?.displayName || '');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  if (!user) {\r\n    navigate('/login');\r\n    return null;\r\n  }\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      await updateProfile(user, {\r\n        displayName: displayName.trim()\r\n      });\r\n      setTimeout(() => {\r\n        navigate('/profile');\r\n      }, 2000);\r\n    } catch (err) {\r\n      setError('Грешка при актуализиране на профила. Моля, опитайте отново.');\r\n      console.error('Error updating profile:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <AnimatedPage animation=\"fade\">\r\n      <Box sx={{ pt: 8 }}>\r\n        <Container maxWidth=\"md\">\r\n          <AnimatedPage animation=\"slide\" delay={0.2}>\r\n            <Box sx={{ mb: 4 }}>\r\n              <Typography variant=\"h4\" component=\"h1\" gutterBottom>\r\n                Настройки\r\n              </Typography>\r\n              <Typography variant=\"body1\" color=\"text.secondary\" paragraph>\r\n                Управлявайте вашите лични данни и настройки.\r\n              </Typography>\r\n            </Box>\r\n          </AnimatedPage>\r\n\r\n          <AnimatedPage animation=\"scale\" delay={0.4}>\r\n            <Paper sx={{ p: 4 }}>\r\n              <form onSubmit={handleSubmit}>\r\n                <Grid container spacing={3}>\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Име\"\r\n                      value={displayName}\r\n                      onChange={(e) => setDisplayName(e.target.value)}\r\n                      required\r\n                      error={!!error}\r\n                      helperText={error}\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <TextField\r\n                      fullWidth\r\n                      label=\"Имейл\"\r\n                      value={user.email || ''}\r\n                      disabled\r\n                    />\r\n                  </Grid>\r\n\r\n                  <Grid item xs={12}>\r\n                    <AnimatedPage animation=\"slide\" delay={0.6}>\r\n                      <Box sx={{ display: 'flex', gap: 2, justifyContent: 'flex-end' }}>\r\n                        <Button\r\n                          variant=\"outlined\"\r\n                          onClick={() => navigate(-1)}\r\n                        >\r\n                          Отказ\r\n                        </Button>\r\n                        <Button\r\n                          type=\"submit\"\r\n                          variant=\"contained\"\r\n                          color=\"primary\"\r\n                          disabled={loading}\r\n                        >\r\n                          {loading ? <CircularProgress size={24} /> : 'Запази промените'}\r\n                        </Button>\r\n                      </Box>\r\n                    </AnimatedPage>\r\n                  </Grid>\r\n                </Grid>\r\n              </form>\r\n            </Paper>\r\n          </AnimatedPage>\r\n        </Container>\r\n      </Box>\r\n    </AnimatedPage>\r\n  );\r\n};\r\n\r\nexport default Settings; ","import { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n  Container,\r\n  Box,\r\n  Typography,\r\n  TextField,\r\n  Button,\r\n  Paper,\r\n  Alert,\r\n  Grid,\r\n  CircularProgress\r\n} from '@mui/material';\r\nimport { collection, addDoc } from 'firebase/firestore';\r\nimport { db } from '../config/firebase';\r\nimport { useAuth } from '../hooks/useAuth';\r\nimport AnimatedPage from '../components/AnimatedPage';\r\nimport Footer from '../components/Footer';\r\nconst Contact = () => {\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [formData, setFormData] = useState({\r\n    name: user?.displayName || '',\r\n    email: user?.email || '',\r\n    subject: '',\r\n    message: ''\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  const [success, setSuccess] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const validateEmail = (email: string) => {\r\n    const emailRegex = /^[^@]+@[^@]+\\.[^@]+$/;\r\n    return emailRegex.test(email);\r\n  };\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n    const { name, value } = e.target;\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [name]: value\r\n    }));\r\n    if (error) setError(null);\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setError(null);\r\n    setSuccess(false);\r\n\r\n    try {\r\n      // Validate form\r\n      if (!formData.name.trim()) {\r\n        throw new Error('Моля, въведете вашето име');\r\n      }\r\n      if (!formData.email.trim() || !validateEmail(formData.email)) {\r\n        throw new Error('Моля, въведете валиден имейл адрес');\r\n      }\r\n      if (!formData.subject.trim()) {\r\n        throw new Error('Моля, въведете тема');\r\n      }\r\n      if (!formData.message.trim()) {\r\n        throw new Error('Моля, въведете вашето съобщение');\r\n      }\r\n\r\n      const messageData = {\r\n        name: formData.name.trim(),\r\n        email: formData.email.trim(),\r\n        subject: formData.subject.trim(),\r\n        message: formData.message.trim(),\r\n        createdAt: new Date(),\r\n        status: 'new'\r\n      };\r\n\r\n      // Save to Firestore\r\n      await addDoc(collection(db, 'contact_messages'), messageData);\r\n      \r\n      setSuccess(true);\r\n      setTimeout(() => {\r\n        navigate('/');\r\n      }, 2000);  \r\n\r\n    } catch (err) {\r\n      console.error('Error sending message:', err);\r\n      setError(err instanceof Error ? err.message : 'Грешка при изпращане на съобщението. Моля, опитайте отново.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <AnimatedPage>\r\n    <Container maxWidth=\"md\">\r\n      <Box sx={{ my: 4 }}>\r\n        <Paper elevation={2} sx={{ p: 4, borderRadius: 2 }}>\r\n          <Typography variant=\"h4\" component=\"h1\" gutterBottom align=\"center\" sx={{ mb: 4 }}>\r\n            Свържете се с нас\r\n          </Typography>\r\n\r\n          {error && (\r\n            <Alert severity=\"error\" sx={{ mb: 3 }}>\r\n              {error}\r\n            </Alert>\r\n          )}\r\n\r\n          {success && (\r\n            <Alert severity=\"success\" sx={{ mb: 3 }}>\r\n              Вашето съобщение беше изпратено успешно! Пренасочване към началната страница...\r\n            </Alert>\r\n          )}\r\n\r\n          <Box component=\"form\" onSubmit={handleSubmit} noValidate>\r\n            <Grid container spacing={3}>\r\n              <Grid item xs={12} sm={6}>\r\n                <TextField\r\n                  required\r\n                  fullWidth\r\n                  label=\"Име\"\r\n                  name=\"name\"\r\n                  value={formData.name}\r\n                  onChange={handleChange}\r\n                  disabled={loading || success}\r\n                  error={Boolean(error && !formData.name.trim())}\r\n                />\r\n              </Grid>\r\n              <Grid item xs={12} sm={6}>\r\n                <TextField\r\n                  required\r\n                  fullWidth\r\n                  label=\"Имейл\"\r\n                  name=\"email\"\r\n                  type=\"email\"\r\n                  value={formData.email}\r\n                  onChange={handleChange}\r\n                  disabled={loading || success}\r\n                  error={Boolean(error && (!formData.email.trim() || !validateEmail(formData.email)))}\r\n                />\r\n              </Grid>\r\n              <Grid item xs={12}>\r\n                <TextField\r\n                  required\r\n                  fullWidth\r\n                  label=\"Тема\"\r\n                  name=\"subject\"\r\n                  value={formData.subject}\r\n                  onChange={handleChange}\r\n                  disabled={loading || success}\r\n                  error={Boolean(error && !formData.subject.trim())}\r\n                />\r\n              </Grid>\r\n              <Grid item xs={12}>\r\n                <TextField\r\n                  required\r\n                  fullWidth\r\n                  label=\"Съобщение\"\r\n                  name=\"message\"\r\n                  multiline\r\n                  rows={4}\r\n                  value={formData.message}\r\n                  onChange={handleChange}\r\n                  disabled={loading || success}\r\n                  error={Boolean(error && !formData.message.trim())}\r\n                />\r\n              </Grid>\r\n              <Grid item xs={12}>\r\n                <Button\r\n                  type=\"submit\"\r\n                  variant=\"contained\"\r\n                  color=\"primary\"\r\n                  fullWidth\r\n                  size=\"large\"\r\n                  disabled={loading || success}\r\n                  sx={{ mt: 2 }}\r\n                >\r\n                  {loading ? <CircularProgress size={24} /> : 'Изпрати съобщение'}\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n          </Box>\r\n        </Paper>\r\n      </Box>\r\n    </Container>\r\n    <Footer />\r\n    </AnimatedPage>\r\n  );\r\n};\r\n\r\nexport default Contact; ","import { \r\n  vegetablesImage, \r\n  shoppingBagsImage, \r\n  bambooImage, \r\n  shoesImage, \r\n  coffeeMakerImage, \r\n  jacketImage, \r\n  boardGamesImage, \r\n  yogaMatImage, \r\n  blenderImage, \r\n  childrenBooksImage, \r\n  gardenToolsImage, \r\n  laptopStandImage, \r\n  bicycleImage, \r\n  artSuppliesImage, \r\n  deskLampImage, \r\n  laptopImage \r\n} from '../assets/placeholders';\r\n\r\nexport const featuredListings = [\r\n  {\r\n    id: 1,\r\n    title: 'Биологични зеленчуци',\r\n    description: 'Свежи биологични зеленчуци от нашата градина, включително домати, краставици и листни зеленчуци',\r\n    image: vegetablesImage,\r\n    location: 'София, България',\r\n    category: 'Храни',\r\n  },\r\n  {\r\n    id: 2,\r\n    title: 'Повторно използваеми чанти',\r\n    description: 'Комплект от 5 екологични чанти за пазаруване, направени от рециклирани материали, издръжливи и перащи се',\r\n    image: shoppingBagsImage,\r\n    location: 'Пловдив, България',\r\n    category: 'Аксесоари',\r\n  },\r\n  {\r\n    id: 3,\r\n    title: 'Комплект бамбукови прибори',\r\n    description: 'Пълен комплект бамбукови кухненски прибори, включващ лъжици, лопатки и сервиращи инструменти',\r\n    image: bambooImage,\r\n    location: 'Варна, България',\r\n    category: 'Кухня',\r\n  },\r\n  {\r\n    id: 4,\r\n    title: 'Бягащи обувки',\r\n    description: 'Nike бягащи обувки, размер EU 42, леко използвани, идеални за начинаещи',\r\n    image: shoesImage,\r\n    location: 'Бургас, България',\r\n    category: 'Дрехи',\r\n  },\r\n  {\r\n    id: 5,\r\n    title: 'Кафе машина',\r\n    description: 'Philips кафе машина, капацитет 1.5L, използвана 6 месеца, работи перфектно',\r\n    image: coffeeMakerImage,\r\n    location: 'Русе, България',\r\n    category: 'Уреди',\r\n  },\r\n  {\r\n    id: 6,\r\n    title: 'Зимна якa',\r\n    description: 'Дамска зимна якa, размер M, водоустойчива, отлично състояние',\r\n    image: jacketImage,\r\n    location: 'София, България',\r\n    category: 'Дрехи',\r\n  },\r\n  {\r\n    id: 7,\r\n    title: 'Колекция настолни игри',\r\n    description: 'Колекция от популярни настолни игри, включваща Монополи, Скрабъл и Шах',\r\n    image: boardGamesImage,\r\n    location: 'Пловдив, България',\r\n    category: 'Забавление',\r\n  },\r\n  {\r\n    id: 8,\r\n    title: 'Йога килим',\r\n    description: 'Екологичен йога килим, направен от натурален каучук, дебелина 4mm, почти неизползван',\r\n    image: yogaMatImage,\r\n    location: 'Варна, България',\r\n    category: 'Спорт',\r\n  },\r\n  {\r\n    id: 9,\r\n    title: 'Блендер',\r\n    description: 'Високоскоростен блендер, идеален за смутита и супи, мощност 800W',\r\n    image: blenderImage,\r\n    location: 'Бургас, България',\r\n    category: 'Уреди',\r\n  },\r\n  {\r\n    id: 10,\r\n    title: 'Детски книги',\r\n    description: 'Колекция от 15 детски книги в отлично състояние, подходящи за възраст 5-8 години',\r\n    image: childrenBooksImage,\r\n    location: 'София, България',\r\n    category: 'Книги',\r\n  },\r\n  {\r\n    id: 11,\r\n    title: 'Комплект градински инструменти',\r\n    description: 'Пълен комплект градински инструменти, включващ лопата, гребло и ножици за подрязване',\r\n    image: gardenToolsImage,\r\n    location: 'Стара Загора, България',\r\n    category: 'Инструменти',\r\n  },\r\n  {\r\n    id: 12,\r\n    title: 'Станд за лаптоп',\r\n    description: 'Регулируем алуминиев стенд за лаптоп, ергономичен дизайн, сгъваем',\r\n    image: laptopStandImage,\r\n    location: 'Велико Търново, България',\r\n    category: 'Електроника',\r\n  },\r\n  {\r\n    id: 13,\r\n    title: 'Велосипед',\r\n    description: 'Планински велосипед в добро състояние, 26\" колела, наскоро обслужен',\r\n    image: bicycleImage,\r\n    location: 'София, България',\r\n    category: 'Спорт',\r\n  },\r\n  {\r\n    id: 14,\r\n    title: 'Художествени материали',\r\n    description: 'Комплект акрилни бои, четки и платна, идеални за начинаещи',\r\n    image: artSuppliesImage,\r\n    location: 'Пловдив, България',\r\n    category: 'Хобита',\r\n  },\r\n  {\r\n    id: 15,\r\n    title: 'Настолна лампа',\r\n    description: 'LED настолна лампа с регулируема яркост и цветна температура',\r\n    image: deskLampImage,\r\n    location: 'Варна, България',\r\n    category: 'Електроника',\r\n  },\r\n  {\r\n    id: 16,\r\n    title: 'Лаптоп',\r\n    description: 'Apple MacBook Pro 16\" M3 Pro 512GB Space Black',\r\n    image: laptopImage,\r\n    location: 'Сливен, България',\r\n    category: 'Електроника',\r\n  }\r\n]; ","import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n  Container,\r\n  Typography,\r\n  Grid,\r\n  Card,\r\n  CardContent,\r\n  CardMedia,\r\n  Box,\r\n  IconButton,\r\n  CircularProgress,\r\n  Alert,\r\n  Chip,\r\n  useTheme,\r\n} from '@mui/material';\r\nimport {\r\n  Favorite as FavoriteIcon,\r\n  LocationOn as LocationIcon,\r\n  AccessTime as TimeIcon,\r\n} from '@mui/icons-material';\r\nimport { doc, getDoc, deleteDoc } from 'firebase/firestore';\r\nimport { db } from '../config/firebase';\r\nimport { useFavorites } from '../hooks/useFavorites';\r\nimport { formatDistanceToNow } from 'date-fns';\r\nimport { useAuth } from '../hooks/useAuth';\r\n\r\n// Import the demo listings data\r\nimport { featuredListings } from '../data/featuredListings';\r\n\r\ninterface Listing {\r\n  id: string;\r\n  title: string;\r\n  description: string;\r\n  category: string;\r\n  condition: string;\r\n  images: string[];\r\n  userEmail: string;\r\n  userName: string;\r\n  createdAt: any;\r\n  location: {\r\n    latitude: number;\r\n    longitude: number;\r\n    address: string;\r\n  };\r\n}\r\n\r\nconst Favorites = () => {\r\n  const navigate = useNavigate();\r\n  const theme = useTheme();\r\n  const { user } = useAuth();\r\n  const { favorites, toggleFavorite } = useFavorites();\r\n  const [favoriteListings, setFavoriteListings] = useState<Listing[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const fetchFavoriteListings = async () => {\r\n      if (!user || favorites.length === 0) {\r\n        console.log('No user or no favorites:', { user: !!user, favoritesLength: favorites.length });\r\n        setFavoriteListings([]);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        console.log('Fetching favorites:', favorites);\r\n        const validFavorites = favorites.map(id => String(id)).filter(id => id.length > 0);\r\n        console.log('Valid favorites:', validFavorites);\r\n        \r\n        if (validFavorites.length === 0) {\r\n          setFavoriteListings([]);\r\n          setLoading(false);\r\n          return;\r\n        }\r\n\r\n        const listingPromises = validFavorites.map(async (listingId) => {\r\n          try {\r\n            // Check if it's a demo listing\r\n            if (listingId.startsWith('demo_')) {\r\n              const demoId = parseInt(listingId.replace('demo_', ''));\r\n              const demoListing = featuredListings.find(l => l.id === demoId);\r\n              \r\n              if (demoListing) {\r\n                // Create a new object without the original id to avoid duplication\r\n                const { id: _, ...demoListingWithoutId } = demoListing;\r\n                return {\r\n                  id: listingId, // Use the demo_ prefixed ID\r\n                  ...demoListingWithoutId,\r\n                  images: [demoListing.image],\r\n                  location: {\r\n                    address: demoListing.location,\r\n                    latitude: 0,\r\n                    longitude: 0\r\n                  },\r\n                  userId: 'demo',\r\n                  userName: 'Demo User',\r\n                  userEmail: 'demo@example.com',\r\n                  createdAt: new Date(),\r\n                  updatedAt: new Date(),\r\n                  condition: 'good',\r\n                  status: 'active' as const\r\n                };\r\n              }\r\n              return null;\r\n            }\r\n            \r\n            // Handle regular listings\r\n            console.log('Fetching listing:', listingId);\r\n            const docRef = doc(db, 'listings', listingId);\r\n            const docSnap = await getDoc(docRef);\r\n            \r\n            if (docSnap.exists()) {\r\n              const data = docSnap.data();\r\n              console.log('Found listing:', { id: docSnap.id, ...data });\r\n              return {\r\n                id: docSnap.id,\r\n                ...data,\r\n                createdAt: data.createdAt?.toDate() || new Date(),\r\n              };\r\n            }\r\n            \r\n            console.log(`Listing ${listingId} not found, removing from favorites`);\r\n            // Clean up the invalid favorite\r\n            const favoriteId = `${user.uid}_${listingId}`;\r\n            const favoriteRef = doc(db, 'favorites', favoriteId);\r\n            await deleteDoc(favoriteRef);\r\n            return null;\r\n          } catch (err) {\r\n            console.error(`Error fetching listing ${listingId}:`, err);\r\n            return null;\r\n          }\r\n        });\r\n\r\n        const listingDocs = await Promise.all(listingPromises);\r\n        const listings = listingDocs\r\n          .filter((doc): doc is Listing => doc !== null)\r\n          .sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime());\r\n\r\n        console.log('Final listings:', listings);\r\n        setFavoriteListings(listings);\r\n      } catch (err) {\r\n        console.error('Error fetching favorite listings:', err);\r\n        setError('Грешка при зареждане на любими обяви');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchFavoriteListings();\r\n  }, [user, favorites]);\r\n\r\n  const handleListingClick = (listing: Listing) => {\r\n    navigate(`/listing/${listing.id}`, { state: { listing } });\r\n  };\r\n\r\n  const handleRemoveFavorite = async (e: React.MouseEvent, listingId: string) => {\r\n    e.stopPropagation();\r\n    await toggleFavorite(listingId);\r\n  };\r\n\r\n  const formatDate = (date: any) => {\r\n    if (!date) return 'неизвестна дата';\r\n    \r\n    try {\r\n      if (typeof date === 'string') {\r\n        return formatDistanceToNow(new Date(date), { addSuffix: true });\r\n      } else if (typeof date === 'object' && 'seconds' in date) {\r\n        return formatDistanceToNow(new Date(date.seconds * 1000), { addSuffix: true });\r\n      }\r\n      return 'неизвестна дата';\r\n    } catch (error) {\r\n      console.error('Error formatting date:', error);\r\n      return 'неизвестна дата';\r\n    }\r\n  };\r\n\r\n  if (!user) {\r\n    return (\r\n      <Container maxWidth=\"lg\" sx={{ py: 4 }}>\r\n        <Alert severity=\"info\">\r\n          Моля, влезте в системата, за да видите вашите любими обяви.\r\n        </Alert>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <Box sx={{ display: 'flex', justifyContent: 'center', py: 4 }}>\r\n        <CircularProgress />\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container maxWidth=\"lg\" sx={{ py: 4 }}>\r\n      <Typography variant=\"h4\" component=\"h1\" gutterBottom>\r\n        Моите любими\r\n      </Typography>\r\n\r\n      {error && (\r\n        <Alert severity=\"error\" sx={{ mb: 3 }}>\r\n          {error}\r\n        </Alert>\r\n      )}\r\n\r\n      {favoriteListings.length === 0 ? (\r\n        <Alert severity=\"info\">\r\n          Все още нямате добавени обяви в любими.\r\n        </Alert>\r\n      ) : (\r\n        <Grid container spacing={3}>\r\n          {favoriteListings.map((listing) => (\r\n            <Grid item xs={12} sm={6} md={4} key={listing.id}>\r\n              <Card\r\n                sx={{\r\n                  height: '100%',\r\n                  display: 'flex',\r\n                  flexDirection: 'column',\r\n                  cursor: 'pointer',\r\n                  transition: 'all 0.2s ease-in-out',\r\n                  '&:hover': {\r\n                    transform: 'translateY(-4px)',\r\n                    boxShadow: theme.shadows[4]\r\n                  }\r\n                }}\r\n                onClick={() => handleListingClick(listing)}\r\n              >\r\n                <Box sx={{ position: 'relative' }}>\r\n                  <CardMedia\r\n                    component=\"img\"\r\n                    height=\"200\"\r\n                    image={listing.images?.[0] || '/placeholder-image.jpg'}\r\n                    alt={listing.title}\r\n                    sx={{ objectFit: 'cover' }}\r\n                  />\r\n                  <IconButton\r\n                    sx={{\r\n                      position: 'absolute',\r\n                      top: 8,\r\n                      right: 8,\r\n                      backgroundColor: 'rgba(255, 255, 255, 0.8)',\r\n                      '&:hover': {\r\n                        backgroundColor: 'rgba(255, 255, 255, 0.9)'\r\n                      }\r\n                    }}\r\n                    onClick={(e) => handleRemoveFavorite(e, listing.id)}\r\n                  >\r\n                    <FavoriteIcon color=\"error\" />\r\n                  </IconButton>\r\n                </Box>\r\n                <CardContent sx={{ flexGrow: 1 }}>\r\n                  <Typography gutterBottom variant=\"h6\" component=\"h2\">\r\n                    {listing.title}\r\n                  </Typography>\r\n                  <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 2 }}>\r\n                    {listing.description}\r\n                  </Typography>\r\n                  <Box sx={{ display: 'flex', gap: 1, flexWrap: 'wrap', mb: 2 }}>\r\n                    <Chip\r\n                      icon={<LocationIcon />}\r\n                      label={listing.location?.address || 'Местоположението не е посочено'}\r\n                      size=\"small\"\r\n                    />\r\n                    <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, mt: 1 }}>\r\n                      <TimeIcon fontSize=\"small\" color=\"action\" />\r\n                      <Typography variant=\"body2\" color=\"text.secondary\">\r\n                        {formatDate(listing.createdAt)}\r\n                      </Typography>\r\n                    </Box>\r\n                  </Box>\r\n                </CardContent>\r\n              </Card>\r\n            </Grid>\r\n          ))}\r\n        </Grid>\r\n      )}\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Favorites; ","import React from 'react';\r\nimport { Container, Typography, Box, Paper } from '@mui/material';\r\n\r\nconst Privacy: React.FC = () => {\r\n  return (\r\n    <Container maxWidth=\"md\">\r\n      <Box sx={{ my: 4 }}>\r\n        <Paper elevation={0} sx={{ p: 4 }}>\r\n          <Typography variant=\"h4\" component=\"h1\" gutterBottom>\r\n            Политика за поверителност\r\n          </Typography>\r\n          \r\n          <Typography variant=\"body1\" paragraph>\r\n            Последна актуализация: {new Date().toLocaleDateString('bg-BG')}\r\n          </Typography>\r\n\r\n          <Typography variant=\"h6\" gutterBottom sx={{ mt: 3 }}>\r\n            1. Информация, която събираме\r\n          </Typography>\r\n          <Typography variant=\"body1\" paragraph>\r\n            Събираме информация, която вие предоставяте директно на нас, включително име, имейл адрес и всяка друга информация, която изберете да предоставите при използване на нашата платформа Zero-Waste Swap.\r\n          </Typography>\r\n\r\n          <Typography variant=\"h6\" gutterBottom sx={{ mt: 3 }}>\r\n            2. Как използваме вашата информация\r\n          </Typography>\r\n          <Typography variant=\"body1\" paragraph>\r\n            Използваме събраната информация, за да:\r\n            • Предоставяме и поддържаме нашите услуги\r\n            • Обработваме вашите транзакции\r\n            • Изпращаме ви технически известия и съобщения за поддръжка\r\n            • Комуникираме с вас за продукти, услуги и събития\r\n          </Typography>\r\n\r\n          <Typography variant=\"h6\" gutterBottom sx={{ mt: 3 }}>\r\n            3. Споделяне на информация\r\n          </Typography>\r\n          <Typography variant=\"body1\" paragraph>\r\n            Ние не продаваме или споделяме вашата лична информация с трети страни, освен когато е необходимо за предоставяне на нашите услуги или когато се изисква по закон.\r\n          </Typography>\r\n\r\n          <Typography variant=\"h6\" gutterBottom sx={{ mt: 3 }}>\r\n            4. Сигурност на данните\r\n          </Typography>\r\n          <Typography variant=\"body1\" paragraph>\r\n            Прилагаме подходящи мерки за сигурност, за да защитим вашата лична информация от неоторизиран достъп, промяна или унищожаване.\r\n          </Typography>\r\n\r\n          <Typography variant=\"h6\" gutterBottom sx={{ mt: 3 }}>\r\n            5. Вашите права\r\n          </Typography>\r\n          <Typography variant=\"body1\" paragraph>\r\n            Имате право да достъпвате, актуализирате или изтривате вашата лична информация. Можете да упражните тези права, като се свържете с нас чрез нашата платформа.\r\n          </Typography>\r\n\r\n          <Typography variant=\"h6\" gutterBottom sx={{ mt: 3 }}>\r\n            6. Промени в тази политика\r\n          </Typography>\r\n          <Typography variant=\"body1\" paragraph>\r\n            Може да актуализираме тази политика за поверителност от време на време. Ще ви уведомим за всички промени, като публикуваме новата политика на тази страница.\r\n          </Typography>\r\n\r\n          <Typography variant=\"h6\" gutterBottom sx={{ mt: 3 }}>\r\n            7. Свържете се с нас\r\n          </Typography>\r\n          <Typography variant=\"body1\" paragraph>\r\n            Ако имате въпроси относно тази Политика за поверителност, моля, свържете се с нас чрез контактната форма на нашата платформа.\r\n          </Typography>\r\n        </Paper>\r\n      </Box>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Privacy; ","import React from 'react';\r\nimport { Container, Typography, Box, Paper } from '@mui/material';\r\n\r\nconst Terms: React.FC = () => {\r\n  return (\r\n    <Container maxWidth=\"md\">\r\n      <Box sx={{ my: 4 }}>\r\n        <Paper elevation={0} sx={{ p: 4 }}>\r\n          <Typography variant=\"h4\" component=\"h1\" gutterBottom>\r\n            Общи условия за ползване\r\n          </Typography>\r\n          \r\n          <Typography variant=\"body1\" paragraph>\r\n            Последна актуализация: {new Date().toLocaleDateString('bg-BG')}\r\n          </Typography>\r\n\r\n          <Typography variant=\"h6\" gutterBottom sx={{ mt: 3 }}>\r\n            1. Приемане на условията\r\n          </Typography>\r\n          <Typography variant=\"body1\" paragraph>\r\n            Чрез достъп и използване на платформата Zero-Waste Swap, вие се съгласявате да се придържате към тези Общи условия за ползване и всички приложими закони и разпоредби.\r\n          </Typography>\r\n\r\n          <Typography variant=\"h6\" gutterBottom sx={{ mt: 3 }}>\r\n            2. Потребителски акаунти\r\n          </Typography>\r\n          <Typography variant=\"body1\" paragraph>\r\n            Трябва да създадете акаунт, за да използвате определени функции на нашата платформа. Вие сте отговорни за поддържането на поверителността на информацията за вашия акаунт и за всички действия, извършени под вашия акаунт.\r\n          </Typography>\r\n\r\n          <Typography variant=\"h6\" gutterBottom sx={{ mt: 3 }}>\r\n            3. Насоки за публикуване на обяви\r\n          </Typography>\r\n          <Typography variant=\"body1\" paragraph>\r\n            При създаване на обяви, вие се съгласявате да:\r\n            • Предоставяте точна и пълна информация\r\n            • Публикувате само предмети, които имате право да разменяте или давате\r\n            • Не публикувате забранени предмети\r\n            • Поддържате и актуализирате вашите обяви\r\n          </Typography>\r\n\r\n          <Typography variant=\"h6\" gutterBottom sx={{ mt: 3 }}>\r\n            4. Потребителско поведение\r\n          </Typography>\r\n          <Typography variant=\"body1\" paragraph>\r\n            Вие се съгласявате да не:\r\n            • Нарушавате закони или разпоредби\r\n            • Нарушавате интелектуалните права на другите\r\n            • Притеснявате или навреждате на други потребители\r\n            • Публикувате невярна или подвеждаща информация\r\n          </Typography>\r\n\r\n          <Typography variant=\"h6\" gutterBottom sx={{ mt: 3 }}>\r\n            5. Правила на платформата\r\n          </Typography>\r\n          <Typography variant=\"body1\" paragraph>\r\n            Ние си запазваме правото да:\r\n            • Премахваме всяко съдържание, което нарушава тези условия\r\n            • Спираме или прекратяваме акаунти\r\n            • Променяме или прекратяваме услугите\r\n            • Актуализираме тези условия по всяко време\r\n          </Typography>\r\n\r\n          <Typography variant=\"h6\" gutterBottom sx={{ mt: 3 }}>\r\n            6. Отговорност\r\n          </Typography>\r\n          <Typography variant=\"body1\" paragraph>\r\n            Платформата се предоставя \"както е\" без никакви гаранции. Ние не носим отговорност за поведението на потребителите или качеството на предметите, разменяни чрез нашата платформа.\r\n          </Typography>\r\n\r\n          <Typography variant=\"h6\" gutterBottom sx={{ mt: 3 }}>\r\n            7. Контакт\r\n          </Typography>\r\n          <Typography variant=\"body1\" paragraph>\r\n            За въпроси относно тези Общи условия за ползване, моля, свържете се с нас чрез контактната форма на нашата платформа.\r\n          </Typography>\r\n        </Paper>\r\n      </Box>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Terms; ","import { useState } from 'react';\r\nimport { Link as RouterLink } from 'react-router-dom';\r\nimport {\r\n  Container,\r\n  Box,\r\n  Typography,\r\n  TextField,\r\n  Button,\r\n  Link,\r\n  Paper,\r\n  InputAdornment,\r\n  Alert,\r\n  CircularProgress,\r\n} from '@mui/material';\r\nimport { Email as EmailIcon } from '@mui/icons-material';\r\nimport { useAuth } from '../hooks/useAuth';\r\n\r\nconst ForgotPassword = () => {\r\n  const [email, setEmail] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [success, setSuccess] = useState(false);\r\n  const { resetPassword } = useAuth();\r\n\r\n  const validateEmail = (email: string) => {\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    return emailRegex.test(email);\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n    setSuccess(false);\r\n\r\n    if (!validateEmail(email)) {\r\n      setError('Моля, въведете валиден имейл адрес');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      await resetPassword(email);\r\n      setSuccess(true);\r\n    } catch (err) {\r\n      setError('Грешка при изпращане на имейл за възстановяване на паролата. Моля, опитайте отново.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Container maxWidth=\"sm\">\r\n      <Box\r\n        sx={{\r\n          marginTop: 8,\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n          alignItems: 'center',\r\n        }}\r\n      >\r\n        <Paper\r\n          elevation={3}\r\n          sx={{\r\n            padding: 4,\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            alignItems: 'center',\r\n            width: '100%',\r\n          }}\r\n        >\r\n          <Typography component=\"h1\" variant=\"h5\">\r\n            Забравена парола\r\n          </Typography>\r\n          <Typography variant=\"body2\" color=\"text.secondary\" align=\"center\" sx={{ mt: 2 }}>\r\n            Въведете имейл адреса си и ние ще ви изпратим линк за възстановяване на паролата.\r\n          </Typography>\r\n\r\n          {error && (\r\n            <Alert severity=\"error\" sx={{ mt: 2, width: '100%' }}>\r\n              {error}\r\n            </Alert>\r\n          )}\r\n\r\n          {success && (\r\n            <Alert severity=\"success\" sx={{ mt: 2, width: '100%' }}>\r\n              Имейл за възстановяване на паролата беше изпратен. Моля, проверете вашата поща.\r\n            </Alert>\r\n          )}\r\n\r\n          <Box component=\"form\" onSubmit={handleSubmit} sx={{ mt: 3, width: '100%' }}>\r\n            <TextField\r\n              margin=\"normal\"\r\n              required\r\n              fullWidth\r\n              id=\"email\"\r\n              label=\"Имейл адрес\"\r\n              name=\"email\"\r\n              autoComplete=\"email\"\r\n              autoFocus\r\n              value={email}\r\n              onChange={(e) => setEmail(e.target.value)}\r\n              error={!!error && !validateEmail(email)}\r\n              helperText={!!error && !validateEmail(email) ? 'Моля, въведете валиден имейл адрес' : ''}\r\n              InputProps={{\r\n                startAdornment: (\r\n                  <InputAdornment position=\"start\">\r\n                    <EmailIcon />\r\n                  </InputAdornment>\r\n                ),\r\n              }}\r\n            />\r\n            <Button\r\n              type=\"submit\"\r\n              fullWidth\r\n              variant=\"contained\"\r\n              sx={{ mt: 3, mb: 2 }}\r\n              disabled={loading}\r\n            >\r\n              {loading ? <CircularProgress size={24} /> : 'Изпрати линк за възстановяване'}\r\n            </Button>\r\n            <Box sx={{ textAlign: 'center' }}>\r\n              <Link component={RouterLink} to=\"/login\" variant=\"body2\">\r\n                Назад към входа\r\n              </Link>\r\n            </Box>\r\n          </Box>\r\n        </Paper>\r\n      </Box>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default ForgotPassword; ","import { Box, Button, Container, Typography } from '@mui/material';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { ArrowBack } from '@mui/icons-material';\r\n\r\nconst NotFound = () => {\r\n  const navigate = useNavigate();\r\n\r\n  return (\r\n    <Container maxWidth=\"md\">\r\n      <Box\r\n        sx={{\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          minHeight: '80vh',\r\n          textAlign: 'center',\r\n        }}\r\n      >\r\n        <Typography variant=\"h1\" component=\"h1\" gutterBottom>\r\n          404\r\n        </Typography>\r\n        <Typography variant=\"h4\" component=\"h2\" gutterBottom>\r\n          Страницата не е намерена\r\n        </Typography>\r\n        <Typography variant=\"body1\" color=\"text.secondary\" paragraph>\r\n          Съжаляваме, но страницата, която търсите, не съществува или е била преместена.\r\n        </Typography>\r\n        <Button\r\n          variant=\"contained\"\r\n          startIcon={<ArrowBack />}\r\n          onClick={() => navigate('/')}\r\n          sx={{ mt: 2 }}\r\n        >\r\n          Обратно към началната страница\r\n        </Button>\r\n      </Box>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default NotFound; ","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m0 14H6l-2 2V4h16z\"\n}), 'ChatBubbleOutline');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4\"\n}), 'PersonAdd');","import React from 'react';\r\nimport {\r\n  ListItem,\r\n  ListItemAvatar,\r\n  Avatar,\r\n  ListItemText,\r\n  Typography,\r\n  useTheme,\r\n  Badge,\r\n} from '@mui/material';\r\nimport { format, isToday, isYesterday, isValid } from 'date-fns';\r\n\r\ninterface ChatListItemProps {\r\n  chat: {\r\n    _id: string;\r\n    participants: Array<{\r\n      uid: string;\r\n      username?: string;\r\n      email?: string;\r\n      displayName?: string;\r\n      photoURL?: string;\r\n      online?: boolean;\r\n    }>;\r\n    lastMessage?: {\r\n      text: string;\r\n      createdAt: string;\r\n    };\r\n    updatedAt: string;\r\n  };\r\n  currentUserId: string;\r\n  selected: boolean;\r\n  onClick: () => void;\r\n  unreadCount?: number;\r\n}\r\n\r\nconst ChatListItem: React.FC<ChatListItemProps> = ({\r\n  chat,\r\n  currentUserId,\r\n  selected,\r\n  onClick,\r\n  unreadCount = 0,\r\n}) => {\r\n  const theme = useTheme();\r\n  \r\n  // Debug log for all participants\r\n  console.log('ChatListItem participants:', {\r\n    chatId: chat._id,\r\n    allParticipants: chat.participants.map(p => ({\r\n      uid: p.uid,\r\n      username: p.username,\r\n      email: p.email,\r\n      displayName: p.displayName\r\n    })),\r\n    currentUserId\r\n  });\r\n\r\n  const otherParticipant = chat.participants.find(p => p.uid !== currentUserId);\r\n\r\n  // Debug log for other participant\r\n  console.log('ChatListItem otherParticipant:', {\r\n    chatId: chat._id,\r\n    currentUserId,\r\n    otherParticipant: otherParticipant ? {\r\n      uid: otherParticipant.uid,\r\n      username: otherParticipant.username,\r\n      email: otherParticipant.email,\r\n      displayName: otherParticipant.displayName\r\n    } : null\r\n  });\r\n\r\n  // Get display name from available fields\r\n  const getDisplayName = () => {\r\n    if (!otherParticipant) return 'Unknown User';\r\n    if (otherParticipant.username) return otherParticipant.username;\r\n    if (otherParticipant.displayName) return otherParticipant.displayName;\r\n    if (otherParticipant.email) return otherParticipant.email.split('@')[0];\r\n    return 'Unknown User';\r\n  };\r\n\r\n  // Get avatar text from name\r\n  const getAvatarText = () => {\r\n    const name = getDisplayName();\r\n    return name\r\n      .split(' ')\r\n      .map(part => part[0])\r\n      .join('')\r\n      .toUpperCase()\r\n      .slice(0, 2);\r\n  };\r\n\r\n  // Format the date\r\n  const formatDate = (dateString: string) => {\r\n    const date = new Date(dateString);\r\n    if (!isValid(date)) return '';\r\n\r\n    if (isToday(date)) {\r\n      return format(date, 'HH:mm');\r\n    } else if (isYesterday(date)) {\r\n      return 'Yesterday';\r\n    } else {\r\n      return format(date, 'MMM d');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ListItem\r\n      button\r\n      selected={selected}\r\n      onClick={onClick}\r\n      sx={{\r\n        borderRadius: 2,\r\n        mb: 0.5,\r\n        transition: 'all 0.2s ease',\r\n        '&.Mui-selected': {\r\n          backgroundColor: `${theme.palette.primary.main}15`,\r\n          '&:hover': {\r\n            backgroundColor: `${theme.palette.primary.main}25`,\r\n          },\r\n        },\r\n        '&:hover': {\r\n          backgroundColor: theme.palette.action.hover,\r\n        },\r\n      }}\r\n    >\r\n      <ListItemAvatar>\r\n        <Badge\r\n          overlap=\"circular\"\r\n          anchorOrigin={{ vertical: 'bottom', horizontal: 'right' }}\r\n          variant=\"dot\"\r\n          color=\"success\"\r\n          invisible={!otherParticipant?.online}\r\n        >\r\n          <Avatar\r\n            src={otherParticipant?.photoURL}\r\n            sx={{\r\n              width: 48,\r\n              height: 48,\r\n              bgcolor: theme.palette.primary.main,\r\n              fontSize: '1.2rem',\r\n              fontWeight: 500,\r\n            }}\r\n          >\r\n            {getAvatarText()}\r\n          </Avatar>\r\n        </Badge>\r\n      </ListItemAvatar>\r\n      <ListItemText\r\n        primaryTypographyProps={{\r\n          component: 'div',\r\n          sx: {\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center'\r\n          }\r\n        }}\r\n        primary={\r\n          <>\r\n            <Typography variant=\"subtitle1\" fontWeight={500}>\r\n              {getDisplayName()}\r\n            </Typography>\r\n            <Typography variant=\"caption\" color=\"text.secondary\">\r\n              {formatDate(chat.updatedAt)}\r\n            </Typography>\r\n          </>\r\n        }\r\n        secondaryTypographyProps={{\r\n          component: 'div',\r\n          sx: {\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            mt: 0.5\r\n          }\r\n        }}\r\n        secondary={\r\n          <>\r\n            <Typography\r\n              variant=\"body2\"\r\n              color={unreadCount > 0 ? 'text.primary' : 'text.secondary'}\r\n              sx={{\r\n                overflow: 'hidden',\r\n                textOverflow: 'ellipsis',\r\n                whiteSpace: 'nowrap',\r\n                maxWidth: '70%',\r\n                fontWeight: unreadCount > 0 ? 500 : 400,\r\n              }}\r\n            >\r\n              {chat.lastMessage?.text || 'No messages yet'}\r\n            </Typography>\r\n            {unreadCount > 0 && (\r\n              <Badge\r\n                badgeContent={unreadCount}\r\n                color=\"primary\"\r\n                sx={{\r\n                  '& .MuiBadge-badge': {\r\n                    right: -3,\r\n                    top: 3,\r\n                  },\r\n                }}\r\n              />\r\n            )}\r\n          </>\r\n        }\r\n      />\r\n    </ListItem>\r\n  );\r\n};\r\n\r\nexport default ChatListItem; ","import React, { useState, useEffect } from 'react';\r\nimport { useChat } from '../../contexts/ChatContext';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport {\r\n  Box,\r\n  Typography,\r\n  TextField,\r\n  List,\r\n  InputAdornment,\r\n  CircularProgress,\r\n  Paper,\r\n  useTheme,\r\n  Button,\r\n} from '@mui/material';\r\nimport SearchIcon from '@mui/icons-material/Search';\r\nimport ChatBubbleOutlineIcon from '@mui/icons-material/ChatBubbleOutline';\r\nimport PersonAddIcon from '@mui/icons-material/PersonAdd';\r\nimport ChatListItem from './ChatListItem';\r\nimport { Chat } from '../../types/chat';\r\nimport { User } from '../../types/user';\r\n\r\ninterface ChatListProps {\r\n  onChatSelect?: (chat: Chat) => void;\r\n  selectedChatId?: string;\r\n}\r\n\r\n// Helper function to convert Chat to ChatListItem format\r\nconst convertChatToListItem = (chat: Chat) => {\r\n  // Ensure we have valid participants\r\n  const participants = chat.participants?.map(p => {\r\n    // Log the raw participant data\r\n    console.log('Raw participant data:', p);\r\n\r\n    // Ensure all required fields are present with proper type checking\r\n    const participant = {\r\n      uid: typeof p === 'object' && p ? p.uid || 'unknown' : 'unknown',\r\n      username: typeof p === 'object' && p ? p.username || 'user' : 'user',\r\n      displayName: typeof p === 'object' && p ? p.displayName || 'Unknown User' : 'Unknown User',\r\n      email: typeof p === 'object' && p ? p.email || '' : '',\r\n      photoURL: typeof p === 'object' && p ? p.photoURL || undefined : undefined,\r\n      online: typeof p === 'object' && p ? p.online || false : false\r\n    };\r\n\r\n    // Log the processed participant data\r\n    console.log('Processed participant data:', participant);\r\n\r\n    return participant;\r\n  }) || [];\r\n\r\n  // Log the final participants array\r\n  console.log('Final participants array:', participants);\r\n\r\n  // Handle lastMessage safely\r\n  const lastMessage = chat.lastMessage ? {\r\n    text: chat.lastMessage.text || '',\r\n    createdAt: typeof chat.lastMessage.createdAt === 'string'\r\n      ? chat.lastMessage.createdAt\r\n      : chat.lastMessage.createdAt instanceof Date\r\n        ? chat.lastMessage.createdAt.toISOString()\r\n        : new Date().toISOString()\r\n  } : undefined;\r\n\r\n  const chatListItem = {\r\n    _id: chat._id,\r\n    participants,\r\n    lastMessage,\r\n    updatedAt: chat.updatedAt || new Date().toISOString()\r\n  };\r\n\r\n  // Log the final chat list item\r\n  console.log('Final chat list item:', chatListItem);\r\n\r\n  return chatListItem;\r\n};\r\n\r\nconst ChatList: React.FC<ChatListProps> = ({ onChatSelect, selectedChatId }) => {\r\n  const { chats, currentChat, setCurrentChat, fetchChats, loading, error } = useChat();\r\n  const { user } = useAuth();\r\n  const theme = useTheme();\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      fetchChats();\r\n    }\r\n  }, [user, fetchChats]);\r\n\r\n  const filteredChats = chats.filter((chat: Chat) => {\r\n    const otherParticipant = chat.participants.find((p: User) => p.uid !== user?.uid);\r\n    const searchString = [\r\n      otherParticipant?.username,\r\n      otherParticipant?.displayName,\r\n      otherParticipant?.email\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ')\r\n      .toLowerCase();\r\n    return searchString.includes(searchQuery.toLowerCase());\r\n  });\r\n\r\n  const handleChatSelect = (chat: Chat) => {\r\n    setCurrentChat(chat);\r\n    if (onChatSelect) {\r\n      onChatSelect(chat);\r\n    }\r\n  };\r\n\r\n  if (!user) {\r\n    return (\r\n      <Paper\r\n        sx={{\r\n          height: '100%',\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          p: 4,\r\n          textAlign: 'center',\r\n        }}\r\n      >\r\n        <ChatBubbleOutlineIcon sx={{ fontSize: 48, color: 'primary.main', mb: 2 }} />\r\n        <Typography variant=\"h6\" gutterBottom>\r\n          Welcome to Chat\r\n        </Typography>\r\n        <Typography color=\"text.secondary\" sx={{ mb: 3 }}>\r\n          Please log in to start chatting with other users.\r\n        </Typography>\r\n        <Button\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          href=\"/login\"\r\n          startIcon={<PersonAddIcon />}\r\n        >\r\n          Sign In\r\n        </Button>\r\n      </Paper>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Box\r\n      sx={{\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        height: '100%',\r\n        borderRight: `1px solid ${theme.palette.divider}`,\r\n      }}\r\n    >\r\n      <Paper\r\n        elevation={0}\r\n        sx={{\r\n          p: 2,\r\n          backgroundColor: theme.palette.background.paper,\r\n          borderBottom: `1px solid ${theme.palette.divider}`,\r\n        }}\r\n      >\r\n        <TextField\r\n          fullWidth\r\n          placeholder=\"Search conversations...\"\r\n          variant=\"outlined\"\r\n          size=\"small\"\r\n          value={searchQuery}\r\n          onChange={(e) => setSearchQuery(e.target.value)}\r\n          InputProps={{\r\n            startAdornment: (\r\n              <InputAdornment position=\"start\">\r\n                <SearchIcon color=\"action\" />\r\n              </InputAdornment>\r\n            ),\r\n          }}\r\n          sx={{\r\n            '& .MuiOutlinedInput-root': {\r\n              borderRadius: 3,\r\n              backgroundColor: theme.palette.grey[50],\r\n              transition: theme.transitions.create(['box-shadow', 'background-color']),\r\n              '&:hover': {\r\n                backgroundColor: theme.palette.grey[100],\r\n              },\r\n              '&.Mui-focused': {\r\n                backgroundColor: theme.palette.background.paper,\r\n                boxShadow: `0 0 0 2px ${theme.palette.primary.main}25`,\r\n              },\r\n            },\r\n          }}\r\n        />\r\n      </Paper>\r\n\r\n      <Box\r\n        sx={{\r\n          flex: 1,\r\n          overflowY: 'auto',\r\n          px: 2,\r\n          py: 1,\r\n        }}\r\n      >\r\n        {loading ? (\r\n          <Box sx={{ display: 'flex', justifyContent: 'center', p: 4 }}>\r\n            <CircularProgress />\r\n          </Box>\r\n        ) : error ? (\r\n          <Box sx={{ p: 3, textAlign: 'center' }}>\r\n            <Typography color=\"error\" gutterBottom>\r\n              {error}\r\n            </Typography>\r\n            <Button\r\n              variant=\"outlined\"\r\n              color=\"primary\"\r\n              size=\"small\"\r\n              onClick={() => fetchChats()}\r\n              sx={{ mt: 1 }}\r\n            >\r\n              Try Again\r\n            </Button>\r\n          </Box>\r\n        ) : filteredChats.length > 0 ? (\r\n          <List disablePadding>\r\n            {filteredChats.map((chat: Chat) => (\r\n              <ChatListItem\r\n                key={chat._id}\r\n                chat={convertChatToListItem(chat)}\r\n                currentUserId={user.uid}\r\n                selected={chat._id === (selectedChatId || currentChat?._id)}\r\n                onClick={() => handleChatSelect(chat)}\r\n                unreadCount={chat.unreadCount}\r\n              />\r\n            ))}\r\n          </List>\r\n        ) : (\r\n          <Box\r\n            sx={{\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              height: '100%',\r\n              p: 3,\r\n              textAlign: 'center',\r\n            }}\r\n          >\r\n            <ChatBubbleOutlineIcon\r\n              sx={{\r\n                fontSize: 48,\r\n                color: theme.palette.text.secondary,\r\n                mb: 2,\r\n              }}\r\n            />\r\n            <Typography variant=\"h6\" color=\"text.secondary\" gutterBottom>\r\n              {searchQuery ? 'No conversations found' : 'No conversations yet'}\r\n            </Typography>\r\n            <Typography color=\"text.secondary\" variant=\"body2\">\r\n              {searchQuery\r\n                ? 'Try a different search term'\r\n                : 'Start a new conversation to connect with others'}\r\n            </Typography>\r\n          </Box>\r\n        )}\r\n      </Box>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default ChatList; ","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z\"\n}), 'Send');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6z\"\n}), 'AttachFile');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M8.5 8c.83 0 1.5.67 1.5 1.5S9.33 11 8.5 11 7 10.33 7 9.5 7.67 8 8.5 8M12 18c-2.28 0-4.22-1.66-5-4h10c-.78 2.34-2.72 4-5 4m3.5-7c-.83 0-1.5-.67-1.5-1.5S14.67 8 15.5 8s1.5.67 1.5 1.5-.67 1.5-1.5 1.5\"\n}), 'EmojiEmotions');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2\"\n}), 'MoreVert');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"m18 7-1.41-1.41-6.34 6.34 1.41 1.41zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12zM.41 13.41 6 19l1.41-1.41L1.83 12z\"\n}), 'DoneAll');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2M8.5 13.5l2.5 3.01L14.5 12l4.5 6H5z\"\n}), 'Image');","import React, { useEffect, useRef, useState } from 'react';\nimport { useChat } from '../../contexts/ChatContext';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { format, isToday, isYesterday } from 'date-fns';\nimport { Message } from '../../types/message';\nimport { User } from '../../types/user';\nimport {\n  Box,\n  Typography,\n  Avatar,\n  TextField,\n  IconButton,\n  Paper,\n  Badge,\n  useTheme,\n  List,\n  ListItem,\n} from '@mui/material';\nimport SendIcon from '@mui/icons-material/Send';\nimport AttachFileIcon from '@mui/icons-material/AttachFile';\nimport EmojiEmotionsIcon from '@mui/icons-material/EmojiEmotions';\nimport MoreVertIcon from '@mui/icons-material/MoreVert';\nimport DoneAllIcon from '@mui/icons-material/DoneAll';\nimport ImageIcon from '@mui/icons-material/Image';\n\nconst TYPING_TIMER_LENGTH = 3000;\n\n// Type guard for User type\nconst isUser = (sender: string | User): sender is User => {\n  return typeof sender !== 'string' && sender !== null;\n};\n\ninterface ChatWindowProps {\n  chatId: string;\n  onClose: () => void;\n}\n\nconst ChatWindow: React.FC<ChatWindowProps> = ({ chatId, onClose }) => {\n  const { currentChat, messages, sendMessage, socket } = useChat();\n  const { user } = useAuth();\n  const [newMessage, setNewMessage] = useState('');\n  const [isTyping, setIsTyping] = useState(false);\n  const [typingUsers, setTypingUsers] = useState<Set<string>>(new Set());\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const typingTimeoutRef = useRef<NodeJS.Timeout>();\n  const theme = useTheme();\n\n  // Debug log\n  useEffect(() => {\n    if (currentChat) {\n      console.log('ChatWindow currentChat:', {\n        chatId: currentChat._id,\n        participants: currentChat.participants.map(p => ({\n          _id: p._id,\n          username: p.username,\n          email: p.email,\n          displayName: p.displayName\n        }))\n      });\n    }\n  }, [currentChat]);\n\n  // Scroll to bottom when messages change\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [messages]);\n\n  // Handle socket events\n  useEffect(() => {\n    if (!socket || !chatId) return;\n\n    const handleMessage = (message: Message) => {\n      if (message.chat === chatId) {\n        // Messages are managed by the ChatContext\n        console.log('New message received:', message);\n      }\n    };\n\n    const handleTyping = (data: { chatId: string; userId: string; isTyping: boolean }) => {\n      if (data.chatId === chatId) {\n        setTypingUsers(prev => {\n          const newSet = new Set(prev);\n          if (data.isTyping) {\n            newSet.add(data.userId);\n          } else {\n            newSet.delete(data.userId);\n          }\n          return newSet;\n        });\n      }\n    };\n\n    socket.on('message', handleMessage);\n    socket.on('typing', handleTyping);\n\n    return () => {\n      socket.off('message', handleMessage);\n      socket.off('typing', handleTyping);\n    };\n  }, [socket, chatId]);\n\n  // Handle typing indicator\n  const handleTyping = () => {\n    if (!socket || !chatId || !user) return;\n\n    setIsTyping(true);\n    socket.emit('typing', { chatId, isTyping: true });\n\n    if (typingTimeoutRef.current) {\n      clearTimeout(typingTimeoutRef.current);\n    }\n\n    typingTimeoutRef.current = setTimeout(() => {\n      setIsTyping(false);\n      socket.emit('typing', { chatId, isTyping: false });\n    }, TYPING_TIMER_LENGTH);\n  };\n\n  // Handle message submission\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!newMessage.trim() || !chatId) return;\n\n    try {\n      await sendMessage(chatId, newMessage);\n      setNewMessage('');\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n\n  const formatMessageDate = (date: string) => {\n    const messageDate = new Date(date);\n    if (isToday(messageDate)) {\n      return format(messageDate, 'HH:mm');\n    } else if (isYesterday(messageDate)) {\n      return 'Yesterday';\n    } else {\n      return format(messageDate, 'MMM d');\n    }\n  };\n\n  const renderMessageGroup = (message: Message, isLastInGroup: boolean) => {\n    const sender = message.sender;\n    const isCurrentUser = isUser(sender) ? sender._id === user?.uid : sender === user?.uid;\n    \n    // Safely get sender name with fallbacks\n    const getSenderName = () => {\n      if (!sender) return 'Unknown User';\n      if (isUser(sender)) {\n        return sender.username || sender.displayName || sender.email?.split('@')[0] || 'Unknown User';\n      }\n      return 'Unknown User';\n    };\n    \n    const senderName = getSenderName();\n    \n    return (\n      <ListItem\n        key={message._id}\n        sx={{\n          display: 'flex',\n          justifyContent: isCurrentUser ? 'flex-end' : 'flex-start',\n          alignItems: 'flex-start',\n          mb: isLastInGroup ? 1.5 : 0.5,\n          px: 2,\n          '&:hover': {\n            bgcolor: 'transparent',\n          },\n          position: 'relative',\n        }}\n        disableGutters\n      >\n        {!isCurrentUser && isLastInGroup && isUser(message.sender) && (\n          <Avatar\n            src={message.sender.photoURL || undefined}\n            sx={{\n              width: 28,\n              height: 28,\n              mr: 1,\n              bgcolor: theme.palette.grey[400],\n              position: 'absolute',\n              left: theme.spacing(2),\n              top: 0,\n            }}\n          >\n            {senderName[0]?.toUpperCase()}\n          </Avatar>\n        )}\n        <Box\n          sx={{\n            maxWidth: '65%',\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: isCurrentUser ? 'flex-end' : 'flex-start',\n            ml: !isCurrentUser ? 5 : 0,\n          }}\n        >\n          {!isCurrentUser && isLastInGroup && (\n            <Typography\n              variant=\"caption\"\n              sx={{\n                mb: 0.5,\n                ml: 0.5,\n                color: theme.palette.text.secondary,\n                fontSize: '0.75rem',\n              }}\n            >\n              {senderName}\n            </Typography>\n          )}\n          <Paper\n            elevation={0}\n            sx={{\n              p: 1.5,\n              bgcolor: isCurrentUser \n                ? theme.palette.primary.main \n                : theme.palette.grey[100],\n              color: isCurrentUser \n                ? theme.palette.primary.contrastText \n                : theme.palette.text.primary,\n              borderRadius: 2.5,\n              borderTopRightRadius: isCurrentUser && isLastInGroup ? 0 : 2.5,\n              borderTopLeftRadius: !isCurrentUser && isLastInGroup ? 0 : 2.5,\n              position: 'relative',\n              wordBreak: 'break-word',\n              maxWidth: '100%',\n              boxShadow: `0 1px 2px ${theme.palette.mode === 'dark' \n                ? 'rgba(0,0,0,0.15)' \n                : 'rgba(0,0,0,0.1)'}`,\n              '&::before': isLastInGroup ? {\n                content: '\"\"',\n                position: 'absolute',\n                top: 0,\n                [isCurrentUser ? 'right' : 'left']: -8,\n                borderStyle: 'solid',\n                borderWidth: '8px 8px 0 0',\n                borderColor: `${isCurrentUser \n                  ? theme.palette.primary.main \n                  : theme.palette.grey[100]} transparent transparent transparent`,\n                transform: isCurrentUser ? 'none' : 'scaleX(-1)',\n              } : {},\n            }}\n          >\n            <Typography\n              variant=\"body1\" \n              sx={{ \n                wordBreak: 'break-word',\n                whiteSpace: 'pre-wrap',\n                lineHeight: 1.4,\n              }}\n            >\n              {message.text}\n            </Typography>\n            <Box\n              sx={{\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'flex-end',\n                gap: 0.5,\n                mt: 0.5,\n                opacity: 0.7,\n                minHeight: 15,\n              }}\n            >\n              <Typography \n                variant=\"caption\" \n                sx={{ \n                  fontSize: '0.7rem',\n                  color: isCurrentUser \n                    ? theme.palette.primary.contrastText \n                    : theme.palette.text.secondary,\n                  opacity: 0.8,\n                }}\n              >\n                {formatMessageDate(typeof message.createdAt === 'string' \n                  ? message.createdAt \n                  : message.createdAt.toISOString())}\n              </Typography>\n              {isCurrentUser && (\n                <DoneAllIcon \n                  sx={{ \n                    fontSize: 14,\n                    color: message.read \n                      ? theme.palette.primary.contrastText \n                      : 'rgba(255,255,255,0.7)',\n                    opacity: message.read ? 1 : 0.5,\n                  }} \n                />\n              )}\n            </Box>\n          </Paper>\n        </Box>\n      </ListItem>\n    );\n  };\n\n  // Render empty state if no chat is selected\n  if (!chatId || !currentChat) {\n    return (\n      <Box\n        sx={{\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'center',\n          height: '100%',\n          bgcolor: 'background.paper',\n          borderRadius: 2,\n          p: 3,\n        }}\n      >\n        <ImageIcon sx={{ fontSize: 64, color: 'text.secondary', mb: 2 }} />\n        <Typography variant=\"h6\" color=\"text.secondary\" gutterBottom>\n          Select a Chat\n        </Typography>\n        <Typography color=\"text.secondary\" textAlign=\"center\">\n          Choose a conversation from the list to start messaging\n        </Typography>\n      </Box>\n    );\n  }\n\n  const typingUsersCount = typingUsers.size;\n  const otherParticipant = currentChat.participants.find(p => p._id !== user?.uid);\n\n  return (\n    <Box\n      sx={{\n        display: 'flex',\n        flexDirection: 'column',\n        height: '100%',\n        bgcolor: theme.palette.background.default,\n        borderRadius: theme.shape.borderRadius,\n        overflow: 'hidden',\n      }}\n    >\n      {/* Header */}\n      <Paper\n        elevation={2}\n        sx={{\n          p: 2,\n          bgcolor: theme.palette.background.paper,\n          borderBottom: `1px solid ${theme.palette.divider}`,\n        }}\n      >\n        <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n          <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\n            <Badge\n              overlap=\"circular\"\n              anchorOrigin={{ vertical: 'bottom', horizontal: 'right' }}\n              variant=\"dot\"\n              color=\"success\"\n            >\n              <Avatar\n                src={otherParticipant?.photoURL}\n                alt={otherParticipant?.username}\n                sx={{ \n                  width: 45, \n                  height: 45,\n                  border: `2px solid ${theme.palette.primary.main}` \n                }}\n              >\n                {otherParticipant?.username?.[0]?.toUpperCase()}\n              </Avatar>\n            </Badge>\n            <Box>\n              <Typography variant=\"h6\" sx={{ fontWeight: 600 }}>\n                {otherParticipant?.username}\n              </Typography>\n              <Typography variant=\"caption\" color=\"text.secondary\">\n                {isTyping ? 'typing...' : 'online'}\n              </Typography>\n            </Box>\n          </Box>\n          <IconButton onClick={onClose} size=\"small\">\n            <MoreVertIcon />\n          </IconButton>\n        </Box>\n      </Paper>\n\n      {/* Messages Area */}\n      <Box\n        sx={{\n          flex: 1,\n          overflowY: 'auto',\n          bgcolor: theme.palette.background.default,\n          backgroundImage: 'linear-gradient(rgba(255,255,255,.95), rgba(255,255,255,.95))',\n          display: 'flex',\n          flexDirection: 'column',\n        }}\n      >\n        <List sx={{ width: '100%', pt: 2, pb: 2 }}>\n          {messages.length > 0 ? (\n            messages.map((message, index) => {\n              const nextMessage = messages[index + 1];\n              const currentSenderId = isUser(message.sender) ? message.sender._id : message.sender;\n              const nextSenderId = nextMessage && isUser(nextMessage.sender) \n                ? nextMessage.sender._id \n                : nextMessage?.sender;\n              \n              const isLastInGroup = !nextMessage || \n                !nextSenderId || \n                !currentSenderId ||\n                nextSenderId !== currentSenderId ||\n                new Date(nextMessage.createdAt).getTime() - new Date(message.createdAt).getTime() > 300000;\n\n              return renderMessageGroup(message, isLastInGroup);\n            })\n          ) : (\n            <Box\n              sx={{\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n                justifyContent: 'center',\n                height: '100%',\n                p: 3,\n              }}\n            >\n              <Typography variant=\"body1\" color=\"text.secondary\">\n                {currentChat?.participants.some(p => p.username === 'Ivan' || p.displayName === 'Ivan')\n                  ? `You have 1 message(s) from Ivan`\n                  : 'No messages yet. Start the conversation!'}\n              </Typography>\n            </Box>\n          )}\n          {typingUsersCount > 0 && (\n            <ListItem sx={{ justifyContent: 'flex-start' }}>\n              <Avatar sx={{ width: 32, height: 32, mr: 1 }}>U</Avatar>\n              <Paper\n                elevation={1}\n                sx={{\n                  p: 1.5,\n                  bgcolor: 'grey.100',\n                  borderRadius: 2\n                }}\n              >\n                <Typography variant=\"caption\" color=\"text.secondary\" sx={{ fontStyle: 'italic' }}>\n                  {typingUsersCount === 1 ? 'Someone is typing...' : 'Multiple people are typing...'}\n                </Typography>\n              </Paper>\n            </ListItem>\n          )}\n          <div ref={messagesEndRef} />\n        </List>\n      </Box>\n\n      {/* Input Area */}\n      <Paper\n        component=\"form\"\n        onSubmit={handleSubmit}\n        sx={{\n          p: 2,\n          bgcolor: theme.palette.background.paper,\n          borderTop: `1px solid ${theme.palette.divider}`,\n          display: 'flex',\n          gap: 1,\n          alignItems: 'center',\n        }}\n      >\n        <IconButton size=\"small\" color=\"primary\">\n          <EmojiEmotionsIcon />\n        </IconButton>\n        <IconButton size=\"small\" color=\"primary\">\n          <AttachFileIcon />\n        </IconButton>\n        <TextField\n          fullWidth\n          variant=\"outlined\"\n          placeholder=\"Type a message...\"\n          value={newMessage}\n          onChange={(e) => {\n            setNewMessage(e.target.value);\n            handleTyping();\n          }}\n          size=\"small\"\n          sx={{\n            '& .MuiOutlinedInput-root': {\n              borderRadius: 3,\n              bgcolor: theme.palette.grey[50],\n            },\n          }}\n          multiline\n          maxRows={4}\n        />\n        <IconButton \n          type=\"submit\" \n          color=\"primary\" \n          disabled={!newMessage.trim()}\n          sx={{\n            bgcolor: theme.palette.primary.main,\n            color: theme.palette.primary.contrastText,\n            '&:hover': {\n              bgcolor: theme.palette.primary.dark,\n            },\n            '&.Mui-disabled': {\n              bgcolor: theme.palette.action.disabledBackground,\n            },\n          }}\n        >\n          <SendIcon />\n        </IconButton>\n      </Paper>\n    </Box>\n  );\n};\n\nexport default ChatWindow; ","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z\"\n}), 'Menu');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z\"\n}), 'ArrowBack');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z\"\n}), 'Notifications');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6\"\n}), 'Settings');","import React, { useEffect, useState } from 'react';\r\nimport {\r\n  Box,\r\n  Container,\r\n  Paper,\r\n  Typography,\r\n  useTheme,\r\n  useMediaQuery,\r\n  IconButton,\r\n  Drawer,\r\n  AppBar,\r\n  Toolbar,\r\n  Button,\r\n  Fade,\r\n  Badge,\r\n} from '@mui/material';\r\nimport ChatList from '../components/chat/ChatList';\r\nimport ChatWindow from '../components/chat/ChatWindow';\r\nimport { useChat } from '../contexts/ChatContext';\r\nimport MenuIcon from '@mui/icons-material/Menu';\r\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack';\r\nimport NotificationsIcon from '@mui/icons-material/Notifications';\r\nimport SettingsIcon from '@mui/icons-material/Settings';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst ChatPage: React.FC = () => {\r\n  const theme = useTheme();\r\n  const navigate = useNavigate();\r\n  const isMobile = useMediaQuery(theme.breakpoints.down('md'));\r\n  const [mobileOpen, setMobileOpen] = useState(false);\r\n  const { currentChat, setCurrentChat, unreadCount } = useChat();\r\n  const { user } = useAuth();\r\n\r\n  useEffect(() => {\r\n    // Hide main navbar and set body background\r\n    const navbar = document.querySelector('nav');\r\n    const body = document.body;\r\n    if (navbar) navbar.style.display = 'none';\r\n    body.style.backgroundColor = theme.palette.background.default;\r\n    \r\n    return () => {\r\n      if (navbar) navbar.style.display = 'flex';\r\n      body.style.backgroundColor = '';\r\n    };\r\n  }, [theme.palette.background.default]);\r\n\r\n  const handleDrawerToggle = () => setMobileOpen(!mobileOpen);\r\n\r\n  const handleChatSelect = (chat: any) => {\r\n    setCurrentChat(chat);\r\n    if (isMobile) setMobileOpen(false);\r\n  };\r\n\r\n  const handleBack = () => {\r\n    if (currentChat && isMobile) {\r\n      setCurrentChat(null);\r\n      setMobileOpen(true);\r\n    } else {\r\n      navigate('/');\r\n    }\r\n  };\r\n\r\n  if (!user) {\r\n    return (\r\n      <Container maxWidth=\"sm\" sx={{ mt: 8 }}>\r\n        <Fade in timeout={800}>\r\n          <Paper\r\n            elevation={3}\r\n            sx={{\r\n              p: 4,\r\n              textAlign: 'center',\r\n              borderRadius: 3,\r\n              bgcolor: 'background.paper',\r\n              boxShadow: theme.shadows[3],\r\n            }}\r\n          >\r\n            <Typography variant=\"h4\" gutterBottom fontWeight=\"500\" color=\"primary\">\r\n              Welcome to Chat\r\n            </Typography>\r\n            <Typography variant=\"body1\" color=\"text.secondary\" paragraph>\r\n              Please sign in to start connecting with other users in real-time.\r\n            </Typography>\r\n            <Button\r\n              variant=\"contained\"\r\n              size=\"large\"\r\n              onClick={() => navigate('/login')}\r\n              sx={{\r\n                mt: 2,\r\n                borderRadius: 2,\r\n                textTransform: 'none',\r\n                fontSize: '1.1rem',\r\n              }}\r\n            >\r\n              Sign In\r\n            </Button>\r\n          </Paper>\r\n        </Fade>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  const chatList = (\r\n    <Box sx={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\r\n      <Box\r\n        sx={{\r\n          p: 2,\r\n          borderBottom: `1px solid ${theme.palette.divider}`,\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'space-between',\r\n        }}\r\n      >\r\n        <Typography variant=\"h6\" fontWeight=\"500\">\r\n          Messages\r\n        </Typography>\r\n        <Box sx={{ display: 'flex', gap: 1 }}>\r\n          <IconButton size=\"small\">\r\n            <Badge badgeContent={unreadCount} color=\"primary\">\r\n              <NotificationsIcon />\r\n            </Badge>\r\n          </IconButton>\r\n          <IconButton size=\"small\">\r\n            <SettingsIcon />\r\n          </IconButton>\r\n        </Box>\r\n      </Box>\r\n      <Box sx={{ flex: 1, overflow: 'auto' }}>\r\n        <ChatList\r\n          onChatSelect={handleChatSelect}\r\n          selectedChatId={currentChat?._id}\r\n        />\r\n      </Box>\r\n    </Box>\r\n  );\r\n\r\n  return (\r\n    <Box\r\n      sx={{\r\n        height: '100vh',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        bgcolor: theme.palette.background.default,\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        zIndex: theme.zIndex.drawer + 1,\r\n      }}\r\n    >\r\n      <AppBar\r\n        position=\"static\"\r\n        color=\"inherit\"\r\n        elevation={0}\r\n        sx={{\r\n          borderBottom: `1px solid ${theme.palette.divider}`,\r\n          bgcolor: theme.palette.background.paper,\r\n        }}\r\n      >\r\n        <Toolbar sx={{ minHeight: { xs: 56, sm: 64 } }}>\r\n          <IconButton\r\n            edge=\"start\"\r\n            onClick={handleBack}\r\n            sx={{\r\n              mr: 2,\r\n              color: theme.palette.text.primary,\r\n              '&:hover': { bgcolor: theme.palette.action.hover },\r\n            }}\r\n          >\r\n            {currentChat && isMobile ? <ArrowBackIcon /> : <ArrowBackIcon />}\r\n          </IconButton>\r\n          <Typography\r\n            variant=\"h6\"\r\n            component=\"div\"\r\n            sx={{\r\n              flexGrow: 1,\r\n              fontWeight: 500,\r\n              color: theme.palette.text.primary,\r\n            }}\r\n          >\r\n            {currentChat && isMobile\r\n              ? currentChat.participants.find(p => p._id !== user.uid)?.username\r\n              : 'Messages'}\r\n          </Typography>\r\n          {isMobile && !currentChat && (\r\n            <IconButton\r\n              color=\"inherit\"\r\n              edge=\"end\"\r\n              onClick={handleDrawerToggle}\r\n              sx={{ display: { md: 'none' } }}\r\n            >\r\n              <MenuIcon />\r\n            </IconButton>\r\n          )}\r\n        </Toolbar>\r\n      </AppBar>\r\n\r\n      <Box\r\n        sx={{\r\n          flex: 1,\r\n          display: 'flex',\r\n          overflow: 'hidden',\r\n          bgcolor: theme.palette.background.default,\r\n        }}\r\n      >\r\n        {/* Chat List - Responsive */}\r\n        {isMobile ? (\r\n          <Drawer\r\n            variant=\"temporary\"\r\n            anchor=\"left\"\r\n            open={mobileOpen}\r\n            onClose={handleDrawerToggle}\r\n            ModalProps={{ keepMounted: true }}\r\n            sx={{\r\n              display: { xs: 'block', md: 'none' },\r\n              '& .MuiDrawer-paper': {\r\n                width: { xs: '100%', sm: 320 },\r\n                bgcolor: theme.palette.background.paper,\r\n              },\r\n            }}\r\n          >\r\n            {chatList}\r\n          </Drawer>\r\n        ) : (\r\n          <Box\r\n            sx={{\r\n              width: 320,\r\n              flexShrink: 0,\r\n              bgcolor: theme.palette.background.paper,\r\n              borderRight: `1px solid ${theme.palette.divider}`,\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n            }}\r\n          >\r\n            {chatList}\r\n          </Box>\r\n        )}\r\n\r\n        {/* Chat Window */}\r\n        <Box\r\n          sx={{\r\n            flex: 1,\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            bgcolor: theme.palette.background.default,\r\n            ...(isMobile && !currentChat && { display: 'none' }),\r\n          }}\r\n        >\r\n          <ChatWindow \r\n            chatId={currentChat?._id || ''} \r\n            onClose={handleBack}\r\n          />\r\n        </Box>\r\n      </Box>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default ChatPage; ","import { Routes, Route } from 'react-router-dom';\r\nimport Home from './pages/Home';\r\nimport Login from './pages/Login';\r\nimport Register from './pages/Register';\r\nimport Profile from './pages/Profile';\r\nimport CreateListing from './pages/CreateListing';\r\nimport ListingDetails from './pages/ListingDetails';\r\nimport EditListing from './pages/EditListing';\r\nimport Search from './pages/Search';\r\nimport HowItWorks from './pages/HowItWorks';\r\nimport MyListings from './pages/MyListings';\r\nimport About from './pages/About';\r\nimport Settings from './pages/Settings';\r\nimport Contact from './pages/Contact';\r\nimport Favorites from './pages/Favorites';\r\nimport Privacy from './pages/Privacy';\r\nimport Terms from './pages/Terms';\r\nimport ForgotPassword from './pages/ForgotPassword';\r\nimport NotFound from './pages/NotFound';\r\nimport ChatPage from './pages/ChatPage';\r\n\r\nconst AppRoutes = () => {\r\n  return (\r\n    <Routes>\r\n      <Route path=\"/\" element={<Home />} />\r\n      <Route path=\"/login\" element={<Login />} />\r\n      <Route path=\"/register\" element={<Register />} />\r\n      <Route path=\"/forgot-password\" element={<ForgotPassword />} />\r\n      <Route path=\"/profile\" element={<Profile />} />\r\n      <Route path=\"/settings\" element={<Settings />} />\r\n      <Route path=\"/contact\" element={<Contact />} />\r\n      <Route path=\"/create-listing\" element={<CreateListing />} />\r\n      <Route path=\"/listing/:id\" element={<ListingDetails />} />\r\n      <Route path=\"/edit-listing/:id\" element={<EditListing />} />\r\n      <Route path=\"/search\" element={<Search />} />\r\n      <Route path=\"/how-it-works\" element={<HowItWorks />} />\r\n      <Route path=\"/my-listings\" element={<MyListings />} />\r\n      <Route path=\"/about\" element={<About />} />\r\n      <Route path=\"/favorites\" element={<Favorites />} />\r\n      <Route path=\"/privacy\" element={<Privacy />} />\r\n      <Route path=\"/terms\" element={<Terms />} />\r\n      <Route path=\"/chat\" element={<ChatPage />} />\r\n      <Route path=\"*\" element={<NotFound />} />\r\n    </Routes>\r\n  );\r\n};\r\n\r\nexport default AppRoutes; ","import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n  AppBar,\r\n  Box,\r\n  Toolbar,\r\n  IconButton,\r\n  Typography,\r\n  Menu,\r\n  Container,\r\n  Avatar,\r\n  Button,\r\n  Tooltip,\r\n  MenuItem,\r\n  useTheme,\r\n  useMediaQuery,\r\n  Badge,\r\n} from '@mui/material';\r\nimport {\r\n  Menu as MenuIcon,\r\n  Recycling as RecyclingIcon,\r\n  Add as AddIcon,\r\n  Chat as ChatIcon,\r\n} from '@mui/icons-material';\r\nimport { useAuth } from '../hooks/useAuth';\r\nimport { useChat } from '../contexts/ChatContext';\r\n\r\nconst Navbar = () => {\r\n  const navigate = useNavigate();\r\n  const { user, logout } = useAuth();\r\n  const { unreadCount } = useChat();\r\n  const theme = useTheme();\r\n  const isMobile = useMediaQuery(theme.breakpoints.down('md'));\r\n  \r\n  const [anchorElNav, setAnchorElNav] = useState<null | HTMLElement>(null);\r\n  const [anchorElUser, setAnchorElUser] = useState<null | HTMLElement>(null);\r\n\r\n  const pages = [\r\n    { title: 'Начало', path: '/' },\r\n    { title: 'Търсене', path: '/search' },\r\n    { title: 'Как работи', path: '/how-it-works' },\r\n    { title: 'За нас', path: '/about' },\r\n    { title: 'Контакти', path: '/contact' },\r\n  ];\r\n\r\n  const userMenuItems = user ? [\r\n    { title: 'Профил', path: '/profile' },\r\n    { title: 'Моите обяви', path: '/my-listings' },\r\n    { title: 'Любими', path: '/favorites' },\r\n    { title: 'Настройки', path: '/settings' },\r\n    { title: 'Изход', action: logout },\r\n  ] : [\r\n    { title: 'Вход', path: '/login' },\r\n    { title: 'Регистрация', path: '/register' },\r\n  ];\r\n\r\n  const handleOpenNavMenu = (event: React.MouseEvent<HTMLElement>) => {\r\n    setAnchorElNav(event.currentTarget);\r\n  };\r\n\r\n  const handleOpenUserMenu = (event: React.MouseEvent<HTMLElement>) => {\r\n    setAnchorElUser(event.currentTarget);\r\n  };\r\n\r\n  const handleCloseNavMenu = () => {\r\n    setAnchorElNav(null);\r\n  };\r\n\r\n  const handleCloseUserMenu = () => {\r\n    setAnchorElUser(null);\r\n  };\r\n\r\n  const handleMenuItemClick = (path?: string, action?: () => void) => {\r\n    if (action) {\r\n      action();\r\n    } else if (path) {\r\n      navigate(path);\r\n    }\r\n    handleCloseNavMenu();\r\n    handleCloseUserMenu();\r\n  };\r\n\r\n  return (\r\n    <AppBar position=\"sticky\" color=\"default\" elevation={1}>\r\n      <Container maxWidth=\"lg\">\r\n        <Toolbar disableGutters>\r\n          {/* Logo - visible on desktop */}\r\n          <Box sx={{ display: { xs: 'none', md: 'flex' }, mr: 2 }}>\r\n            <IconButton\r\n              onClick={() => navigate('/')}\r\n              sx={{ p: 0, color: 'primary.main' }}\r\n            >\r\n              <RecyclingIcon sx={{ fontSize: 32 }} />\r\n            </IconButton>\r\n          </Box>\r\n\r\n          {/* Mobile menu */}\r\n          <Box sx={{ flexGrow: 1, display: { xs: 'flex', md: 'none' } }}>\r\n            <IconButton\r\n              size=\"large\"\r\n              aria-label=\"menu\"\r\n              aria-controls=\"menu-appbar\"\r\n              aria-haspopup=\"true\"\r\n              onClick={handleOpenNavMenu}\r\n              color=\"inherit\"\r\n            >\r\n              <MenuIcon />\r\n            </IconButton>\r\n            <Menu\r\n              id=\"menu-appbar\"\r\n              anchorEl={anchorElNav}\r\n              anchorOrigin={{\r\n                vertical: 'bottom',\r\n                horizontal: 'left',\r\n              }}\r\n              keepMounted\r\n              transformOrigin={{\r\n                vertical: 'top',\r\n                horizontal: 'left',\r\n              }}\r\n              open={Boolean(anchorElNav)}\r\n              onClose={handleCloseNavMenu}\r\n              sx={{\r\n                display: { xs: 'block', md: 'none' },\r\n              }}\r\n            >\r\n              {pages.map((page) => (\r\n                <MenuItem\r\n                  key={page.title}\r\n                  onClick={() => handleMenuItemClick(page.path)}\r\n                >\r\n                  <Typography textAlign=\"center\">{page.title}</Typography>\r\n                </MenuItem>\r\n              ))}\r\n            </Menu>\r\n          </Box>\r\n\r\n          {/* Logo - visible on mobile */}\r\n          <Box sx={{ display: { xs: 'flex', md: 'none' }, flexGrow: 1 }}>\r\n            <IconButton\r\n              onClick={() => navigate('/')}\r\n              sx={{ p: 0, color: 'primary.main' }}\r\n            >\r\n              <RecyclingIcon sx={{ fontSize: 32 }} />\r\n            </IconButton>\r\n          </Box>\r\n\r\n          {/* Desktop menu */}\r\n          <Box sx={{ flexGrow: 1, display: { xs: 'none', md: 'flex' } }}>\r\n            {pages.map((page) => (\r\n              <Button\r\n                key={page.title}\r\n                onClick={() => handleMenuItemClick(page.path)}\r\n                sx={{\r\n                  my: 2,\r\n                  color: 'text.primary',\r\n                  display: 'block',\r\n                  '&:hover': {\r\n                    color: 'primary.main',\r\n                  },\r\n                }}\r\n              >\r\n                {page.title}\r\n              </Button>\r\n            ))}\r\n          </Box>\r\n\r\n          {/* Chat Icon */}\r\n          {user && (\r\n            <Tooltip title=\"Messages\">\r\n              <IconButton\r\n                onClick={() => navigate('/chat')}\r\n                sx={{ \r\n                  mr: 2, \r\n                  color: 'text.primary',\r\n                  position: 'relative'\r\n                }}\r\n              >\r\n                <Badge \r\n                  badgeContent={unreadCount || 0} \r\n                  color=\"error\"\r\n                  invisible={!unreadCount}\r\n                  sx={{\r\n                    '& .MuiBadge-badge': {\r\n                      backgroundColor: theme.palette.error.main,\r\n                      color: theme.palette.error.contrastText,\r\n                      minWidth: '20px',\r\n                      height: '20px',\r\n                      borderRadius: '10px',\r\n                      fontSize: '0.75rem',\r\n                      fontWeight: 'bold',\r\n                      padding: '0 6px',\r\n                      transform: 'scale(1) translate(25%, -25%)',\r\n                    }\r\n                  }}\r\n                >\r\n                  <ChatIcon />\r\n                </Badge>\r\n              </IconButton>\r\n            </Tooltip>\r\n          )}\r\n\r\n          {/* Create Listing Button */}\r\n          {user && (\r\n            <Button\r\n              startIcon={<AddIcon />}\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              onClick={() => navigate('/create-listing')}\r\n              sx={{ mr: 2 }}\r\n            >\r\n              {isMobile ? 'Добави' : 'Създай обява'}\r\n            </Button>\r\n          )}\r\n\r\n          {/* User Menu */}\r\n          <Box sx={{ flexShrink: 0 }}>\r\n            <Tooltip title={user ? 'Настройки на профила' : 'Вход'}>\r\n              <IconButton onClick={handleOpenUserMenu} sx={{ p: 0 }}>\r\n                <Avatar\r\n                  alt={user?.displayName || 'User'}\r\n                  src={user?.photoURL || undefined}\r\n                  sx={{\r\n                    bgcolor: user ? 'primary.main' : 'grey.400',\r\n                    width: 40,\r\n                    height: 40,\r\n                  }}\r\n                >\r\n                  {user?.displayName?.[0] || 'U'}\r\n                </Avatar>\r\n              </IconButton>\r\n            </Tooltip>\r\n            <Menu\r\n              sx={{ mt: '45px' }}\r\n              id=\"menu-appbar\"\r\n              anchorEl={anchorElUser}\r\n              anchorOrigin={{\r\n                vertical: 'top',\r\n                horizontal: 'right',\r\n              }}\r\n              keepMounted\r\n              transformOrigin={{\r\n                vertical: 'top',\r\n                horizontal: 'right',\r\n              }}\r\n              open={Boolean(anchorElUser)}\r\n              onClose={handleCloseUserMenu}\r\n            >\r\n              {userMenuItems.map((item) => (\r\n                <MenuItem\r\n                  key={item.title}\r\n                  onClick={() => handleMenuItemClick(item.path, item.action)}\r\n                >\r\n                  <Typography textAlign=\"center\">{item.title}</Typography>\r\n                </MenuItem>\r\n              ))}\r\n            </Menu>\r\n          </Box>\r\n        </Toolbar>\r\n      </Container>\r\n    </AppBar>\r\n  );\r\n};\r\n\r\nexport default Navbar; ","import React from 'react';\r\nimport { BrowserRouter as Router } from 'react-router-dom';\r\nimport { ThemeProvider } from '@mui/material/styles';\r\nimport CssBaseline from '@mui/material/CssBaseline';\r\nimport { Box, GlobalStyles } from '@mui/material';\r\nimport { AnalyticsProvider } from './components/AnalyticsProvider';\r\nimport { AuthProvider } from './contexts/AuthContext';\r\nimport { ChatProvider } from './contexts/ChatContext';\r\nimport { theme } from './theme';\r\nimport AppRoutes from './routes';\r\nimport Navbar from './components/Navbar';\r\n\r\nconst globalStyles = {\r\n  '*': {\r\n    margin: 0,\r\n    padding: 0,\r\n    boxSizing: 'border-box',\r\n  },\r\n  'html, body, #root': {\r\n    width: '100%',\r\n    minHeight: '100vh',\r\n    margin: 0,\r\n    padding: 0,\r\n  },\r\n  body: {\r\n    overflowY: 'auto',\r\n    overflowX: 'hidden',\r\n  },\r\n};\r\n\r\nconst App: React.FC = () => {\r\n  return (\r\n    <Router\r\n      future={{\r\n        v7_startTransition: true,\r\n        v7_relativeSplatPath: true,\r\n      }}\r\n    >\r\n      <ThemeProvider theme={theme}>\r\n        <CssBaseline />\r\n        <GlobalStyles styles={globalStyles} />\r\n        <AuthProvider>\r\n          <ChatProvider>\r\n            <AnalyticsProvider>\r\n              <Box\r\n                sx={{\r\n                  display: 'flex',\r\n                  flexDirection: 'column',\r\n                  minHeight: '100vh',\r\n                  width: '100%',\r\n                  position: 'relative',\r\n                  overflow: 'hidden',\r\n                }}\r\n              >\r\n                <Navbar />\r\n                <Box\r\n                  component=\"main\"\r\n                  sx={{\r\n                    flex: 1,\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    width: '100%',\r\n                    position: 'relative',\r\n                  }}\r\n                >\r\n                  <AppRoutes />\r\n                </Box>\r\n              </Box>\r\n            </AnalyticsProvider>\r\n          </ChatProvider>\r\n        </AuthProvider>\r\n      </ThemeProvider>\r\n    </Router>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","import { StrictMode } from 'react'\nimport { createRoot } from 'react-dom/client'\nimport './index.css'\nimport App from './App.tsx'\n\ncreateRoot(document.getElementById('root')!).render(\n  <StrictMode>\n    <App />\n  </StrictMode>,\n)\n"],"names":["m","require$$0","createRoot","AnalyticsContext","createContext","useAnalytics","context","useContext","AnalyticsProvider","children","logPageView","page","logEvent","event","properties","jsx","name","version","PENDING_TIMEOUT_MS","PACKAGE_VERSION","INTERNAL_AUTH_VERSION","INSTALLATIONS_API_URL","TOKEN_EXPIRATION_BUFFER","SERVICE","SERVICE_NAME","ERROR_DESCRIPTION_MAP","ERROR_FACTORY","ErrorFactory","isServerError","error","FirebaseError","getInstallationsEndpoint","projectId","extractAuthTokenInfoFromResponse","response","getExpiresInFromResponseExpiresIn","getErrorFromResponse","requestName","errorData","getHeaders","apiKey","getHeadersWithAuth","appConfig","refreshToken","headers","getAuthorizationHeader","retryIfServerError","fn","result","responseExpiresIn","createInstallationRequest","heartbeatServiceProvider","fid","endpoint","heartbeatService","heartbeatsHeader","body","request","responseValue","sleep","ms","resolve","bufferToBase64UrlSafe","array","VALID_FID_PATTERN","INVALID_FID","generateFid","fidByteArray","encode","getKey","fidChangeCallbacks","fidChanged","key","callFidChangeCallbacks","broadcastFidChange","callbacks","callback","channel","getBroadcastChannel","closeBroadcastChannel","broadcastChannel","e","DATABASE_NAME","DATABASE_VERSION","OBJECT_STORE_NAME","dbPromise","getDbPromise","openDB","db","oldVersion","set","value","tx","objectStore","oldValue","remove","update","updateFn","store","newValue","getInstallationEntry","installations","registrationPromise","installationEntry","oldEntry","updateOrCreateInstallationEntry","entryWithPromise","triggerRegistrationIfNecessary","entry","clearTimedOutRequest","registrationPromiseWithError","inProgressEntry","registerInstallation","waitUntilFidRegistration","registeredInstallationEntry","updateInstallationRequest","hasInstallationRequestTimedOut","generateAuthTokenRequest","getGenerateAuthTokenEndpoint","refreshAuthToken","forceRefresh","tokenPromise","isEntryRegistered","oldAuthToken","isAuthTokenValid","waitUntilAuthTokenRequest","makeAuthTokenRequestInProgressEntry","fetchAuthTokenFromServer","updateAuthTokenRequest","authToken","hasAuthTokenRequestTimedOut","updatedInstallationEntry","isAuthTokenExpired","now","inProgressAuthToken","getId","installationsImpl","getToken","completeInstallationRegistration","extractAppConfig","app","getMissingValueError","configKeys","keyName","valueName","INSTALLATIONS_NAME","INSTALLATIONS_NAME_INTERNAL","publicFactory","container","_getProvider","internalFactory","registerInstallations","_registerComponent","Component","registerVersion","ANALYTICS_TYPE","GA_FID_KEY","ORIGIN_KEY","FETCH_TIMEOUT_MILLIS","DYNAMIC_CONFIG_URL","GTAG_URL","logger","Logger","ERRORS","createGtagTrustedTypesScriptURL","url","err","promiseAllSettled","promises","promise","createTrustedTypesPolicy","policyName","policyOptions","trustedTypesPolicy","insertScriptTag","dataLayerName","measurementId","script","gtagScriptURL","getOrCreateDataLayer","dataLayer","gtagOnConfig","gtagCore","initializationPromisesMap","dynamicConfigPromisesList","measurementIdToAppId","gtagParams","correspondingAppId","foundConfig","config","gtagOnEvent","initializationPromisesToWaitFor","gaSendToList","dynamicConfigResults","sendToId","initializationPromise","wrapGtag","gtagWrapper","command","args","consentAction","fieldName","customParams","wrapOrCreateGtag","gtagFunctionName","_args","findGtagScriptOnPage","scriptTags","tag","LONG_RETRY_FACTOR","BASE_INTERVAL_MILLIS","RetryData","throttleMetadata","intervalMillis","appId","metadata","defaultRetryData","fetchDynamicConfig","appFields","_a","appUrl","errorMessage","jsonResponse","fetchDynamicConfigWithRetry","retryData","timeoutMillis","signal","AnalyticsAbortSignal","attemptFetchDynamicConfigWithRetry","throttleEndTimeMillis","backoffCount","setAbortableTimeout","isRetriableError","backoffMillis","calculateBackoffMillis","reject","timeout","httpStatus","listener","logEvent$1","gtagFunction","eventName","eventParams","options","params","validateIndexedDB","isIndexedDBAvailable","validateIndexedDBOpenable","_initializeAnalytics","dynamicConfigPromise","fidPromise","envIsValid","dynamicConfig","configProperties","AnalyticsService","gtagName","gtagCoreFunction","wrappedGtagFunction","globalInitDone","warnOnBrowserContextMismatch","mismatchedEnvMessages","isBrowserExtension","areCookiesEnabled","details","message","index","factory","wrappedGtag","getAnalytics","getApp","getModularInstance","analyticsProvider","initializeAnalytics","existingInstance","deepEqual","isSupported","analyticsInstance","registerAnalytics","analyticsOptions","analytics","validateConfig","requiredFields","field","firebaseConfig","getApps","initializeApp","auth","getAuth","setPersistence","browserLocalPersistence","initializeFirestore","persistentLocalCache","persistentMultipleTabManager","getFirestore","storage","getStorage","yes","AuthContext","AuthProvider","user","setUser","useState","loading","setLoading","setError","token","setToken","useEffect","onAuthStateChanged","email","password","signInWithEmailAndPassword","userCredential","createUserWithEmailAndPassword","updateProfile","signOut","sendPasswordResetEmail","useAuth","PACKET_TYPES","PACKET_TYPES_REVERSE","ERROR_PACKET","withNativeBlob","withNativeArrayBuffer","isView","obj","encodePacket","type","data","supportsBinary","encodeBlobAsBase64","fileReader","content","toArray","TEXT_ENCODER","encodePacketToBinary","packet","encoded","chars","lookup","i","decode","base64","bufferLength","len","p","encoded1","encoded2","encoded3","encoded4","arraybuffer","bytes","decodePacket","encodedPacket","binaryType","mapBinary","decodeBase64Packet","decoded","SEPARATOR","encodePayload","packets","length","encodedPackets","count","decodePayload","encodedPayload","decodedPacket","createPacketEncoderStream","controller","payloadLength","header","view","TEXT_DECODER","totalLength","chunks","acc","chunk","concatChunks","size","buffer","j","createPacketDecoderStream","maxPayload","state","expectedLength","isBinary","headerArray","n","protocol","Emitter","mixin","on","cb","nextTick","setTimeoutFn","globalThisShim","defaultBinaryType","pick","attr","k","NATIVE_SET_TIMEOUT","globalThis","NATIVE_CLEAR_TIMEOUT","installTimerFunctions","opts","BASE64_OVERHEAD","byteLength","utf8Length","str","c","l","randomString","qs","qry","pairs","pair","TransportError","reason","description","Transport","onPause","schema","query","hostname","encodedQuery","Polling","pause","total","close","hasCORS","empty","BaseXHR","isSSL","port","req","xhrStatus","Request","createRequest","uri","xhr","fromError","unloadHandler","terminationEvent","hasXHR2","newRequest","XHR","forceBase64","xdomain","isReactNative","BaseWS","protocols","closeEvent","ev","lastPacket","WebSocketCtor","WS","_packet","WT","stream","decoderStream","reader","encoderStream","read","done","transports","re","parts","parse","src","b","pathNames","queryKey","path","regx","names","$0","$1","$2","withEventListeners","OFFLINE_EVENT_LISTENERS","SocketWithoutUpgrade","parsedUri","t","transportName","transport","delay","payloadSize","hasExpired","msg","cleanupAndClose","waitForUpgrade","SocketWithUpgrade","failed","onTransportOpen","cleanup","freezeTransport","onerror","onTransportClose","onclose","onupgrade","to","upgrades","filteredUpgrades","o","DEFAULT_TRANSPORTS","loc","host","toString","withNativeFile","hasBinary","toJSON","deconstructPacket","buffers","packetData","pack","_deconstructPacket","placeholder","newData","reconstructPacket","_reconstructPacket","RESERVED_EVENTS","PacketType","Encoder","replacer","deconstruction","isObject","Decoder","reviver","isBinaryEvent","BinaryReconstructor","start","buf","next","payload","binData","Socket","io","nsp","_b","_c","id","ack","isTransportWritable","isConnected","timer","arg1","arg2","responseArgs","force","listeners","self","sent","pid","subDestroy","compress","Backoff","rand","deviation","min","max","jitter","Manager","_parser","parser","v","Engine","socket","openSubDestroy","onError","errorSub","nsps","attempt","cache","parsed","source","sameNamespace","newConnection","ChatContext","ChatProvider","socketRef","useRef","chats","setChats","currentChat","setCurrentChat","messages","setMessages","unreadCounts","setUnreadCounts","apiUrl","define_process_env_default","freshToken","newToken","refreshError","attemptNumber","unreadCount","sum","numCount","refreshUnreadCounts","useCallback","errorText","counts","newUnreadCounts","item","fetchChats","processedData","chat","fetchMessages","chatId","handleSetCurrentChat","prev","sendMessage","text","newMessage","startChat","participantId","newChat","useChat","theme","createTheme","exports","_utils","_interopRequireDefault","Favorite","default_1","_createSvgIcon","require$$1","_jsxRuntime","require$$2","FavoriteBorder","LocationOn","Chat","heroImage","vegetablesImage","shoppingBagsImage","bambooImage","shoesImage","coffeeMakerImage","jacketImage","boardGamesImage","yogaMatImage","blenderImage","childrenBooksImage","gardenToolsImage","laptopStandImage","bicycleImage","artSuppliesImage","deskLampImage","laptopImage","clothesImage","electronicsImage","booksImage","furnitureImage","toysImage","sportsImage","Search","SearchBar","onChange","onSearch","sx","variant","getVariantStyles","handleSubmit","handleKeyPress","TextField","InputAdornment","IconButton","SearchIcon","Email","Phone","Footer","quickLinks","legalLinks","categories","Box","jsxs","Container","Grid","Typography","link","Link","RouterLink","category","EmailIcon","PhoneIcon","LocationOnIcon","Divider","useFavorites","favorites","setFavorites","favoritesRef","collection","q","where","unsubscribe","onSnapshot","snapshot","favoriteIds","doc","listingId","listingIdStr","favoriteId","favoriteRef","deleteDoc","listingRef","getDoc","favoriteData","serverTimestamp","setDoc","fadeIn","keyframes","slideIn","scaleIn","AnimatedPage","animation","getAnimation","Home","navigate","useNavigate","useTheme","searchQuery","setSearchQuery","recentListings","setRecentListings","toggleFavorite","startingChat","setStartingChat","fetchRecentListings","orderBy","limit","listings","getDocs","userId","listing","handleSearch","handleSearchQueryChange","handleCategoryClick","categoryId","handleListingClick","isDemoListing","formattedListing","handleFavoriteClick","handleStartChat","renderListingCard","isFavorite","images","isStartingChat","locationText","Card","CardMedia","FavoriteIcon","FavoriteBorderIcon","CircularProgress","ChatIcon","CardContent","Chip","featuredListings","Alert","Login","setEmail","setPassword","login","clearError","validateEmail","Paper","Button","Register","formData","setFormData","showPassword","setShowPassword","showConfirmPassword","setShowConfirmPassword","register","validatePassword","VisibilityOff","Visibility","useListings","setListings","updateListing","updateDoc","deleteListing","retryCount","maxRetries","isMounted","processSnapshot","listingsData","fetchListings","fetchListingsWithGetDocs","querySnapshot","ListingCard","target","Profile","authLoading","listingsLoading","userListings","activeListingsCount","Avatar","CloudUpload","Delete","conditions","CreateListing","success","setSuccess","uploadingImages","setUploadingImages","validateForm","handleImageSelect","newImages","newPreviews","file","handleRemoveImage","_","uploadImages","files","uploadPromises","timestamp","safeFileName","filename","storagePath","storageRef","ref","uploadBytes","getDownloadURL","imageUrls","listingData","docRef","addDoc","CloudUploadIcon","preview","DeleteIcon","FormControl","InputLabel","Select","MenuItem","FormHelperText","condition","Snackbar","ListingDetails","location","useLocation","useParams","checkIsFavorite","imageDialogOpen","setImageDialogOpen","React","deleteDialogOpen","setDeleteDialogOpen","setListing","enlargedImage","setEnlargedImage","showPhone","setShowPhone","otherListings","setOtherListings","loadingOtherListings","setLoadingOtherListings","fetchListing","listingDoc","otherListingsData","locationListing","handleEditClick","handleDelete","imageUrl","imagePath","imageRef","deleteObject","imageError","handleImageClick","image","handleCloseImageDialog","handleShowPhone","formatDate","date","formatLocation","address","cityMatch","ArrowBackIcon","Fragment","EditIcon","ZoomInIcon","LocationIcon","PersonIcon","VisibilityOffIcon","VisibilityIcon","otherListing","Dialog","DialogTitle","DialogContent","DialogActions","CloseIcon","initialFormData","EditListing","setNewImages","imagePreviews","setImagePreviews","docSnap","handleImageUpload","isNew","uploadNewImages","updatedImages","newImageUrls","deletePromises","_d","_e","_f","isObject_1","freeGlobal","global","_freeGlobal","freeSelf","root","_root","now_1","reWhitespace","trimmedEndIndex","string","_trimmedEndIndex","reTrimStart","baseTrim","_baseTrim","Symbol","_Symbol","objectProto","hasOwnProperty","nativeObjectToString","symToStringTag","getRawTag","isOwn","unmasked","_getRawTag","objectToString","_objectToString","nullTag","undefinedTag","baseGetTag","_baseGetTag","isObjectLike","isObjectLike_1","symbolTag","isSymbol","isSymbol_1","NAN","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","toNumber","other","toNumber_1","FUNC_ERROR_TEXT","nativeMax","nativeMin","debounce","func","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","invokeFunc","time","thisArg","leadingEdge","timerExpired","remainingWait","timeSinceLastCall","timeSinceLastInvoke","timeWaiting","shouldInvoke","trailingEdge","cancel","flush","debounced","isInvoking","debounce_1","millisecondsInWeek","millisecondsInDay","minutesInMonth","minutesInDay","constructFromSymbol","constructFrom","toDate","argument","addDays","amount","_date","defaultOptions","getDefaultOptions","startOfWeek","weekStartsOn","day","diff","startOfISOWeek","getISOWeekYear","year","fourthOfJanuaryOfNextYear","startOfNextYear","fourthOfJanuaryOfThisYear","startOfThisYear","getTimezoneOffsetInMilliseconds","utcDate","normalizeDates","dates","normalize","startOfDay","differenceInCalendarDays","laterDate","earlierDate","laterDate_","earlierDate_","laterStartOfDay","earlierStartOfDay","laterTimestamp","earlierTimestamp","startOfISOWeekYear","fourthOfJanuary","compareAsc","dateLeft","dateRight","constructNow","isSameDay","dateLeft_","dateRight_","isDate","isValid","differenceInCalendarMonths","yearsDiff","monthsDiff","getRoundingMethod","method","number","differenceInMilliseconds","endOfDay","endOfMonth","month","isLastDayOfMonth","differenceInMonths","workingLaterDate","sign","difference","isLastMonthNotFull","differenceInSeconds","startOfYear","date_","formatDistanceLocale","formatDistance","tokenValue","buildFormatLongFn","width","dateFormats","timeFormats","dateTimeFormats","formatLong","formatRelativeLocale","formatRelative","_baseDate","_options","buildLocalizeFn","valuesArray","defaultWidth","eraValues","quarterValues","monthValues","dayValues","dayPeriodValues","formattingDayPeriodValues","ordinalNumber","dirtyNumber","rem100","localize","quarter","buildMatchFn","matchPattern","matchResult","matchedString","parsePatterns","findIndex","pattern","findKey","rest","object","predicate","buildMatchPatternFn","parseResult","matchOrdinalNumberPattern","parseOrdinalNumberPattern","matchEraPatterns","parseEraPatterns","matchQuarterPatterns","parseQuarterPatterns","matchMonthPatterns","parseMonthPatterns","matchDayPatterns","parseDayPatterns","matchDayPeriodPatterns","parseDayPeriodPatterns","match","enUS","getDayOfYear","getISOWeek","getWeekYear","firstWeekContainsDate","firstWeekOfNextYear","firstWeekOfThisYear","startOfWeekYear","firstWeek","getWeek","addLeadingZeros","targetLength","output","lightFormatters","signedYear","dayPeriodEnumValue","numberOfDigits","milliseconds","fractionalSeconds","dayPeriodEnum","formatters","era","signedWeekYear","weekYear","twoDigitYear","isoWeekYear","week","isoWeek","dayOfYear","dayOfWeek","localDayOfWeek","isoDayOfWeek","hours","_localize","timezoneOffset","formatTimezoneWithOptionalMinutes","formatTimezone","formatTimezoneShort","offset","delimiter","absOffset","minutes","dateLongFormatter","timeLongFormatter","dateTimeLongFormatter","datePattern","timePattern","dateTimeFormat","longFormatters","dayOfYearTokenRE","weekYearTokenRE","throwTokens","isProtectedDayOfYearToken","isProtectedWeekYearToken","warnOrThrowProtectedError","format","input","_message","subject","formattingTokensRegExp","longFormattingTokensRegExp","escapedStringRegExp","doubleQuoteRegExp","unescapedLatinCharacterRegExp","formatStr","locale","defaultLocale","originalDate","substring","firstCharacter","longFormatter","cleanEscapedString","formatterOptions","part","formatter","matched","minutesInAlmostTwoDays","comparison","localizeOptions","seconds","offsetInSeconds","months","days","nearestMonth","monthsSinceStartOfYear","years","formatDistanceToNow","isSameWeek","isToday","subDays","isYesterday","searchParams","setSearchParams","useSearchParams","categoryFilter","setCategoryFilter","snackbarOpen","setSnackbarOpen","snackbarMessage","setSnackbarMessage","defaultCategories","categoryMap","handleCategoryChange","newCategory","newParams","searchListings","searchText","listingsRef","allListings","results","searchTerms","term","titleLower","descriptionLower","categoryLower","listingCategory","filterCategory","sortedResults","score","titleMatch","descMatch","categoryMatch","a","debouncedSearch","categoryParam","newQuery","cat","CategoryIcon","TimeIcon","CardActions","HowItWorks","steps","SwapIcon","RecyclingIcon","step","weekdays","lastWeek","weekday","thisWeek","nextWeek","lastWeekFormatToken","dirtyDate","baseDate","nextWeekFormatToken","isFeminine","unit","isNeuter","numberWithSuffix","masculine","feminine","neuter","suffix","bg","AccessTime","MyListings","listingToDelete","setListingToDelete","isDeleting","setIsDeleting","handleEdit","handleDeleteClick","dateObj","renderHeader","AddIcon","AccessTimeIcon","About","values","PeopleIcon","PublicIcon","Settings","displayName","setDisplayName","Contact","handleChange","messageData","Favorites","favoriteListings","setFavoriteListings","validFavorites","listingPromises","demoId","demoListing","demoListingWithoutId","handleRemoveFavorite","Privacy","Terms","ForgotPassword","resetPassword","NotFound","ArrowBack","ChatBubbleOutline","PersonAdd","ChatListItem","currentUserId","selected","onClick","otherParticipant","getDisplayName","getAvatarText","dateString","ListItem","ListItemAvatar","Badge","ListItemText","convertChatToListItem","participants","participant","lastMessage","chatListItem","ChatList","onChatSelect","selectedChatId","filteredChats","handleChatSelect","List","ChatBubbleOutlineIcon","PersonAddIcon","Send","AttachFile","EmojiEmotions","MoreVert","DoneAll","Image","TYPING_TIMER_LENGTH","isUser","sender","ChatWindow","onClose","setNewMessage","isTyping","setIsTyping","typingUsers","setTypingUsers","messagesEndRef","typingTimeoutRef","handleMessage","handleTyping","newSet","formatMessageDate","messageDate","renderMessageGroup","isLastInGroup","isCurrentUser","senderName","DoneAllIcon","ImageIcon","typingUsersCount","MoreVertIcon","nextMessage","currentSenderId","nextSenderId","EmojiEmotionsIcon","AttachFileIcon","SendIcon","Menu","Notifications","ChatPage","isMobile","useMediaQuery","mobileOpen","setMobileOpen","navbar","handleDrawerToggle","handleBack","Fade","chatList","NotificationsIcon","SettingsIcon","AppBar","Toolbar","MenuIcon","Drawer","AppRoutes","Routes","Route","Navbar","logout","anchorElNav","setAnchorElNav","anchorElUser","setAnchorElUser","pages","userMenuItems","handleOpenNavMenu","handleOpenUserMenu","handleCloseNavMenu","handleCloseUserMenu","handleMenuItemClick","action","Tooltip","globalStyles","App","Router","ThemeProvider","CssBaseline","GlobalStyles","StrictMode"],"mappings":"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","x_google_ignoreList":[0,2,3,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,35,36,37,38,39,41,43,44,55,56,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,130,131,132,133,134,135,136,147,148,151,152,153,154,155,156,158,159,160,161]}